import{b4 as Ui,aN as Ir,aO as sb,b6 as Un,aP as ob,b7 as ab,b8 as bf,aT as cb}from"./index-17e45281.js";import{e as Mr,H as zu}from"./events-da39c06e.js";import{c as ub}from"./_commonjs-dynamic-modules-302442b1.js";var na={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var hu=function(n,e){return hu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},hu(n,e)};function hb(n,e){hu(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var lu=function(){return lu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},lu.apply(this,arguments)};function lb(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function fb(n,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,s);else for(var f=n.length-1;f>=0;f--)(l=n[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function db(n,e){return function(t,s){e(t,s,n)}}function pb(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function gb(n,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(S){try{p(s.next(S))}catch(T){l(T)}}function v(S){try{p(s.throw(S))}catch(T){l(T)}}function p(S){S.done?c(S.value):o(S.value).then(f,v)}p((s=s.apply(n,e||[])).next())})}function yb(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(S){return v([p,S])}}function v(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(S){p=[6,S],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function _b(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function vb(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function fu(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function op(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function mb(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(op(arguments[e]));return n}function bb(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Es(n){return this instanceof Es?(this.v=n,this):new Es(n)}function wb(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(x){s[x]&&(o[x]=function(A){return new Promise(function(U,z){c.push([x,A,U,z])>1||f(x,A)})})}function f(x,A){try{v(s[x](A))}catch(U){T(c[0][3],U)}}function v(x){x.value instanceof Es?Promise.resolve(x.value.v).then(p,S):T(c[0][2],x)}function p(x){f("next",x)}function S(x){f("throw",x)}function T(x,A){x(A),c.shift(),c.length&&f(c[0][0],c[0][1])}}function Eb(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=n[o]?function(l){return(t=!t)?{value:Es(n[o](l)),done:o==="return"}:c?c(l):l}:c}}function Sb(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof fu=="function"?fu(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=n[c]&&function(l){return new Promise(function(f,v){l=n[c](l),o(f,v,l.done,l.value)})}}function o(c,l,f,v){Promise.resolve(v).then(function(p){c({value:p,done:f})},l)}}function Ib(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function Ob(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function xb(n){return n&&n.__esModule?n:{default:n}}function Pb(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function Tb(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}const Ab=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return lu},__asyncDelegator:Eb,__asyncGenerator:wb,__asyncValues:Sb,__await:Es,__awaiter:gb,__classPrivateFieldGet:Pb,__classPrivateFieldSet:Tb,__createBinding:_b,__decorate:fb,__exportStar:vb,__extends:hb,__generator:yb,__importDefault:xb,__importStar:Ob,__makeTemplateObject:Ib,__metadata:pb,__param:db,__read:op,__rest:lb,__spread:mb,__spreadArrays:bb,__values:fu},Symbol.toStringTag,{value:"Module"})),ap=Ui(Ab);var Cs={};Object.defineProperty(Cs,"__esModule",{value:!0});function Nb(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch{return n}}Cs.safeJsonParse=Nb;function Cb(n){return typeof n=="string"?n:JSON.stringify(n,(e,t)=>typeof t>"u"?null:t)}Cs.safeJsonStringify=Cb;var os={exports:{}},wf;function Rb(){return wf||(wf=1,function(){let n;function e(){}n=e,n.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},n.prototype.setItem=function(t,s){this[t]=String(s)},n.prototype.removeItem=function(t){delete this[t]},n.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},n.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ir<"u"&&Ir.localStorage?os.exports=Ir.localStorage:typeof window<"u"&&window.localStorage?os.exports=window.localStorage:os.exports=new e}()),os.exports}var qc={},as={},Ef;function $b(){if(Ef)return as;Ef=1,Object.defineProperty(as,"__esModule",{value:!0}),as.IKeyValueStorage=void 0;class n{}return as.IKeyValueStorage=n,as}var cs={},Sf;function Ub(){if(Sf)return cs;Sf=1,Object.defineProperty(cs,"__esModule",{value:!0}),cs.parseEntry=void 0;const n=Cs;function e(t){var s;return[t[0],n.safeJsonParse((s=t[1])!==null&&s!==void 0?s:"")]}return cs.parseEntry=e,cs}var If;function Db(){return If||(If=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=ap;e.__exportStar($b(),n),e.__exportStar(Ub(),n)}(qc)),qc}Object.defineProperty(na,"__esModule",{value:!0});na.KeyValueStorage=void 0;const Ci=ap,Of=Cs,Fb=Ci.__importDefault(Rb()),Lb=Db();class cp{constructor(){this.localStorage=Fb.default}getKeys(){return Ci.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Ci.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Lb.parseEntry)})}getItem(e){return Ci.__awaiter(this,void 0,void 0,function*(){const t=this.localStorage.getItem(e);if(t!==null)return Of.safeJsonParse(t)})}setItem(e,t){return Ci.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,Of.safeJsonStringify(t))})}removeItem(e){return Ci.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}na.KeyValueStorage=cp;var jb=na.default=cp,Di={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var du=function(n,e){return du=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},du(n,e)};function Mb(n,e){du(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var pu=function(){return pu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},pu.apply(this,arguments)};function qb(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function Hb(n,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,s);else for(var f=n.length-1;f>=0;f--)(l=n[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function zb(n,e){return function(t,s){e(t,s,n)}}function Bb(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function Kb(n,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(S){try{p(s.next(S))}catch(T){l(T)}}function v(S){try{p(s.throw(S))}catch(T){l(T)}}function p(S){S.done?c(S.value):o(S.value).then(f,v)}p((s=s.apply(n,e||[])).next())})}function Vb(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(S){return v([p,S])}}function v(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(S){p=[6,S],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function kb(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function Gb(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function gu(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function up(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function Wb(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(up(arguments[e]));return n}function Yb(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Ss(n){return this instanceof Ss?(this.v=n,this):new Ss(n)}function Jb(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(x){s[x]&&(o[x]=function(A){return new Promise(function(U,z){c.push([x,A,U,z])>1||f(x,A)})})}function f(x,A){try{v(s[x](A))}catch(U){T(c[0][3],U)}}function v(x){x.value instanceof Ss?Promise.resolve(x.value.v).then(p,S):T(c[0][2],x)}function p(x){f("next",x)}function S(x){f("throw",x)}function T(x,A){x(A),c.shift(),c.length&&f(c[0][0],c[0][1])}}function Qb(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=n[o]?function(l){return(t=!t)?{value:Ss(n[o](l)),done:o==="return"}:c?c(l):l}:c}}function Xb(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof gu=="function"?gu(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=n[c]&&function(l){return new Promise(function(f,v){l=n[c](l),o(f,v,l.done,l.value)})}}function o(c,l,f,v){Promise.resolve(v).then(function(p){c({value:p,done:f})},l)}}function Zb(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function ew(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function tw(n){return n&&n.__esModule?n:{default:n}}function rw(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function nw(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}const iw=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return pu},__asyncDelegator:Qb,__asyncGenerator:Jb,__asyncValues:Xb,__await:Ss,__awaiter:Kb,__classPrivateFieldGet:rw,__classPrivateFieldSet:nw,__createBinding:kb,__decorate:Hb,__exportStar:Gb,__extends:Mb,__generator:Vb,__importDefault:tw,__importStar:ew,__makeTemplateObject:Zb,__metadata:Bb,__param:zb,__read:up,__rest:qb,__spread:Wb,__spreadArrays:Yb,__values:gu},Symbol.toStringTag,{value:"Module"})),ia=Ui(iw);var us={},_e={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var yu=function(n,e){return yu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},yu(n,e)};function sw(n,e){yu(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var _u=function(){return _u=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},_u.apply(this,arguments)};function ow(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function aw(n,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,s);else for(var f=n.length-1;f>=0;f--)(l=n[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function cw(n,e){return function(t,s){e(t,s,n)}}function uw(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function hw(n,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(S){try{p(s.next(S))}catch(T){l(T)}}function v(S){try{p(s.throw(S))}catch(T){l(T)}}function p(S){S.done?c(S.value):o(S.value).then(f,v)}p((s=s.apply(n,e||[])).next())})}function lw(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(S){return v([p,S])}}function v(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(S){p=[6,S],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function fw(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function dw(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function vu(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function hp(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function pw(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(hp(arguments[e]));return n}function gw(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Is(n){return this instanceof Is?(this.v=n,this):new Is(n)}function yw(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(x){s[x]&&(o[x]=function(A){return new Promise(function(U,z){c.push([x,A,U,z])>1||f(x,A)})})}function f(x,A){try{v(s[x](A))}catch(U){T(c[0][3],U)}}function v(x){x.value instanceof Is?Promise.resolve(x.value.v).then(p,S):T(c[0][2],x)}function p(x){f("next",x)}function S(x){f("throw",x)}function T(x,A){x(A),c.shift(),c.length&&f(c[0][0],c[0][1])}}function _w(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=n[o]?function(l){return(t=!t)?{value:Is(n[o](l)),done:o==="return"}:c?c(l):l}:c}}function vw(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof vu=="function"?vu(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=n[c]&&function(l){return new Promise(function(f,v){l=n[c](l),o(f,v,l.done,l.value)})}}function o(c,l,f,v){Promise.resolve(v).then(function(p){c({value:p,done:f})},l)}}function mw(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function bw(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function ww(n){return n&&n.__esModule?n:{default:n}}function Ew(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function Sw(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}const Iw=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return _u},__asyncDelegator:_w,__asyncGenerator:yw,__asyncValues:vw,__await:Is,__awaiter:hw,__classPrivateFieldGet:Ew,__classPrivateFieldSet:Sw,__createBinding:fw,__decorate:aw,__exportStar:dw,__extends:sw,__generator:lw,__importDefault:ww,__importStar:bw,__makeTemplateObject:mw,__metadata:uw,__param:cw,__read:hp,__rest:ow,__spread:pw,__spreadArrays:gw,__values:vu},Symbol.toStringTag,{value:"Module"})),sa=Ui(Iw);var Hc={},hs={},xf;function Ow(){if(xf)return hs;xf=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.delay=void 0;function n(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return hs.delay=n,hs}var Zn={},zc={},ei={},Pf;function xw(){return Pf||(Pf=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.ONE_THOUSAND=ei.ONE_HUNDRED=void 0,ei.ONE_HUNDRED=100,ei.ONE_THOUSAND=1e3),ei}var Bc={},Tf;function Pw(){return Tf||(Tf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(Bc)),Bc}var Af;function lp(){return Af||(Af=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=sa;e.__exportStar(xw(),n),e.__exportStar(Pw(),n)}(zc)),zc}var Nf;function Tw(){if(Nf)return Zn;Nf=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.fromMiliseconds=Zn.toMiliseconds=void 0;const n=lp();function e(s){return s*n.ONE_THOUSAND}Zn.toMiliseconds=e;function t(s){return Math.floor(s/n.ONE_THOUSAND)}return Zn.fromMiliseconds=t,Zn}var Cf;function Aw(){return Cf||(Cf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=sa;e.__exportStar(Ow(),n),e.__exportStar(Tw(),n)}(Hc)),Hc}var Ni={},Rf;function Nw(){if(Rf)return Ni;Rf=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return Ni.Watch=n,Ni.default=n,Ni}var Kc={},ls={},$f;function Cw(){if($f)return ls;$f=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.IWatch=void 0;class n{}return ls.IWatch=n,ls}var Uf;function Rw(){return Uf||(Uf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),sa.__exportStar(Cw(),n)}(Kc)),Kc}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=sa;e.__exportStar(Aw(),n),e.__exportStar(Nw(),n),e.__exportStar(Rw(),n),e.__exportStar(lp(),n)})(_e);var Vc={},fs={};let ii=class{};const $w=Object.freeze(Object.defineProperty({__proto__:null,IEvents:ii},Symbol.toStringTag,{value:"Module"})),Uw=Ui($w);var Df;function Dw(){if(Df)return fs;Df=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.IHeartBeat=void 0;const n=Uw;class e extends n.IEvents{constructor(s){super()}}return fs.IHeartBeat=e,fs}var Ff;function fp(){return Ff||(Ff=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),ia.__exportStar(Dw(),n)}(Vc)),Vc}var kc={},ti={},Lf;function Fw(){if(Lf)return ti;Lf=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.HEARTBEAT_EVENTS=ti.HEARTBEAT_INTERVAL=void 0;const n=_e;return ti.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,ti.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},ti}var jf;function dp(){return jf||(jf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),ia.__exportStar(Fw(),n)}(kc)),kc}var Mf;function Lw(){if(Mf)return us;Mf=1,Object.defineProperty(us,"__esModule",{value:!0}),us.HeartBeat=void 0;const n=ia,e=Mr,t=_e,s=fp(),o=dp();class c extends s.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||o.HEARTBEAT_INTERVAL}static init(f){return n.__awaiter(this,void 0,void 0,function*(){const v=new c(f);return yield v.init(),v})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,v){this.events.on(f,v)}once(f,v){this.events.once(f,v)}off(f,v){this.events.off(f,v)}removeListener(f,v){this.events.removeListener(f,v)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return us.HeartBeat=c,us}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=ia;e.__exportStar(Lw(),n),e.__exportStar(fp(),n),e.__exportStar(dp(),n)})(Di);var Ze={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var mu=function(n,e){return mu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},mu(n,e)};function jw(n,e){mu(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var bu=function(){return bu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},bu.apply(this,arguments)};function Mw(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function qw(n,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,s);else for(var f=n.length-1;f>=0;f--)(l=n[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function Hw(n,e){return function(t,s){e(t,s,n)}}function zw(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function Bw(n,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(S){try{p(s.next(S))}catch(T){l(T)}}function v(S){try{p(s.throw(S))}catch(T){l(T)}}function p(S){S.done?c(S.value):o(S.value).then(f,v)}p((s=s.apply(n,e||[])).next())})}function Kw(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(S){return v([p,S])}}function v(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(S){p=[6,S],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Vw(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function kw(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function wu(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function pp(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function Gw(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(pp(arguments[e]));return n}function Ww(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Os(n){return this instanceof Os?(this.v=n,this):new Os(n)}function Yw(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(x){s[x]&&(o[x]=function(A){return new Promise(function(U,z){c.push([x,A,U,z])>1||f(x,A)})})}function f(x,A){try{v(s[x](A))}catch(U){T(c[0][3],U)}}function v(x){x.value instanceof Os?Promise.resolve(x.value.v).then(p,S):T(c[0][2],x)}function p(x){f("next",x)}function S(x){f("throw",x)}function T(x,A){x(A),c.shift(),c.length&&f(c[0][0],c[0][1])}}function Jw(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=n[o]?function(l){return(t=!t)?{value:Os(n[o](l)),done:o==="return"}:c?c(l):l}:c}}function Qw(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof wu=="function"?wu(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=n[c]&&function(l){return new Promise(function(f,v){l=n[c](l),o(f,v,l.done,l.value)})}}function o(c,l,f,v){Promise.resolve(v).then(function(p){c({value:p,done:f})},l)}}function Xw(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function Zw(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function eE(n){return n&&n.__esModule?n:{default:n}}function tE(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function rE(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}const nE=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return bu},__asyncDelegator:Jw,__asyncGenerator:Yw,__asyncValues:Qw,__await:Os,__awaiter:Bw,__classPrivateFieldGet:tE,__classPrivateFieldSet:rE,__createBinding:Vw,__decorate:qw,__exportStar:kw,__extends:jw,__generator:Kw,__importDefault:eE,__importStar:Zw,__makeTemplateObject:Xw,__metadata:zw,__param:Hw,__read:pp,__rest:Mw,__spread:Gw,__spreadArrays:Ww,__values:wu},Symbol.toStringTag,{value:"Module"})),iE=Ui(nE);var Gc,qf;function sE(){if(qf)return Gc;qf=1;function n(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}Gc=e;function e(t,s,o){var c=o&&o.stringify||n,l=1;if(typeof t=="object"&&t!==null){var f=s.length+l;if(f===1)return t;var v=new Array(f);v[0]=c(t);for(var p=1;p<f;p++)v[p]=c(s[p]);return v.join(" ")}if(typeof t!="string")return t;var S=s.length;if(S===0)return t;for(var T="",x=1-l,A=-1,U=t&&t.length||0,z=0;z<U;){if(t.charCodeAt(z)===37&&z+1<U){switch(A=A>-1?A:0,t.charCodeAt(z+1)){case 100:case 102:if(x>=S||s[x]==null)break;A<z&&(T+=t.slice(A,z)),T+=Number(s[x]),A=z+2,z++;break;case 105:if(x>=S||s[x]==null)break;A<z&&(T+=t.slice(A,z)),T+=Math.floor(Number(s[x])),A=z+2,z++;break;case 79:case 111:case 106:if(x>=S||s[x]===void 0)break;A<z&&(T+=t.slice(A,z));var M=typeof s[x];if(M==="string"){T+="'"+s[x]+"'",A=z+2,z++;break}if(M==="function"){T+=s[x].name||"<anonymous>",A=z+2,z++;break}T+=c(s[x]),A=z+2,z++;break;case 115:if(x>=S)break;A<z&&(T+=t.slice(A,z)),T+=String(s[x]),A=z+2,z++;break;case 37:A<z&&(T+=t.slice(A,z)),T+="%",A=z+2,z++,x--;break}++x}++z}return A===-1?t:(A<U&&(T+=t.slice(A)),T)}return Gc}var Wc,Hf;function oE(){if(Hf)return Wc;Hf=1;const n=sE();Wc=o;const e=w().console||{},t={mapHttpRequest:U,mapHttpResponse:U,wrapRequestSerializer:z,wrapResponseSerializer:z,wrapErrorSerializer:z,req:U,res:U,err:x};function s(g,u){return Array.isArray(g)?g.filter(function(K){return K!=="!stdSerializers.err"}):g===!0?Object.keys(u):!1}function o(g){g=g||{},g.browser=g.browser||{};const u=g.browser.transmit;if(u&&typeof u.send!="function")throw Error("pino: transmit option must have a send function");const b=g.browser.write||e;g.browser.write&&(g.browser.asObject=!0);const K=g.serializers||{},k=s(g.browser.serialize,K);let oe=g.browser.serialize;Array.isArray(g.browser.serialize)&&g.browser.serialize.indexOf("!stdSerializers.err")>-1&&(oe=!1);const ce=["error","fatal","warn","info","debug","trace"];typeof b=="function"&&(b.error=b.fatal=b.warn=b.info=b.debug=b.trace=b),g.enabled===!1&&(g.level="silent");const ge=g.level||"info",D=Object.create(b);D.log||(D.log=M),Object.defineProperty(D,"levelVal",{get:le}),Object.defineProperty(D,"level",{get:te,set:W});const B={transmit:u,serialize:k,asObject:g.browser.asObject,levels:ce,timestamp:A(g)};D.levels=o.levels,D.level=ge,D.setMaxListeners=D.getMaxListeners=D.emit=D.addListener=D.on=D.prependListener=D.once=D.prependOnceListener=D.removeListener=D.removeAllListeners=D.listeners=D.listenerCount=D.eventNames=D.write=D.flush=M,D.serializers=K,D._serialize=k,D._stdErrSerialize=oe,D.child=ee,u&&(D._logEvent=T());function le(){return this.level==="silent"?1/0:this.levels.values[this.level]}function te(){return this._level}function W(Y){if(Y!=="silent"&&!this.levels.values[Y])throw Error("unknown level "+Y);this._level=Y,c(B,D,"error","log"),c(B,D,"fatal","error"),c(B,D,"warn","error"),c(B,D,"info","log"),c(B,D,"debug","log"),c(B,D,"trace","log")}function ee(Y,re){if(!Y)throw new Error("missing bindings for child Pino");re=re||{},k&&Y.serializers&&(re.serializers=Y.serializers);const xe=re.serializers;if(k&&xe){var ie=Object.assign({},K,xe),be=g.browser.serialize===!0?Object.keys(ie):k;delete Y.serializers,v([Y],be,ie,this._stdErrSerialize)}function he(ve){this._childLevel=(ve._childLevel|0)+1,this.error=p(ve,Y,"error"),this.fatal=p(ve,Y,"fatal"),this.warn=p(ve,Y,"warn"),this.info=p(ve,Y,"info"),this.debug=p(ve,Y,"debug"),this.trace=p(ve,Y,"trace"),ie&&(this.serializers=ie,this._serialize=be),u&&(this._logEvent=T([].concat(ve._logEvent.bindings,Y)))}return he.prototype=this,new he(this)}return D}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=t,o.stdTimeFunctions=Object.assign({},{nullTime:ne,epochTime:y,unixTime:E,isoTime:m});function c(g,u,b,K){const k=Object.getPrototypeOf(u);u[b]=u.levelVal>u.levels.values[b]?M:k[b]?k[b]:e[b]||e[K]||M,l(g,u,b)}function l(g,u,b){!g.transmit&&u[b]===M||(u[b]=function(K){return function(){const oe=g.timestamp(),ce=new Array(arguments.length),ge=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var D=0;D<ce.length;D++)ce[D]=arguments[D];if(g.serialize&&!g.asObject&&v(ce,this._serialize,this.serializers,this._stdErrSerialize),g.asObject?K.call(ge,f(this,b,ce,oe)):K.apply(ge,ce),g.transmit){const B=g.transmit.level||u.level,le=o.levels.values[B],te=o.levels.values[b];if(te<le)return;S(this,{ts:oe,methodLevel:b,methodValue:te,transmitLevel:B,transmitValue:o.levels.values[g.transmit.level||u.level],send:g.transmit.send,val:u.levelVal},ce)}}}(u[b]))}function f(g,u,b,K){g._serialize&&v(b,g._serialize,g.serializers,g._stdErrSerialize);const k=b.slice();let oe=k[0];const ce={};K&&(ce.time=K),ce.level=o.levels.values[u];let ge=(g._childLevel|0)+1;if(ge<1&&(ge=1),oe!==null&&typeof oe=="object"){for(;ge--&&typeof k[0]=="object";)Object.assign(ce,k.shift());oe=k.length?n(k.shift(),k):void 0}else typeof oe=="string"&&(oe=n(k.shift(),k));return oe!==void 0&&(ce.msg=oe),ce}function v(g,u,b,K){for(const k in g)if(K&&g[k]instanceof Error)g[k]=o.stdSerializers.err(g[k]);else if(typeof g[k]=="object"&&!Array.isArray(g[k]))for(const oe in g[k])u&&u.indexOf(oe)>-1&&oe in b&&(g[k][oe]=b[oe](g[k][oe]))}function p(g,u,b){return function(){const K=new Array(1+arguments.length);K[0]=u;for(var k=1;k<K.length;k++)K[k]=arguments[k-1];return g[b].apply(this,K)}}function S(g,u,b){const K=u.send,k=u.ts,oe=u.methodLevel,ce=u.methodValue,ge=u.val,D=g._logEvent.bindings;v(b,g._serialize||Object.keys(g.serializers),g.serializers,g._stdErrSerialize===void 0?!0:g._stdErrSerialize),g._logEvent.ts=k,g._logEvent.messages=b.filter(function(B){return D.indexOf(B)===-1}),g._logEvent.level.label=oe,g._logEvent.level.value=ce,K(oe,g._logEvent,ge),g._logEvent=T(D)}function T(g){return{ts:0,messages:[],bindings:g||[],level:{label:"",value:0}}}function x(g){const u={type:g.constructor.name,msg:g.message,stack:g.stack};for(const b in g)u[b]===void 0&&(u[b]=g[b]);return u}function A(g){return typeof g.timestamp=="function"?g.timestamp:g.timestamp===!1?ne:y}function U(){return{}}function z(g){return g}function M(){}function ne(){return!1}function y(){return Date.now()}function E(){return Math.round(Date.now()/1e3)}function m(){return new Date(Date.now()).toISOString()}function w(){function g(u){return typeof u<"u"&&u}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return g(self)||g(window)||g(this)||{}}}return Wc}var ri={},zf;function gp(){return zf||(zf=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.PINO_CUSTOM_CONTEXT_KEY=ri.PINO_LOGGER_DEFAULTS=void 0,ri.PINO_LOGGER_DEFAULTS={level:"info"},ri.PINO_CUSTOM_CONTEXT_KEY="custom_context"),ri}var ar={},Bf;function aE(){if(Bf)return ar;Bf=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.generateChildLogger=ar.formatChildLoggerContext=ar.getLoggerContext=ar.setBrowserLoggerContext=ar.getBrowserLoggerContext=ar.getDefaultLoggerOptions=void 0;const n=gp();function e(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||n.PINO_LOGGER_DEFAULTS.level})}ar.getDefaultLoggerOptions=e;function t(f,v=n.PINO_CUSTOM_CONTEXT_KEY){return f[v]||""}ar.getBrowserLoggerContext=t;function s(f,v,p=n.PINO_CUSTOM_CONTEXT_KEY){return f[p]=v,f}ar.setBrowserLoggerContext=s;function o(f,v=n.PINO_CUSTOM_CONTEXT_KEY){let p="";return typeof f.bindings>"u"?p=t(f,v):p=f.bindings().context||"",p}ar.getLoggerContext=o;function c(f,v,p=n.PINO_CUSTOM_CONTEXT_KEY){const S=o(f,p);return S.trim()?`${S}/${v}`:v}ar.formatChildLoggerContext=c;function l(f,v,p=n.PINO_CUSTOM_CONTEXT_KEY){const S=c(f,v,p),T=f.child({context:S});return s(T,S,p)}return ar.generateChildLogger=l,ar}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const e=iE,t=e.__importDefault(oE());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(gp(),n),e.__exportStar(aE(),n)})(Ze);const cE=n=>JSON.stringify(n,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),uE=n=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=n.replace(e,'$1"$2n"$3');return JSON.parse(t,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Bu(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return uE(n)}catch{return n}}function xs(n){return typeof n=="string"?n:cE(n)||""}var Ku={},Fi={},oa={},aa={};Object.defineProperty(aa,"__esModule",{value:!0});aa.BrowserRandomSource=void 0;const Kf=65536;class hE{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=Kf)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,Kf)));return t}}aa.BrowserRandomSource=hE;var ca={},xr={};Object.defineProperty(xr,"__esModule",{value:!0});function lE(n){for(var e=0;e<n.length;e++)n[e]=0;return n}xr.wipe=lE;Object.defineProperty(ca,"__esModule",{value:!0});ca.NodeRandomSource=void 0;const fE=xr;class dE{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof ub<"u"){const e=sb;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,fE.wipe)(t),s}}ca.NodeRandomSource=dE;Object.defineProperty(oa,"__esModule",{value:!0});oa.SystemRandomSource=void 0;const pE=aa,gE=ca;class yE{constructor(){if(this.isAvailable=!1,this.name="",this._source=new pE.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new gE.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}oa.SystemRandomSource=yE;var Fe={},yp={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function e(f,v){var p=f>>>16&65535,S=f&65535,T=v>>>16&65535,x=v&65535;return S*x+(p*x+S*T<<16>>>0)|0}n.mul=Math.imul||e;function t(f,v){return f+v|0}n.add=t;function s(f,v){return f-v|0}n.sub=s;function o(f,v){return f<<v|f>>>32-v}n.rotl=o;function c(f,v){return f<<32-v|f>>>v}n.rotr=c;function l(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}n.isInteger=Number.isInteger||l,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(f){return n.isInteger(f)&&f>=-n.MAX_SAFE_INTEGER&&f<=n.MAX_SAFE_INTEGER}})(yp);Object.defineProperty(Fe,"__esModule",{value:!0});var _p=yp;function _E(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])<<16>>16}Fe.readInt16BE=_E;function vE(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])>>>0}Fe.readUint16BE=vE;function mE(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])<<16>>16}Fe.readInt16LE=mE;function bE(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])>>>0}Fe.readUint16LE=bE;function vp(n,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=n>>>8,e[t+1]=n>>>0,e}Fe.writeUint16BE=vp;Fe.writeInt16BE=vp;function mp(n,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=n>>>0,e[t+1]=n>>>8,e}Fe.writeUint16LE=mp;Fe.writeInt16LE=mp;function Eu(n,e){return e===void 0&&(e=0),n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}Fe.readInt32BE=Eu;function Su(n,e){return e===void 0&&(e=0),(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}Fe.readUint32BE=Su;function Iu(n,e){return e===void 0&&(e=0),n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]}Fe.readInt32LE=Iu;function Ou(n,e){return e===void 0&&(e=0),(n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e])>>>0}Fe.readUint32LE=Ou;function Jo(n,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=n>>>24,e[t+1]=n>>>16,e[t+2]=n>>>8,e[t+3]=n>>>0,e}Fe.writeUint32BE=Jo;Fe.writeInt32BE=Jo;function Qo(n,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=n>>>0,e[t+1]=n>>>8,e[t+2]=n>>>16,e[t+3]=n>>>24,e}Fe.writeUint32LE=Qo;Fe.writeInt32LE=Qo;function wE(n,e){e===void 0&&(e=0);var t=Eu(n,e),s=Eu(n,e+4);return t*4294967296+s-(s>>31)*4294967296}Fe.readInt64BE=wE;function EE(n,e){e===void 0&&(e=0);var t=Su(n,e),s=Su(n,e+4);return t*4294967296+s}Fe.readUint64BE=EE;function SE(n,e){e===void 0&&(e=0);var t=Iu(n,e),s=Iu(n,e+4);return s*4294967296+t-(t>>31)*4294967296}Fe.readInt64LE=SE;function IE(n,e){e===void 0&&(e=0);var t=Ou(n,e),s=Ou(n,e+4);return s*4294967296+t}Fe.readUint64LE=IE;function bp(n,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Jo(n/4294967296>>>0,e,t),Jo(n>>>0,e,t+4),e}Fe.writeUint64BE=bp;Fe.writeInt64BE=bp;function wp(n,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Qo(n>>>0,e,t),Qo(n/4294967296>>>0,e,t+4),e}Fe.writeUint64LE=wp;Fe.writeInt64LE=wp;function OE(n,e,t){if(t===void 0&&(t=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,c=n/8+t-1;c>=t;c--)s+=e[c]*o,o*=256;return s}Fe.readUintBE=OE;function xE(n,e,t){if(t===void 0&&(t=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,c=t;c<t+n/8;c++)s+=e[c]*o,o*=256;return s}Fe.readUintLE=xE;function PE(n,e,t,s){if(t===void 0&&(t=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!_p.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=n/8+s-1;c>=s;c--)t[c]=e/o&255,o*=256;return t}Fe.writeUintBE=PE;function TE(n,e,t,s){if(t===void 0&&(t=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!_p.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=s;c<s+n/8;c++)t[c]=e/o&255,o*=256;return t}Fe.writeUintLE=TE;function AE(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat32(e)}Fe.readFloat32BE=AE;function NE(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat32(e,!0)}Fe.readFloat32LE=NE;function CE(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat64(e)}Fe.readFloat64BE=CE;function RE(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat64(e,!0)}Fe.readFloat64LE=RE;function $E(n,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,n),e}Fe.writeFloat32BE=$E;function UE(n,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,n,!0),e}Fe.writeFloat32LE=UE;function DE(n,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,n),e}Fe.writeFloat64BE=DE;function FE(n,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,n,!0),e}Fe.writeFloat64LE=FE;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const e=oa,t=Fe,s=xr;n.defaultRandomSource=new e.SystemRandomSource;function o(p,S=n.defaultRandomSource){return S.randomBytes(p)}n.randomBytes=o;function c(p=n.defaultRandomSource){const S=o(4,p),T=(0,t.readUint32LE)(S);return(0,s.wipe)(S),T}n.randomUint32=c;const l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(p,S=l,T=n.defaultRandomSource){if(S.length<2)throw new Error("randomString charset is too short");if(S.length>256)throw new Error("randomString charset is too long");let x="";const A=S.length,U=256-256%A;for(;p>0;){const z=o(Math.ceil(p*256/U),T);for(let M=0;M<z.length&&p>0;M++){const ne=z[M];ne<U&&(x+=S.charAt(ne%A),p--)}(0,s.wipe)(z)}return x}n.randomString=f;function v(p,S=l,T=n.defaultRandomSource){const x=Math.ceil(p/(Math.log(S.length)/Math.LN2));return f(x,S,T)}n.randomStringForEntropy=v})(Fi);var Ep={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Fe,t=xr;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},f.prototype.update=function(v,p){if(p===void 0&&(p=v.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var S=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=v[S++],p--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(S=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,v,S,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=v[S++],p--;return this},f.prototype.finish=function(v){if(!this._finished){var p=this._bytesHashed,S=this._bufferLength,T=p/536870912|0,x=p<<3,A=p%128<112?128:256;this._buffer[S]=128;for(var U=S+1;U<A-8;U++)this._buffer[U]=0;e.writeUint32BE(T,this._buffer,A-8),e.writeUint32BE(x,this._buffer,A-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,A),this._finished=!0}for(var U=0;U<this.digestLength/8;U++)e.writeUint32BE(this._stateHi[U],v,U*8),e.writeUint32BE(this._stateLo[U],v,U*8+4);return this},f.prototype.digest=function(){var v=new Uint8Array(this.digestLength);return this.finish(v),v},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(v){return this._stateHi.set(v.stateHi),this._stateLo.set(v.stateLo),this._bufferLength=v.bufferLength,v.buffer&&this._buffer.set(v.buffer),this._bytesHashed=v.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(v){t.wipe(v.stateHi),t.wipe(v.stateLo),v.buffer&&t.wipe(v.buffer),v.bufferLength=0,v.bytesHashed=0},f}();n.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(f,v,p,S,T,x,A){for(var U=p[0],z=p[1],M=p[2],ne=p[3],y=p[4],E=p[5],m=p[6],w=p[7],g=S[0],u=S[1],b=S[2],K=S[3],k=S[4],oe=S[5],ce=S[6],ge=S[7],D,B,le,te,W,ee,Y,re;A>=128;){for(var xe=0;xe<16;xe++){var ie=8*xe+x;f[xe]=e.readUint32BE(T,ie),v[xe]=e.readUint32BE(T,ie+4)}for(var xe=0;xe<80;xe++){var be=U,he=z,ve=M,H=ne,q=y,$=E,d=m,C=w,se=g,fe=u,Ie=b,ze=K,Ve=k,Le=oe,yt=ce,_t=ge;if(D=w,B=ge,W=B&65535,ee=B>>>16,Y=D&65535,re=D>>>16,D=(y>>>14|k<<32-14)^(y>>>18|k<<32-18)^(k>>>41-32|y<<32-(41-32)),B=(k>>>14|y<<32-14)^(k>>>18|y<<32-18)^(y>>>41-32|k<<32-(41-32)),W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,D=y&E^~y&m,B=k&oe^~k&ce,W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,D=o[xe*2],B=o[xe*2+1],W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,D=f[xe%16],B=v[xe%16],W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,le=Y&65535|re<<16,te=W&65535|ee<<16,D=le,B=te,W=B&65535,ee=B>>>16,Y=D&65535,re=D>>>16,D=(U>>>28|g<<32-28)^(g>>>34-32|U<<32-(34-32))^(g>>>39-32|U<<32-(39-32)),B=(g>>>28|U<<32-28)^(U>>>34-32|g<<32-(34-32))^(U>>>39-32|g<<32-(39-32)),W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,D=U&z^U&M^z&M,B=g&u^g&b^u&b,W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,C=Y&65535|re<<16,_t=W&65535|ee<<16,D=H,B=ze,W=B&65535,ee=B>>>16,Y=D&65535,re=D>>>16,D=le,B=te,W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,H=Y&65535|re<<16,ze=W&65535|ee<<16,z=be,M=he,ne=ve,y=H,E=q,m=$,w=d,U=C,u=se,b=fe,K=Ie,k=ze,oe=Ve,ce=Le,ge=yt,g=_t,xe%16===15)for(var ie=0;ie<16;ie++)D=f[ie],B=v[ie],W=B&65535,ee=B>>>16,Y=D&65535,re=D>>>16,D=f[(ie+9)%16],B=v[(ie+9)%16],W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,le=f[(ie+1)%16],te=v[(ie+1)%16],D=(le>>>1|te<<32-1)^(le>>>8|te<<32-8)^le>>>7,B=(te>>>1|le<<32-1)^(te>>>8|le<<32-8)^(te>>>7|le<<32-7),W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,le=f[(ie+14)%16],te=v[(ie+14)%16],D=(le>>>19|te<<32-19)^(te>>>61-32|le<<32-(61-32))^le>>>6,B=(te>>>19|le<<32-19)^(le>>>61-32|te<<32-(61-32))^(te>>>6|le<<32-6),W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,f[ie]=Y&65535|re<<16,v[ie]=W&65535|ee<<16}D=U,B=g,W=B&65535,ee=B>>>16,Y=D&65535,re=D>>>16,D=p[0],B=S[0],W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[0]=U=Y&65535|re<<16,S[0]=g=W&65535|ee<<16,D=z,B=u,W=B&65535,ee=B>>>16,Y=D&65535,re=D>>>16,D=p[1],B=S[1],W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[1]=z=Y&65535|re<<16,S[1]=u=W&65535|ee<<16,D=M,B=b,W=B&65535,ee=B>>>16,Y=D&65535,re=D>>>16,D=p[2],B=S[2],W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[2]=M=Y&65535|re<<16,S[2]=b=W&65535|ee<<16,D=ne,B=K,W=B&65535,ee=B>>>16,Y=D&65535,re=D>>>16,D=p[3],B=S[3],W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[3]=ne=Y&65535|re<<16,S[3]=K=W&65535|ee<<16,D=y,B=k,W=B&65535,ee=B>>>16,Y=D&65535,re=D>>>16,D=p[4],B=S[4],W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[4]=y=Y&65535|re<<16,S[4]=k=W&65535|ee<<16,D=E,B=oe,W=B&65535,ee=B>>>16,Y=D&65535,re=D>>>16,D=p[5],B=S[5],W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[5]=E=Y&65535|re<<16,S[5]=oe=W&65535|ee<<16,D=m,B=ce,W=B&65535,ee=B>>>16,Y=D&65535,re=D>>>16,D=p[6],B=S[6],W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[6]=m=Y&65535|re<<16,S[6]=ce=W&65535|ee<<16,D=w,B=ge,W=B&65535,ee=B>>>16,Y=D&65535,re=D>>>16,D=p[7],B=S[7],W+=B&65535,ee+=B>>>16,Y+=D&65535,re+=D>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[7]=w=Y&65535|re<<16,S[7]=ge=W&65535|ee<<16,x+=128,A-=128}return x}function l(f){var v=new s;v.update(f);var p=v.digest();return v.clean(),p}n.hash=l})(Ep);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const e=Fi,t=Ep,s=xr;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function o(H){const q=new Float64Array(16);if(H)for(let $=0;$<H.length;$++)q[$]=H[$];return q}const c=new Uint8Array(32);c[0]=9;const l=o(),f=o([1]),v=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),S=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),T=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),x=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function A(H,q){for(let $=0;$<16;$++)H[$]=q[$]|0}function U(H){let q=1;for(let $=0;$<16;$++){let d=H[$]+q+65535;q=Math.floor(d/65536),H[$]=d-q*65536}H[0]+=q-1+37*(q-1)}function z(H,q,$){const d=~($-1);for(let C=0;C<16;C++){const se=d&(H[C]^q[C]);H[C]^=se,q[C]^=se}}function M(H,q){const $=o(),d=o();for(let C=0;C<16;C++)d[C]=q[C];U(d),U(d),U(d);for(let C=0;C<2;C++){$[0]=d[0]-65517;for(let fe=1;fe<15;fe++)$[fe]=d[fe]-65535-($[fe-1]>>16&1),$[fe-1]&=65535;$[15]=d[15]-32767-($[14]>>16&1);const se=$[15]>>16&1;$[14]&=65535,z(d,$,1-se)}for(let C=0;C<16;C++)H[2*C]=d[C]&255,H[2*C+1]=d[C]>>8}function ne(H,q){let $=0;for(let d=0;d<32;d++)$|=H[d]^q[d];return(1&$-1>>>8)-1}function y(H,q){const $=new Uint8Array(32),d=new Uint8Array(32);return M($,H),M(d,q),ne($,d)}function E(H){const q=new Uint8Array(32);return M(q,H),q[0]&1}function m(H,q){for(let $=0;$<16;$++)H[$]=q[2*$]+(q[2*$+1]<<8);H[15]&=32767}function w(H,q,$){for(let d=0;d<16;d++)H[d]=q[d]+$[d]}function g(H,q,$){for(let d=0;d<16;d++)H[d]=q[d]-$[d]}function u(H,q,$){let d,C,se=0,fe=0,Ie=0,ze=0,Ve=0,Le=0,yt=0,_t=0,Me=0,Oe=0,$e=0,Ue=0,qe=0,Te=0,De=0,Se=0,Ae=0,Be=0,Pe=0,ke=0,We=0,et=0,tt=0,Je=0,tr=0,hr=0,Yr=0,rr=0,sn=0,En=0,Mn=0,St=$[0],vt=$[1],It=$[2],Ot=$[3],wt=$[4],mt=$[5],Dt=$[6],Ft=$[7],xt=$[8],Lt=$[9],Pt=$[10],Nt=$[11],Tt=$[12],ht=$[13],jt=$[14],Mt=$[15];d=q[0],se+=d*St,fe+=d*vt,Ie+=d*It,ze+=d*Ot,Ve+=d*wt,Le+=d*mt,yt+=d*Dt,_t+=d*Ft,Me+=d*xt,Oe+=d*Lt,$e+=d*Pt,Ue+=d*Nt,qe+=d*Tt,Te+=d*ht,De+=d*jt,Se+=d*Mt,d=q[1],fe+=d*St,Ie+=d*vt,ze+=d*It,Ve+=d*Ot,Le+=d*wt,yt+=d*mt,_t+=d*Dt,Me+=d*Ft,Oe+=d*xt,$e+=d*Lt,Ue+=d*Pt,qe+=d*Nt,Te+=d*Tt,De+=d*ht,Se+=d*jt,Ae+=d*Mt,d=q[2],Ie+=d*St,ze+=d*vt,Ve+=d*It,Le+=d*Ot,yt+=d*wt,_t+=d*mt,Me+=d*Dt,Oe+=d*Ft,$e+=d*xt,Ue+=d*Lt,qe+=d*Pt,Te+=d*Nt,De+=d*Tt,Se+=d*ht,Ae+=d*jt,Be+=d*Mt,d=q[3],ze+=d*St,Ve+=d*vt,Le+=d*It,yt+=d*Ot,_t+=d*wt,Me+=d*mt,Oe+=d*Dt,$e+=d*Ft,Ue+=d*xt,qe+=d*Lt,Te+=d*Pt,De+=d*Nt,Se+=d*Tt,Ae+=d*ht,Be+=d*jt,Pe+=d*Mt,d=q[4],Ve+=d*St,Le+=d*vt,yt+=d*It,_t+=d*Ot,Me+=d*wt,Oe+=d*mt,$e+=d*Dt,Ue+=d*Ft,qe+=d*xt,Te+=d*Lt,De+=d*Pt,Se+=d*Nt,Ae+=d*Tt,Be+=d*ht,Pe+=d*jt,ke+=d*Mt,d=q[5],Le+=d*St,yt+=d*vt,_t+=d*It,Me+=d*Ot,Oe+=d*wt,$e+=d*mt,Ue+=d*Dt,qe+=d*Ft,Te+=d*xt,De+=d*Lt,Se+=d*Pt,Ae+=d*Nt,Be+=d*Tt,Pe+=d*ht,ke+=d*jt,We+=d*Mt,d=q[6],yt+=d*St,_t+=d*vt,Me+=d*It,Oe+=d*Ot,$e+=d*wt,Ue+=d*mt,qe+=d*Dt,Te+=d*Ft,De+=d*xt,Se+=d*Lt,Ae+=d*Pt,Be+=d*Nt,Pe+=d*Tt,ke+=d*ht,We+=d*jt,et+=d*Mt,d=q[7],_t+=d*St,Me+=d*vt,Oe+=d*It,$e+=d*Ot,Ue+=d*wt,qe+=d*mt,Te+=d*Dt,De+=d*Ft,Se+=d*xt,Ae+=d*Lt,Be+=d*Pt,Pe+=d*Nt,ke+=d*Tt,We+=d*ht,et+=d*jt,tt+=d*Mt,d=q[8],Me+=d*St,Oe+=d*vt,$e+=d*It,Ue+=d*Ot,qe+=d*wt,Te+=d*mt,De+=d*Dt,Se+=d*Ft,Ae+=d*xt,Be+=d*Lt,Pe+=d*Pt,ke+=d*Nt,We+=d*Tt,et+=d*ht,tt+=d*jt,Je+=d*Mt,d=q[9],Oe+=d*St,$e+=d*vt,Ue+=d*It,qe+=d*Ot,Te+=d*wt,De+=d*mt,Se+=d*Dt,Ae+=d*Ft,Be+=d*xt,Pe+=d*Lt,ke+=d*Pt,We+=d*Nt,et+=d*Tt,tt+=d*ht,Je+=d*jt,tr+=d*Mt,d=q[10],$e+=d*St,Ue+=d*vt,qe+=d*It,Te+=d*Ot,De+=d*wt,Se+=d*mt,Ae+=d*Dt,Be+=d*Ft,Pe+=d*xt,ke+=d*Lt,We+=d*Pt,et+=d*Nt,tt+=d*Tt,Je+=d*ht,tr+=d*jt,hr+=d*Mt,d=q[11],Ue+=d*St,qe+=d*vt,Te+=d*It,De+=d*Ot,Se+=d*wt,Ae+=d*mt,Be+=d*Dt,Pe+=d*Ft,ke+=d*xt,We+=d*Lt,et+=d*Pt,tt+=d*Nt,Je+=d*Tt,tr+=d*ht,hr+=d*jt,Yr+=d*Mt,d=q[12],qe+=d*St,Te+=d*vt,De+=d*It,Se+=d*Ot,Ae+=d*wt,Be+=d*mt,Pe+=d*Dt,ke+=d*Ft,We+=d*xt,et+=d*Lt,tt+=d*Pt,Je+=d*Nt,tr+=d*Tt,hr+=d*ht,Yr+=d*jt,rr+=d*Mt,d=q[13],Te+=d*St,De+=d*vt,Se+=d*It,Ae+=d*Ot,Be+=d*wt,Pe+=d*mt,ke+=d*Dt,We+=d*Ft,et+=d*xt,tt+=d*Lt,Je+=d*Pt,tr+=d*Nt,hr+=d*Tt,Yr+=d*ht,rr+=d*jt,sn+=d*Mt,d=q[14],De+=d*St,Se+=d*vt,Ae+=d*It,Be+=d*Ot,Pe+=d*wt,ke+=d*mt,We+=d*Dt,et+=d*Ft,tt+=d*xt,Je+=d*Lt,tr+=d*Pt,hr+=d*Nt,Yr+=d*Tt,rr+=d*ht,sn+=d*jt,En+=d*Mt,d=q[15],Se+=d*St,Ae+=d*vt,Be+=d*It,Pe+=d*Ot,ke+=d*wt,We+=d*mt,et+=d*Dt,tt+=d*Ft,Je+=d*xt,tr+=d*Lt,hr+=d*Pt,Yr+=d*Nt,rr+=d*Tt,sn+=d*ht,En+=d*jt,Mn+=d*Mt,se+=38*Ae,fe+=38*Be,Ie+=38*Pe,ze+=38*ke,Ve+=38*We,Le+=38*et,yt+=38*tt,_t+=38*Je,Me+=38*tr,Oe+=38*hr,$e+=38*Yr,Ue+=38*rr,qe+=38*sn,Te+=38*En,De+=38*Mn,C=1,d=se+C+65535,C=Math.floor(d/65536),se=d-C*65536,d=fe+C+65535,C=Math.floor(d/65536),fe=d-C*65536,d=Ie+C+65535,C=Math.floor(d/65536),Ie=d-C*65536,d=ze+C+65535,C=Math.floor(d/65536),ze=d-C*65536,d=Ve+C+65535,C=Math.floor(d/65536),Ve=d-C*65536,d=Le+C+65535,C=Math.floor(d/65536),Le=d-C*65536,d=yt+C+65535,C=Math.floor(d/65536),yt=d-C*65536,d=_t+C+65535,C=Math.floor(d/65536),_t=d-C*65536,d=Me+C+65535,C=Math.floor(d/65536),Me=d-C*65536,d=Oe+C+65535,C=Math.floor(d/65536),Oe=d-C*65536,d=$e+C+65535,C=Math.floor(d/65536),$e=d-C*65536,d=Ue+C+65535,C=Math.floor(d/65536),Ue=d-C*65536,d=qe+C+65535,C=Math.floor(d/65536),qe=d-C*65536,d=Te+C+65535,C=Math.floor(d/65536),Te=d-C*65536,d=De+C+65535,C=Math.floor(d/65536),De=d-C*65536,d=Se+C+65535,C=Math.floor(d/65536),Se=d-C*65536,se+=C-1+37*(C-1),C=1,d=se+C+65535,C=Math.floor(d/65536),se=d-C*65536,d=fe+C+65535,C=Math.floor(d/65536),fe=d-C*65536,d=Ie+C+65535,C=Math.floor(d/65536),Ie=d-C*65536,d=ze+C+65535,C=Math.floor(d/65536),ze=d-C*65536,d=Ve+C+65535,C=Math.floor(d/65536),Ve=d-C*65536,d=Le+C+65535,C=Math.floor(d/65536),Le=d-C*65536,d=yt+C+65535,C=Math.floor(d/65536),yt=d-C*65536,d=_t+C+65535,C=Math.floor(d/65536),_t=d-C*65536,d=Me+C+65535,C=Math.floor(d/65536),Me=d-C*65536,d=Oe+C+65535,C=Math.floor(d/65536),Oe=d-C*65536,d=$e+C+65535,C=Math.floor(d/65536),$e=d-C*65536,d=Ue+C+65535,C=Math.floor(d/65536),Ue=d-C*65536,d=qe+C+65535,C=Math.floor(d/65536),qe=d-C*65536,d=Te+C+65535,C=Math.floor(d/65536),Te=d-C*65536,d=De+C+65535,C=Math.floor(d/65536),De=d-C*65536,d=Se+C+65535,C=Math.floor(d/65536),Se=d-C*65536,se+=C-1+37*(C-1),H[0]=se,H[1]=fe,H[2]=Ie,H[3]=ze,H[4]=Ve,H[5]=Le,H[6]=yt,H[7]=_t,H[8]=Me,H[9]=Oe,H[10]=$e,H[11]=Ue,H[12]=qe,H[13]=Te,H[14]=De,H[15]=Se}function b(H,q){u(H,q,q)}function K(H,q){const $=o();let d;for(d=0;d<16;d++)$[d]=q[d];for(d=253;d>=0;d--)b($,$),d!==2&&d!==4&&u($,$,q);for(d=0;d<16;d++)H[d]=$[d]}function k(H,q){const $=o();let d;for(d=0;d<16;d++)$[d]=q[d];for(d=250;d>=0;d--)b($,$),d!==1&&u($,$,q);for(d=0;d<16;d++)H[d]=$[d]}function oe(H,q){const $=o(),d=o(),C=o(),se=o(),fe=o(),Ie=o(),ze=o(),Ve=o(),Le=o();g($,H[1],H[0]),g(Le,q[1],q[0]),u($,$,Le),w(d,H[0],H[1]),w(Le,q[0],q[1]),u(d,d,Le),u(C,H[3],q[3]),u(C,C,p),u(se,H[2],q[2]),w(se,se,se),g(fe,d,$),g(Ie,se,C),w(ze,se,C),w(Ve,d,$),u(H[0],fe,Ie),u(H[1],Ve,ze),u(H[2],ze,Ie),u(H[3],fe,Ve)}function ce(H,q,$){for(let d=0;d<4;d++)z(H[d],q[d],$)}function ge(H,q){const $=o(),d=o(),C=o();K(C,q[2]),u($,q[0],C),u(d,q[1],C),M(H,d),H[31]^=E($)<<7}function D(H,q,$){A(H[0],l),A(H[1],f),A(H[2],f),A(H[3],l);for(let d=255;d>=0;--d){const C=$[d/8|0]>>(d&7)&1;ce(H,q,C),oe(q,H),oe(H,H),ce(H,q,C)}}function B(H,q){const $=[o(),o(),o(),o()];A($[0],S),A($[1],T),A($[2],f),u($[3],S,T),D(H,$,q)}function le(H){if(H.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const q=(0,t.hash)(H);q[0]&=248,q[31]&=127,q[31]|=64;const $=new Uint8Array(32),d=[o(),o(),o(),o()];B(d,q),ge($,d);const C=new Uint8Array(64);return C.set(H),C.set($,32),{publicKey:$,secretKey:C}}n.generateKeyPairFromSeed=le;function te(H){const q=(0,e.randomBytes)(32,H),$=le(q);return(0,s.wipe)(q),$}n.generateKeyPair=te;function W(H){if(H.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(H.subarray(32))}n.extractPublicKeyFromSecretKey=W;const ee=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Y(H,q){let $,d,C,se;for(d=63;d>=32;--d){for($=0,C=d-32,se=d-12;C<se;++C)q[C]+=$-16*q[d]*ee[C-(d-32)],$=Math.floor((q[C]+128)/256),q[C]-=$*256;q[C]+=$,q[d]=0}for($=0,C=0;C<32;C++)q[C]+=$-(q[31]>>4)*ee[C],$=q[C]>>8,q[C]&=255;for(C=0;C<32;C++)q[C]-=$*ee[C];for(d=0;d<32;d++)q[d+1]+=q[d]>>8,H[d]=q[d]&255}function re(H){const q=new Float64Array(64);for(let $=0;$<64;$++)q[$]=H[$];for(let $=0;$<64;$++)H[$]=0;Y(H,q)}function xe(H,q){const $=new Float64Array(64),d=[o(),o(),o(),o()],C=(0,t.hash)(H.subarray(0,32));C[0]&=248,C[31]&=127,C[31]|=64;const se=new Uint8Array(64);se.set(C.subarray(32),32);const fe=new t.SHA512;fe.update(se.subarray(32)),fe.update(q);const Ie=fe.digest();fe.clean(),re(Ie),B(d,Ie),ge(se,d),fe.reset(),fe.update(se.subarray(0,32)),fe.update(H.subarray(32)),fe.update(q);const ze=fe.digest();re(ze);for(let Ve=0;Ve<32;Ve++)$[Ve]=Ie[Ve];for(let Ve=0;Ve<32;Ve++)for(let Le=0;Le<32;Le++)$[Ve+Le]+=ze[Ve]*C[Le];return Y(se.subarray(32),$),se}n.sign=xe;function ie(H,q){const $=o(),d=o(),C=o(),se=o(),fe=o(),Ie=o(),ze=o();return A(H[2],f),m(H[1],q),b(C,H[1]),u(se,C,v),g(C,C,H[2]),w(se,H[2],se),b(fe,se),b(Ie,fe),u(ze,Ie,fe),u($,ze,C),u($,$,se),k($,$),u($,$,C),u($,$,se),u($,$,se),u(H[0],$,se),b(d,H[0]),u(d,d,se),y(d,C)&&u(H[0],H[0],x),b(d,H[0]),u(d,d,se),y(d,C)?-1:(E(H[0])===q[31]>>7&&g(H[0],l,H[0]),u(H[3],H[0],H[1]),0)}function be(H,q,$){const d=new Uint8Array(32),C=[o(),o(),o(),o()],se=[o(),o(),o(),o()];if($.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(ie(se,H))return!1;const fe=new t.SHA512;fe.update($.subarray(0,32)),fe.update(H),fe.update(q);const Ie=fe.digest();return re(Ie),D(C,se,Ie),B(se,$.subarray(32)),oe(C,se),ge(d,C),!ne($,d)}n.verify=be;function he(H){let q=[o(),o(),o(),o()];if(ie(q,H))throw new Error("Ed25519: invalid public key");let $=o(),d=o(),C=q[1];w($,f,C),g(d,f,C),K(d,d),u($,$,d);let se=new Uint8Array(32);return M(se,$),se}n.convertPublicKeyToX25519=he;function ve(H){const q=(0,t.hash)(H.subarray(0,32));q[0]&=248,q[31]&=127,q[31]|=64;const $=new Uint8Array(q.subarray(0,32));return(0,s.wipe)(q),$}n.convertSecretKeyToX25519=ve})(Ku);const LE="EdDSA",jE="JWT",Sp=".",Ip="base64url",ME="utf8",qE="utf8",HE=":",zE="did",BE="key",Vf="base58btc",KE="z",VE="K36",kE=32;function Vu(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function Op(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Vu(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function GE(n,e){e||(e=n.reduce((o,c)=>o+c.length,0));const t=Op(e);let s=0;for(const o of n)t.set(o,s),s+=o.length;return Vu(t)}function xp(n,e,t,s){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:s}}}const kf=xp("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Yc=xp("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=Op(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),Pp={utf8:kf,"utf-8":kf,hex:Un.base16,latin1:Yc,ascii:Yc,binary:Yc,...Un};function ku(n,e="utf8"){const t=Pp[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):t.encoder.encode(n).substring(1)}function Gu(n,e="utf8"){const t=Pp[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Vu(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}function Xo(n){return ku(Gu(xs(n),ME),Ip)}function Tp(n){const e=Gu(VE,Vf),t=KE+ku(GE([e,n]),Vf);return[zE,BE,t].join(HE)}function WE(n){return ku(n,Ip)}function YE(n){return Gu([Xo(n.header),Xo(n.payload)].join(Sp),qE)}function JE(n){return[Xo(n.header),Xo(n.payload),WE(n.signature)].join(Sp)}function Gf(n=Fi.randomBytes(kE)){return Ku.generateKeyPairFromSeed(n)}async function QE(n,e,t,s,o=_e.fromMiliseconds(Date.now())){const c={alg:LE,typ:jE},l=Tp(s.publicKey),f=o+t,v={iss:l,sub:n,aud:e,iat:o,exp:f},p=YE({header:c,payload:v}),S=Ku.sign(s.secretKey,p);return JE({header:c,payload:v,signature:S})}var Wu={},ua={};Object.defineProperty(ua,"__esModule",{value:!0});var Zt=Fe,xu=xr,XE=20;function ZE(n,e,t){for(var s=1634760805,o=857760878,c=2036477234,l=1797285236,f=t[3]<<24|t[2]<<16|t[1]<<8|t[0],v=t[7]<<24|t[6]<<16|t[5]<<8|t[4],p=t[11]<<24|t[10]<<16|t[9]<<8|t[8],S=t[15]<<24|t[14]<<16|t[13]<<8|t[12],T=t[19]<<24|t[18]<<16|t[17]<<8|t[16],x=t[23]<<24|t[22]<<16|t[21]<<8|t[20],A=t[27]<<24|t[26]<<16|t[25]<<8|t[24],U=t[31]<<24|t[30]<<16|t[29]<<8|t[28],z=e[3]<<24|e[2]<<16|e[1]<<8|e[0],M=e[7]<<24|e[6]<<16|e[5]<<8|e[4],ne=e[11]<<24|e[10]<<16|e[9]<<8|e[8],y=e[15]<<24|e[14]<<16|e[13]<<8|e[12],E=s,m=o,w=c,g=l,u=f,b=v,K=p,k=S,oe=T,ce=x,ge=A,D=U,B=z,le=M,te=ne,W=y,ee=0;ee<XE;ee+=2)E=E+u|0,B^=E,B=B>>>32-16|B<<16,oe=oe+B|0,u^=oe,u=u>>>32-12|u<<12,m=m+b|0,le^=m,le=le>>>32-16|le<<16,ce=ce+le|0,b^=ce,b=b>>>32-12|b<<12,w=w+K|0,te^=w,te=te>>>32-16|te<<16,ge=ge+te|0,K^=ge,K=K>>>32-12|K<<12,g=g+k|0,W^=g,W=W>>>32-16|W<<16,D=D+W|0,k^=D,k=k>>>32-12|k<<12,w=w+K|0,te^=w,te=te>>>32-8|te<<8,ge=ge+te|0,K^=ge,K=K>>>32-7|K<<7,g=g+k|0,W^=g,W=W>>>32-8|W<<8,D=D+W|0,k^=D,k=k>>>32-7|k<<7,m=m+b|0,le^=m,le=le>>>32-8|le<<8,ce=ce+le|0,b^=ce,b=b>>>32-7|b<<7,E=E+u|0,B^=E,B=B>>>32-8|B<<8,oe=oe+B|0,u^=oe,u=u>>>32-7|u<<7,E=E+b|0,W^=E,W=W>>>32-16|W<<16,ge=ge+W|0,b^=ge,b=b>>>32-12|b<<12,m=m+K|0,B^=m,B=B>>>32-16|B<<16,D=D+B|0,K^=D,K=K>>>32-12|K<<12,w=w+k|0,le^=w,le=le>>>32-16|le<<16,oe=oe+le|0,k^=oe,k=k>>>32-12|k<<12,g=g+u|0,te^=g,te=te>>>32-16|te<<16,ce=ce+te|0,u^=ce,u=u>>>32-12|u<<12,w=w+k|0,le^=w,le=le>>>32-8|le<<8,oe=oe+le|0,k^=oe,k=k>>>32-7|k<<7,g=g+u|0,te^=g,te=te>>>32-8|te<<8,ce=ce+te|0,u^=ce,u=u>>>32-7|u<<7,m=m+K|0,B^=m,B=B>>>32-8|B<<8,D=D+B|0,K^=D,K=K>>>32-7|K<<7,E=E+b|0,W^=E,W=W>>>32-8|W<<8,ge=ge+W|0,b^=ge,b=b>>>32-7|b<<7;Zt.writeUint32LE(E+s|0,n,0),Zt.writeUint32LE(m+o|0,n,4),Zt.writeUint32LE(w+c|0,n,8),Zt.writeUint32LE(g+l|0,n,12),Zt.writeUint32LE(u+f|0,n,16),Zt.writeUint32LE(b+v|0,n,20),Zt.writeUint32LE(K+p|0,n,24),Zt.writeUint32LE(k+S|0,n,28),Zt.writeUint32LE(oe+T|0,n,32),Zt.writeUint32LE(ce+x|0,n,36),Zt.writeUint32LE(ge+A|0,n,40),Zt.writeUint32LE(D+U|0,n,44),Zt.writeUint32LE(B+z|0,n,48),Zt.writeUint32LE(le+M|0,n,52),Zt.writeUint32LE(te+ne|0,n,56),Zt.writeUint32LE(W+y|0,n,60)}function Ap(n,e,t,s,o){if(o===void 0&&(o=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,l;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),l=c.length-e.length,c.set(e,l)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,l=o}for(var f=new Uint8Array(64),v=0;v<t.length;v+=64){ZE(f,c,n);for(var p=v;p<v+64&&p<t.length;p++)s[p]=t[p]^f[p-v];tS(c,0,l)}return xu.wipe(f),o===0&&xu.wipe(c),s}ua.streamXOR=Ap;function eS(n,e,t,s){return s===void 0&&(s=0),xu.wipe(t),Ap(n,e,t,t,s)}ua.stream=eS;function tS(n,e,t){for(var s=1;t--;)s=s+(n[e]&255)|0,n[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var Np={},Fn={};Object.defineProperty(Fn,"__esModule",{value:!0});function rS(n,e,t){return~(n-1)&e|n-1&t}Fn.select=rS;function nS(n,e){return(n|0)-(e|0)-1>>>31&1}Fn.lessOrEqual=nS;function Cp(n,e){if(n.length!==e.length)return 0;for(var t=0,s=0;s<n.length;s++)t|=n[s]^e[s];return 1&t-1>>>8}Fn.compare=Cp;function iS(n,e){return n.length===0||e.length===0?!1:Cp(n,e)!==0}Fn.equal=iS;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Fn,t=xr;n.DIGEST_LENGTH=16;var s=function(){function l(f){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var v=f[0]|f[1]<<8;this._r[0]=v&8191;var p=f[2]|f[3]<<8;this._r[1]=(v>>>13|p<<3)&8191;var S=f[4]|f[5]<<8;this._r[2]=(p>>>10|S<<6)&7939;var T=f[6]|f[7]<<8;this._r[3]=(S>>>7|T<<9)&8191;var x=f[8]|f[9]<<8;this._r[4]=(T>>>4|x<<12)&255,this._r[5]=x>>>1&8190;var A=f[10]|f[11]<<8;this._r[6]=(x>>>14|A<<2)&8191;var U=f[12]|f[13]<<8;this._r[7]=(A>>>11|U<<5)&8065;var z=f[14]|f[15]<<8;this._r[8]=(U>>>8|z<<8)&8191,this._r[9]=z>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return l.prototype._blocks=function(f,v,p){for(var S=this._fin?0:2048,T=this._h[0],x=this._h[1],A=this._h[2],U=this._h[3],z=this._h[4],M=this._h[5],ne=this._h[6],y=this._h[7],E=this._h[8],m=this._h[9],w=this._r[0],g=this._r[1],u=this._r[2],b=this._r[3],K=this._r[4],k=this._r[5],oe=this._r[6],ce=this._r[7],ge=this._r[8],D=this._r[9];p>=16;){var B=f[v+0]|f[v+1]<<8;T+=B&8191;var le=f[v+2]|f[v+3]<<8;x+=(B>>>13|le<<3)&8191;var te=f[v+4]|f[v+5]<<8;A+=(le>>>10|te<<6)&8191;var W=f[v+6]|f[v+7]<<8;U+=(te>>>7|W<<9)&8191;var ee=f[v+8]|f[v+9]<<8;z+=(W>>>4|ee<<12)&8191,M+=ee>>>1&8191;var Y=f[v+10]|f[v+11]<<8;ne+=(ee>>>14|Y<<2)&8191;var re=f[v+12]|f[v+13]<<8;y+=(Y>>>11|re<<5)&8191;var xe=f[v+14]|f[v+15]<<8;E+=(re>>>8|xe<<8)&8191,m+=xe>>>5|S;var ie=0,be=ie;be+=T*w,be+=x*(5*D),be+=A*(5*ge),be+=U*(5*ce),be+=z*(5*oe),ie=be>>>13,be&=8191,be+=M*(5*k),be+=ne*(5*K),be+=y*(5*b),be+=E*(5*u),be+=m*(5*g),ie+=be>>>13,be&=8191;var he=ie;he+=T*g,he+=x*w,he+=A*(5*D),he+=U*(5*ge),he+=z*(5*ce),ie=he>>>13,he&=8191,he+=M*(5*oe),he+=ne*(5*k),he+=y*(5*K),he+=E*(5*b),he+=m*(5*u),ie+=he>>>13,he&=8191;var ve=ie;ve+=T*u,ve+=x*g,ve+=A*w,ve+=U*(5*D),ve+=z*(5*ge),ie=ve>>>13,ve&=8191,ve+=M*(5*ce),ve+=ne*(5*oe),ve+=y*(5*k),ve+=E*(5*K),ve+=m*(5*b),ie+=ve>>>13,ve&=8191;var H=ie;H+=T*b,H+=x*u,H+=A*g,H+=U*w,H+=z*(5*D),ie=H>>>13,H&=8191,H+=M*(5*ge),H+=ne*(5*ce),H+=y*(5*oe),H+=E*(5*k),H+=m*(5*K),ie+=H>>>13,H&=8191;var q=ie;q+=T*K,q+=x*b,q+=A*u,q+=U*g,q+=z*w,ie=q>>>13,q&=8191,q+=M*(5*D),q+=ne*(5*ge),q+=y*(5*ce),q+=E*(5*oe),q+=m*(5*k),ie+=q>>>13,q&=8191;var $=ie;$+=T*k,$+=x*K,$+=A*b,$+=U*u,$+=z*g,ie=$>>>13,$&=8191,$+=M*w,$+=ne*(5*D),$+=y*(5*ge),$+=E*(5*ce),$+=m*(5*oe),ie+=$>>>13,$&=8191;var d=ie;d+=T*oe,d+=x*k,d+=A*K,d+=U*b,d+=z*u,ie=d>>>13,d&=8191,d+=M*g,d+=ne*w,d+=y*(5*D),d+=E*(5*ge),d+=m*(5*ce),ie+=d>>>13,d&=8191;var C=ie;C+=T*ce,C+=x*oe,C+=A*k,C+=U*K,C+=z*b,ie=C>>>13,C&=8191,C+=M*u,C+=ne*g,C+=y*w,C+=E*(5*D),C+=m*(5*ge),ie+=C>>>13,C&=8191;var se=ie;se+=T*ge,se+=x*ce,se+=A*oe,se+=U*k,se+=z*K,ie=se>>>13,se&=8191,se+=M*b,se+=ne*u,se+=y*g,se+=E*w,se+=m*(5*D),ie+=se>>>13,se&=8191;var fe=ie;fe+=T*D,fe+=x*ge,fe+=A*ce,fe+=U*oe,fe+=z*k,ie=fe>>>13,fe&=8191,fe+=M*K,fe+=ne*b,fe+=y*u,fe+=E*g,fe+=m*w,ie+=fe>>>13,fe&=8191,ie=(ie<<2)+ie|0,ie=ie+be|0,be=ie&8191,ie=ie>>>13,he+=ie,T=be,x=he,A=ve,U=H,z=q,M=$,ne=d,y=C,E=se,m=fe,v+=16,p-=16}this._h[0]=T,this._h[1]=x,this._h[2]=A,this._h[3]=U,this._h[4]=z,this._h[5]=M,this._h[6]=ne,this._h[7]=y,this._h[8]=E,this._h[9]=m},l.prototype.finish=function(f,v){v===void 0&&(v=0);var p=new Uint16Array(10),S,T,x,A;if(this._leftover){for(A=this._leftover,this._buffer[A++]=1;A<16;A++)this._buffer[A]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(S=this._h[1]>>>13,this._h[1]&=8191,A=2;A<10;A++)this._h[A]+=S,S=this._h[A]>>>13,this._h[A]&=8191;for(this._h[0]+=S*5,S=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=S,S=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=S,p[0]=this._h[0]+5,S=p[0]>>>13,p[0]&=8191,A=1;A<10;A++)p[A]=this._h[A]+S,S=p[A]>>>13,p[A]&=8191;for(p[9]-=8192,T=(S^1)-1,A=0;A<10;A++)p[A]&=T;for(T=~T,A=0;A<10;A++)this._h[A]=this._h[A]&T|p[A];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,x=this._h[0]+this._pad[0],this._h[0]=x&65535,A=1;A<8;A++)x=(this._h[A]+this._pad[A]|0)+(x>>>16)|0,this._h[A]=x&65535;return f[v+0]=this._h[0]>>>0,f[v+1]=this._h[0]>>>8,f[v+2]=this._h[1]>>>0,f[v+3]=this._h[1]>>>8,f[v+4]=this._h[2]>>>0,f[v+5]=this._h[2]>>>8,f[v+6]=this._h[3]>>>0,f[v+7]=this._h[3]>>>8,f[v+8]=this._h[4]>>>0,f[v+9]=this._h[4]>>>8,f[v+10]=this._h[5]>>>0,f[v+11]=this._h[5]>>>8,f[v+12]=this._h[6]>>>0,f[v+13]=this._h[6]>>>8,f[v+14]=this._h[7]>>>0,f[v+15]=this._h[7]>>>8,this._finished=!0,this},l.prototype.update=function(f){var v=0,p=f.length,S;if(this._leftover){S=16-this._leftover,S>p&&(S=p);for(var T=0;T<S;T++)this._buffer[this._leftover+T]=f[v+T];if(p-=S,v+=S,this._leftover+=S,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(p>=16&&(S=p-p%16,this._blocks(f,v,S),v+=S,p-=S),p){for(var T=0;T<p;T++)this._buffer[this._leftover+T]=f[v+T];this._leftover+=p}return this},l.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},l.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},l}();n.Poly1305=s;function o(l,f){var v=new s(l);v.update(f);var p=v.digest();return v.clean(),p}n.oneTimeAuth=o;function c(l,f){return l.length!==n.DIGEST_LENGTH||f.length!==n.DIGEST_LENGTH?!1:e.equal(l,f)}n.equal=c})(Np);(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=ua,t=Np,s=xr,o=Fe,c=Fn;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var l=new Uint8Array(16),f=function(){function v(p){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,p.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(p)}return v.prototype.seal=function(p,S,T,x){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var A=new Uint8Array(16);A.set(p,A.length-p.length);var U=new Uint8Array(32);e.stream(this._key,A,U,4);var z=S.length+this.tagLength,M;if(x){if(x.length!==z)throw new Error("ChaCha20Poly1305: incorrect destination length");M=x}else M=new Uint8Array(z);return e.streamXOR(this._key,A,S,M,4),this._authenticate(M.subarray(M.length-this.tagLength,M.length),U,M.subarray(0,M.length-this.tagLength),T),s.wipe(A),M},v.prototype.open=function(p,S,T,x){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(S.length<this.tagLength)return null;var A=new Uint8Array(16);A.set(p,A.length-p.length);var U=new Uint8Array(32);e.stream(this._key,A,U,4);var z=new Uint8Array(this.tagLength);if(this._authenticate(z,U,S.subarray(0,S.length-this.tagLength),T),!c.equal(z,S.subarray(S.length-this.tagLength,S.length)))return null;var M=S.length-this.tagLength,ne;if(x){if(x.length!==M)throw new Error("ChaCha20Poly1305: incorrect destination length");ne=x}else ne=new Uint8Array(M);return e.streamXOR(this._key,A,S.subarray(0,S.length-this.tagLength),ne,4),s.wipe(A),ne},v.prototype.clean=function(){return s.wipe(this._key),this},v.prototype._authenticate=function(p,S,T,x){var A=new t.Poly1305(S);x&&(A.update(x),x.length%16>0&&A.update(l.subarray(x.length%16))),A.update(T),T.length%16>0&&A.update(l.subarray(T.length%16));var U=new Uint8Array(8);x&&o.writeUint64LE(x.length,U),A.update(U),o.writeUint64LE(T.length,U),A.update(U);for(var z=A.digest(),M=0;M<z.length;M++)p[M]=z[M];A.clean(),s.wipe(z),s.wipe(U)},v}();n.ChaCha20Poly1305=f})(Wu);var Rp={},Rs={},Yu={};Object.defineProperty(Yu,"__esModule",{value:!0});function sS(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}Yu.isSerializableHash=sS;Object.defineProperty(Rs,"__esModule",{value:!0});var tn=Yu,oS=Fn,aS=xr,$p=function(){function n(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),tn.isSerializableHash(this._inner)&&tn.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),aS.wipe(s)}return n.prototype.reset=function(){if(!tn.isSerializableHash(this._inner)||!tn.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){tn.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),tn.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(e){return this._inner.update(e),this},n.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},n.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},n.prototype.saveState=function(){if(!tn.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(e){if(!tn.isSerializableHash(this._inner)||!tn.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(e){if(!tn.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},n}();Rs.HMAC=$p;function cS(n,e,t){var s=new $p(n,e);s.update(t);var o=s.digest();return s.clean(),o}Rs.hmac=cS;Rs.equal=oS.equal;Object.defineProperty(Rp,"__esModule",{value:!0});var Wf=Rs,Yf=xr,uS=function(){function n(e,t,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var c=Wf.hmac(this._hash,s,t);this._hmac=new Wf.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},n.prototype.clean=function(){this._hmac.clean(),Yf.wipe(this._buffer),Yf.wipe(this._counter),this._bufpos=0},n}(),hS=Rp.HKDF=uS,ha={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Fe,t=xr;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},f.prototype.update=function(v,p){if(p===void 0&&(p=v.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var S=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&p>0;)this._buffer[this._bufferLength++]=v[S++],p--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(S=c(this._temp,this._state,v,S,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=v[S++],p--;return this},f.prototype.finish=function(v){if(!this._finished){var p=this._bytesHashed,S=this._bufferLength,T=p/536870912|0,x=p<<3,A=p%64<56?64:128;this._buffer[S]=128;for(var U=S+1;U<A-8;U++)this._buffer[U]=0;e.writeUint32BE(T,this._buffer,A-8),e.writeUint32BE(x,this._buffer,A-4),c(this._temp,this._state,this._buffer,0,A),this._finished=!0}for(var U=0;U<this.digestLength/4;U++)e.writeUint32BE(this._state[U],v,U*4);return this},f.prototype.digest=function(){var v=new Uint8Array(this.digestLength);return this.finish(v),v},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(v){return this._state.set(v.state),this._bufferLength=v.bufferLength,v.buffer&&this._buffer.set(v.buffer),this._bytesHashed=v.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(v){t.wipe(v.state),v.buffer&&t.wipe(v.buffer),v.bufferLength=0,v.bytesHashed=0},f}();n.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(f,v,p,S,T){for(;T>=64;){for(var x=v[0],A=v[1],U=v[2],z=v[3],M=v[4],ne=v[5],y=v[6],E=v[7],m=0;m<16;m++){var w=S+m*4;f[m]=e.readUint32BE(p,w)}for(var m=16;m<64;m++){var g=f[m-2],u=(g>>>17|g<<32-17)^(g>>>19|g<<32-19)^g>>>10;g=f[m-15];var b=(g>>>7|g<<32-7)^(g>>>18|g<<32-18)^g>>>3;f[m]=(u+f[m-7]|0)+(b+f[m-16]|0)}for(var m=0;m<64;m++){var u=(((M>>>6|M<<26)^(M>>>11|M<<21)^(M>>>25|M<<7))+(M&ne^~M&y)|0)+(E+(o[m]+f[m]|0)|0)|0,b=((x>>>2|x<<32-2)^(x>>>13|x<<32-13)^(x>>>22|x<<32-22))+(x&A^x&U^A&U)|0;E=y,y=ne,ne=M,M=z+u|0,z=U,U=A,A=x,x=u+b|0}v[0]+=x,v[1]+=A,v[2]+=U,v[3]+=z,v[4]+=M,v[5]+=ne,v[6]+=y,v[7]+=E,S+=64,T-=64}return S}function l(f){var v=new s;v.update(f);var p=v.digest();return v.clean(),p}n.hash=l})(ha);var Ju={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const e=Fi,t=xr;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(m){const w=new Float64Array(16);if(m)for(let g=0;g<m.length;g++)w[g]=m[g];return w}const o=new Uint8Array(32);o[0]=9;const c=s([56129,1]);function l(m){let w=1;for(let g=0;g<16;g++){let u=m[g]+w+65535;w=Math.floor(u/65536),m[g]=u-w*65536}m[0]+=w-1+37*(w-1)}function f(m,w,g){const u=~(g-1);for(let b=0;b<16;b++){const K=u&(m[b]^w[b]);m[b]^=K,w[b]^=K}}function v(m,w){const g=s(),u=s();for(let b=0;b<16;b++)u[b]=w[b];l(u),l(u),l(u);for(let b=0;b<2;b++){g[0]=u[0]-65517;for(let k=1;k<15;k++)g[k]=u[k]-65535-(g[k-1]>>16&1),g[k-1]&=65535;g[15]=u[15]-32767-(g[14]>>16&1);const K=g[15]>>16&1;g[14]&=65535,f(u,g,1-K)}for(let b=0;b<16;b++)m[2*b]=u[b]&255,m[2*b+1]=u[b]>>8}function p(m,w){for(let g=0;g<16;g++)m[g]=w[2*g]+(w[2*g+1]<<8);m[15]&=32767}function S(m,w,g){for(let u=0;u<16;u++)m[u]=w[u]+g[u]}function T(m,w,g){for(let u=0;u<16;u++)m[u]=w[u]-g[u]}function x(m,w,g){let u,b,K=0,k=0,oe=0,ce=0,ge=0,D=0,B=0,le=0,te=0,W=0,ee=0,Y=0,re=0,xe=0,ie=0,be=0,he=0,ve=0,H=0,q=0,$=0,d=0,C=0,se=0,fe=0,Ie=0,ze=0,Ve=0,Le=0,yt=0,_t=0,Me=g[0],Oe=g[1],$e=g[2],Ue=g[3],qe=g[4],Te=g[5],De=g[6],Se=g[7],Ae=g[8],Be=g[9],Pe=g[10],ke=g[11],We=g[12],et=g[13],tt=g[14],Je=g[15];u=w[0],K+=u*Me,k+=u*Oe,oe+=u*$e,ce+=u*Ue,ge+=u*qe,D+=u*Te,B+=u*De,le+=u*Se,te+=u*Ae,W+=u*Be,ee+=u*Pe,Y+=u*ke,re+=u*We,xe+=u*et,ie+=u*tt,be+=u*Je,u=w[1],k+=u*Me,oe+=u*Oe,ce+=u*$e,ge+=u*Ue,D+=u*qe,B+=u*Te,le+=u*De,te+=u*Se,W+=u*Ae,ee+=u*Be,Y+=u*Pe,re+=u*ke,xe+=u*We,ie+=u*et,be+=u*tt,he+=u*Je,u=w[2],oe+=u*Me,ce+=u*Oe,ge+=u*$e,D+=u*Ue,B+=u*qe,le+=u*Te,te+=u*De,W+=u*Se,ee+=u*Ae,Y+=u*Be,re+=u*Pe,xe+=u*ke,ie+=u*We,be+=u*et,he+=u*tt,ve+=u*Je,u=w[3],ce+=u*Me,ge+=u*Oe,D+=u*$e,B+=u*Ue,le+=u*qe,te+=u*Te,W+=u*De,ee+=u*Se,Y+=u*Ae,re+=u*Be,xe+=u*Pe,ie+=u*ke,be+=u*We,he+=u*et,ve+=u*tt,H+=u*Je,u=w[4],ge+=u*Me,D+=u*Oe,B+=u*$e,le+=u*Ue,te+=u*qe,W+=u*Te,ee+=u*De,Y+=u*Se,re+=u*Ae,xe+=u*Be,ie+=u*Pe,be+=u*ke,he+=u*We,ve+=u*et,H+=u*tt,q+=u*Je,u=w[5],D+=u*Me,B+=u*Oe,le+=u*$e,te+=u*Ue,W+=u*qe,ee+=u*Te,Y+=u*De,re+=u*Se,xe+=u*Ae,ie+=u*Be,be+=u*Pe,he+=u*ke,ve+=u*We,H+=u*et,q+=u*tt,$+=u*Je,u=w[6],B+=u*Me,le+=u*Oe,te+=u*$e,W+=u*Ue,ee+=u*qe,Y+=u*Te,re+=u*De,xe+=u*Se,ie+=u*Ae,be+=u*Be,he+=u*Pe,ve+=u*ke,H+=u*We,q+=u*et,$+=u*tt,d+=u*Je,u=w[7],le+=u*Me,te+=u*Oe,W+=u*$e,ee+=u*Ue,Y+=u*qe,re+=u*Te,xe+=u*De,ie+=u*Se,be+=u*Ae,he+=u*Be,ve+=u*Pe,H+=u*ke,q+=u*We,$+=u*et,d+=u*tt,C+=u*Je,u=w[8],te+=u*Me,W+=u*Oe,ee+=u*$e,Y+=u*Ue,re+=u*qe,xe+=u*Te,ie+=u*De,be+=u*Se,he+=u*Ae,ve+=u*Be,H+=u*Pe,q+=u*ke,$+=u*We,d+=u*et,C+=u*tt,se+=u*Je,u=w[9],W+=u*Me,ee+=u*Oe,Y+=u*$e,re+=u*Ue,xe+=u*qe,ie+=u*Te,be+=u*De,he+=u*Se,ve+=u*Ae,H+=u*Be,q+=u*Pe,$+=u*ke,d+=u*We,C+=u*et,se+=u*tt,fe+=u*Je,u=w[10],ee+=u*Me,Y+=u*Oe,re+=u*$e,xe+=u*Ue,ie+=u*qe,be+=u*Te,he+=u*De,ve+=u*Se,H+=u*Ae,q+=u*Be,$+=u*Pe,d+=u*ke,C+=u*We,se+=u*et,fe+=u*tt,Ie+=u*Je,u=w[11],Y+=u*Me,re+=u*Oe,xe+=u*$e,ie+=u*Ue,be+=u*qe,he+=u*Te,ve+=u*De,H+=u*Se,q+=u*Ae,$+=u*Be,d+=u*Pe,C+=u*ke,se+=u*We,fe+=u*et,Ie+=u*tt,ze+=u*Je,u=w[12],re+=u*Me,xe+=u*Oe,ie+=u*$e,be+=u*Ue,he+=u*qe,ve+=u*Te,H+=u*De,q+=u*Se,$+=u*Ae,d+=u*Be,C+=u*Pe,se+=u*ke,fe+=u*We,Ie+=u*et,ze+=u*tt,Ve+=u*Je,u=w[13],xe+=u*Me,ie+=u*Oe,be+=u*$e,he+=u*Ue,ve+=u*qe,H+=u*Te,q+=u*De,$+=u*Se,d+=u*Ae,C+=u*Be,se+=u*Pe,fe+=u*ke,Ie+=u*We,ze+=u*et,Ve+=u*tt,Le+=u*Je,u=w[14],ie+=u*Me,be+=u*Oe,he+=u*$e,ve+=u*Ue,H+=u*qe,q+=u*Te,$+=u*De,d+=u*Se,C+=u*Ae,se+=u*Be,fe+=u*Pe,Ie+=u*ke,ze+=u*We,Ve+=u*et,Le+=u*tt,yt+=u*Je,u=w[15],be+=u*Me,he+=u*Oe,ve+=u*$e,H+=u*Ue,q+=u*qe,$+=u*Te,d+=u*De,C+=u*Se,se+=u*Ae,fe+=u*Be,Ie+=u*Pe,ze+=u*ke,Ve+=u*We,Le+=u*et,yt+=u*tt,_t+=u*Je,K+=38*he,k+=38*ve,oe+=38*H,ce+=38*q,ge+=38*$,D+=38*d,B+=38*C,le+=38*se,te+=38*fe,W+=38*Ie,ee+=38*ze,Y+=38*Ve,re+=38*Le,xe+=38*yt,ie+=38*_t,b=1,u=K+b+65535,b=Math.floor(u/65536),K=u-b*65536,u=k+b+65535,b=Math.floor(u/65536),k=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=ce+b+65535,b=Math.floor(u/65536),ce=u-b*65536,u=ge+b+65535,b=Math.floor(u/65536),ge=u-b*65536,u=D+b+65535,b=Math.floor(u/65536),D=u-b*65536,u=B+b+65535,b=Math.floor(u/65536),B=u-b*65536,u=le+b+65535,b=Math.floor(u/65536),le=u-b*65536,u=te+b+65535,b=Math.floor(u/65536),te=u-b*65536,u=W+b+65535,b=Math.floor(u/65536),W=u-b*65536,u=ee+b+65535,b=Math.floor(u/65536),ee=u-b*65536,u=Y+b+65535,b=Math.floor(u/65536),Y=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,u=xe+b+65535,b=Math.floor(u/65536),xe=u-b*65536,u=ie+b+65535,b=Math.floor(u/65536),ie=u-b*65536,u=be+b+65535,b=Math.floor(u/65536),be=u-b*65536,K+=b-1+37*(b-1),b=1,u=K+b+65535,b=Math.floor(u/65536),K=u-b*65536,u=k+b+65535,b=Math.floor(u/65536),k=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=ce+b+65535,b=Math.floor(u/65536),ce=u-b*65536,u=ge+b+65535,b=Math.floor(u/65536),ge=u-b*65536,u=D+b+65535,b=Math.floor(u/65536),D=u-b*65536,u=B+b+65535,b=Math.floor(u/65536),B=u-b*65536,u=le+b+65535,b=Math.floor(u/65536),le=u-b*65536,u=te+b+65535,b=Math.floor(u/65536),te=u-b*65536,u=W+b+65535,b=Math.floor(u/65536),W=u-b*65536,u=ee+b+65535,b=Math.floor(u/65536),ee=u-b*65536,u=Y+b+65535,b=Math.floor(u/65536),Y=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,u=xe+b+65535,b=Math.floor(u/65536),xe=u-b*65536,u=ie+b+65535,b=Math.floor(u/65536),ie=u-b*65536,u=be+b+65535,b=Math.floor(u/65536),be=u-b*65536,K+=b-1+37*(b-1),m[0]=K,m[1]=k,m[2]=oe,m[3]=ce,m[4]=ge,m[5]=D,m[6]=B,m[7]=le,m[8]=te,m[9]=W,m[10]=ee,m[11]=Y,m[12]=re,m[13]=xe,m[14]=ie,m[15]=be}function A(m,w){x(m,w,w)}function U(m,w){const g=s();for(let u=0;u<16;u++)g[u]=w[u];for(let u=253;u>=0;u--)A(g,g),u!==2&&u!==4&&x(g,g,w);for(let u=0;u<16;u++)m[u]=g[u]}function z(m,w){const g=new Uint8Array(32),u=new Float64Array(80),b=s(),K=s(),k=s(),oe=s(),ce=s(),ge=s();for(let te=0;te<31;te++)g[te]=m[te];g[31]=m[31]&127|64,g[0]&=248,p(u,w);for(let te=0;te<16;te++)K[te]=u[te];b[0]=oe[0]=1;for(let te=254;te>=0;--te){const W=g[te>>>3]>>>(te&7)&1;f(b,K,W),f(k,oe,W),S(ce,b,k),T(b,b,k),S(k,K,oe),T(K,K,oe),A(oe,ce),A(ge,b),x(b,k,b),x(k,K,ce),S(ce,b,k),T(b,b,k),A(K,b),T(k,oe,ge),x(b,k,c),S(b,b,oe),x(k,k,b),x(b,oe,ge),x(oe,K,u),A(K,ce),f(b,K,W),f(k,oe,W)}for(let te=0;te<16;te++)u[te+16]=b[te],u[te+32]=k[te],u[te+48]=K[te],u[te+64]=oe[te];const D=u.subarray(32),B=u.subarray(16);U(D,D),x(B,B,D);const le=new Uint8Array(32);return v(le,B),le}n.scalarMult=z;function M(m){return z(m,o)}n.scalarMultBase=M;function ne(m){if(m.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const w=new Uint8Array(m);return{publicKey:M(w),secretKey:w}}n.generateKeyPairFromSeed=ne;function y(m){const w=(0,e.randomBytes)(32,m),g=ne(w);return(0,t.wipe)(w),g}n.generateKeyPair=y;function E(m,w,g=!1){if(m.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(w.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=z(m,w);if(g){let b=0;for(let K=0;K<u.length;K++)b|=u[K];if(b===0)throw new Error("X25519: invalid shared key")}return u}n.sharedKey=E})(Ju);function lS(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function fS(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?lS(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Up(n,e,t,s){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:s}}}const Jf=Up("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Jc=Up("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=fS(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e});({hex:Un.base16,...Un});var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.getLocalStorage=lt.getLocalStorageOrThrow=lt.getCrypto=lt.getCryptoOrThrow=lt.getLocation=lt.getLocationOrThrow=lt.getNavigator=lt.getNavigatorOrThrow=lt.getDocument=lt.getDocumentOrThrow=lt.getFromWindowOrThrow=lt.getFromWindow=void 0;function si(n){let e;return typeof window<"u"&&typeof window[n]<"u"&&(e=window[n]),e}lt.getFromWindow=si;function Li(n){const e=si(n);if(!e)throw new Error(`${n} is not defined in Window`);return e}lt.getFromWindowOrThrow=Li;function dS(){return Li("document")}lt.getDocumentOrThrow=dS;function pS(){return si("document")}lt.getDocument=pS;function gS(){return Li("navigator")}lt.getNavigatorOrThrow=gS;function yS(){return si("navigator")}lt.getNavigator=yS;function _S(){return Li("location")}lt.getLocationOrThrow=_S;function vS(){return si("location")}lt.getLocation=vS;function mS(){return Li("crypto")}lt.getCryptoOrThrow=mS;function bS(){return si("crypto")}lt.getCrypto=bS;function wS(){return Li("localStorage")}lt.getLocalStorageOrThrow=wS;function ES(){return si("localStorage")}lt.getLocalStorage=ES;var Qu={};Object.defineProperty(Qu,"__esModule",{value:!0});Qu.getWindowMetadata=void 0;const Qf=lt;function SS(){let n,e;try{n=Qf.getDocumentOrThrow(),e=Qf.getLocationOrThrow()}catch{return null}function t(){const T=n.getElementsByTagName("link"),x=[];for(let A=0;A<T.length;A++){const U=T[A],z=U.getAttribute("rel");if(z&&z.toLowerCase().indexOf("icon")>-1){const M=U.getAttribute("href");if(M)if(M.toLowerCase().indexOf("https:")===-1&&M.toLowerCase().indexOf("http:")===-1&&M.indexOf("//")!==0){let ne=e.protocol+"//"+e.host;if(M.indexOf("/")===0)ne+=M;else{const y=e.pathname.split("/");y.pop();const E=y.join("/");ne+=E+"/"+M}x.push(ne)}else if(M.indexOf("//")===0){const ne=e.protocol+M;x.push(ne)}else x.push(M)}}return x}function s(...T){const x=n.getElementsByTagName("meta");for(let A=0;A<x.length;A++){const U=x[A],z=["itemprop","property","name"].map(M=>U.getAttribute(M)).filter(M=>M?T.includes(M):!1);if(z.length&&z){const M=U.getAttribute("content");if(M)return M}}return""}function o(){let T=s("name","og:site_name","og:title","twitter:title");return T||(T=n.title),T}function c(){return s("description","og:description","twitter:description","keywords")}const l=o(),f=c(),v=e.origin,p=t();return{description:f,url:v,icons:p,name:l}}Qu.getWindowMetadata=SS;var IS={},Xu=n=>encodeURIComponent(n).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Dp="%[a-f0-9]{2}",Xf=new RegExp("("+Dp+")|([^%]+?)","gi"),Zf=new RegExp("("+Dp+")+","gi");function Pu(n,e){try{return[decodeURIComponent(n.join(""))]}catch{}if(n.length===1)return n;e=e||1;var t=n.slice(0,e),s=n.slice(e);return Array.prototype.concat.call([],Pu(t),Pu(s))}function OS(n){try{return decodeURIComponent(n)}catch{for(var e=n.match(Xf)||[],t=1;t<e.length;t++)n=Pu(e,t).join(""),e=n.match(Xf)||[];return n}}function xS(n){for(var e={"%FE%FF":"","%FF%FE":""},t=Zf.exec(n);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var s=OS(t[0]);s!==t[0]&&(e[t[0]]=s)}t=Zf.exec(n)}e["%C2"]="";for(var o=Object.keys(e),c=0;c<o.length;c++){var l=o[c];n=n.replace(new RegExp(l,"g"),e[l])}return n}var Zu=function(n){if(typeof n!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof n+"`");try{return n=n.replace(/\+/g," "),decodeURIComponent(n)}catch{return xS(n)}},eh=(n,e)=>{if(!(typeof n=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[n];const t=n.indexOf(e);return t===-1?[n]:[n.slice(0,t),n.slice(t+e.length)]},th=function(n,e){for(var t={},s=Object.keys(n),o=Array.isArray(e),c=0;c<s.length;c++){var l=s[c],f=n[l];(o?e.indexOf(l)!==-1:e(l,f,n))&&(t[l]=f)}return t};(function(n){const e=Xu,t=Zu,s=eh,o=th,c=y=>y==null,l=Symbol("encodeFragmentIdentifier");function f(y){switch(y.arrayFormat){case"index":return E=>(m,w)=>{const g=m.length;return w===void 0||y.skipNull&&w===null||y.skipEmptyString&&w===""?m:w===null?[...m,[S(E,y),"[",g,"]"].join("")]:[...m,[S(E,y),"[",S(g,y),"]=",S(w,y)].join("")]};case"bracket":return E=>(m,w)=>w===void 0||y.skipNull&&w===null||y.skipEmptyString&&w===""?m:w===null?[...m,[S(E,y),"[]"].join("")]:[...m,[S(E,y),"[]=",S(w,y)].join("")];case"colon-list-separator":return E=>(m,w)=>w===void 0||y.skipNull&&w===null||y.skipEmptyString&&w===""?m:w===null?[...m,[S(E,y),":list="].join("")]:[...m,[S(E,y),":list=",S(w,y)].join("")];case"comma":case"separator":case"bracket-separator":{const E=y.arrayFormat==="bracket-separator"?"[]=":"=";return m=>(w,g)=>g===void 0||y.skipNull&&g===null||y.skipEmptyString&&g===""?w:(g=g===null?"":g,w.length===0?[[S(m,y),E,S(g,y)].join("")]:[[w,S(g,y)].join(y.arrayFormatSeparator)])}default:return E=>(m,w)=>w===void 0||y.skipNull&&w===null||y.skipEmptyString&&w===""?m:w===null?[...m,S(E,y)]:[...m,[S(E,y),"=",S(w,y)].join("")]}}function v(y){let E;switch(y.arrayFormat){case"index":return(m,w,g)=>{if(E=/\[(\d*)\]$/.exec(m),m=m.replace(/\[\d*\]$/,""),!E){g[m]=w;return}g[m]===void 0&&(g[m]={}),g[m][E[1]]=w};case"bracket":return(m,w,g)=>{if(E=/(\[\])$/.exec(m),m=m.replace(/\[\]$/,""),!E){g[m]=w;return}if(g[m]===void 0){g[m]=[w];return}g[m]=[].concat(g[m],w)};case"colon-list-separator":return(m,w,g)=>{if(E=/(:list)$/.exec(m),m=m.replace(/:list$/,""),!E){g[m]=w;return}if(g[m]===void 0){g[m]=[w];return}g[m]=[].concat(g[m],w)};case"comma":case"separator":return(m,w,g)=>{const u=typeof w=="string"&&w.includes(y.arrayFormatSeparator),b=typeof w=="string"&&!u&&T(w,y).includes(y.arrayFormatSeparator);w=b?T(w,y):w;const K=u||b?w.split(y.arrayFormatSeparator).map(k=>T(k,y)):w===null?w:T(w,y);g[m]=K};case"bracket-separator":return(m,w,g)=>{const u=/(\[\])$/.test(m);if(m=m.replace(/\[\]$/,""),!u){g[m]=w&&T(w,y);return}const b=w===null?[]:w.split(y.arrayFormatSeparator).map(K=>T(K,y));if(g[m]===void 0){g[m]=b;return}g[m]=[].concat(g[m],b)};default:return(m,w,g)=>{if(g[m]===void 0){g[m]=w;return}g[m]=[].concat(g[m],w)}}}function p(y){if(typeof y!="string"||y.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function S(y,E){return E.encode?E.strict?e(y):encodeURIComponent(y):y}function T(y,E){return E.decode?t(y):y}function x(y){return Array.isArray(y)?y.sort():typeof y=="object"?x(Object.keys(y)).sort((E,m)=>Number(E)-Number(m)).map(E=>y[E]):y}function A(y){const E=y.indexOf("#");return E!==-1&&(y=y.slice(0,E)),y}function U(y){let E="";const m=y.indexOf("#");return m!==-1&&(E=y.slice(m)),E}function z(y){y=A(y);const E=y.indexOf("?");return E===-1?"":y.slice(E+1)}function M(y,E){return E.parseNumbers&&!Number.isNaN(Number(y))&&typeof y=="string"&&y.trim()!==""?y=Number(y):E.parseBooleans&&y!==null&&(y.toLowerCase()==="true"||y.toLowerCase()==="false")&&(y=y.toLowerCase()==="true"),y}function ne(y,E){E=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},E),p(E.arrayFormatSeparator);const m=v(E),w=Object.create(null);if(typeof y!="string"||(y=y.trim().replace(/^[?#&]/,""),!y))return w;for(const g of y.split("&")){if(g==="")continue;let[u,b]=s(E.decode?g.replace(/\+/g," "):g,"=");b=b===void 0?null:["comma","separator","bracket-separator"].includes(E.arrayFormat)?b:T(b,E),m(T(u,E),b,w)}for(const g of Object.keys(w)){const u=w[g];if(typeof u=="object"&&u!==null)for(const b of Object.keys(u))u[b]=M(u[b],E);else w[g]=M(u,E)}return E.sort===!1?w:(E.sort===!0?Object.keys(w).sort():Object.keys(w).sort(E.sort)).reduce((g,u)=>{const b=w[u];return b&&typeof b=="object"&&!Array.isArray(b)?g[u]=x(b):g[u]=b,g},Object.create(null))}n.extract=z,n.parse=ne,n.stringify=(y,E)=>{if(!y)return"";E=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},E),p(E.arrayFormatSeparator);const m=b=>E.skipNull&&c(y[b])||E.skipEmptyString&&y[b]==="",w=f(E),g={};for(const b of Object.keys(y))m(b)||(g[b]=y[b]);const u=Object.keys(g);return E.sort!==!1&&u.sort(E.sort),u.map(b=>{const K=y[b];return K===void 0?"":K===null?S(b,E):Array.isArray(K)?K.length===0&&E.arrayFormat==="bracket-separator"?S(b,E)+"[]":K.reduce(w(b),[]).join("&"):S(b,E)+"="+S(K,E)}).filter(b=>b.length>0).join("&")},n.parseUrl=(y,E)=>{E=Object.assign({decode:!0},E);const[m,w]=s(y,"#");return Object.assign({url:m.split("?")[0]||"",query:ne(z(y),E)},E&&E.parseFragmentIdentifier&&w?{fragmentIdentifier:T(w,E)}:{})},n.stringifyUrl=(y,E)=>{E=Object.assign({encode:!0,strict:!0,[l]:!0},E);const m=A(y.url).split("?")[0]||"",w=n.extract(y.url),g=n.parse(w,{sort:!1}),u=Object.assign(g,y.query);let b=n.stringify(u,E);b&&(b=`?${b}`);let K=U(y.url);return y.fragmentIdentifier&&(K=`#${E[l]?S(y.fragmentIdentifier,E):y.fragmentIdentifier}`),`${m}${b}${K}`},n.pick=(y,E,m)=>{m=Object.assign({parseFragmentIdentifier:!0,[l]:!1},m);const{url:w,query:g,fragmentIdentifier:u}=n.parseUrl(y,m);return n.stringifyUrl({url:w,query:o(g,E),fragmentIdentifier:u},m)},n.exclude=(y,E,m)=>{const w=Array.isArray(E)?g=>!E.includes(g):(g,u)=>!E(g,u);return n.pick(y,w,m)}})(IS);const PS={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function TS(n,e=[]){const t=[];return Object.keys(n).forEach(s=>{if(e.length&&!e.includes(s))return;const o=n[s];t.push(...o.accounts)}),t}const AS={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function NS(n,e){const{message:t,code:s}=AS[n];return{message:e?`${t} ${e}`:t,code:s}}function Tu(n,e){return Array.isArray(n)?typeof e<"u"&&n.length?n.every(e):!0:!1}const CS="PARSE_ERROR",RS="INVALID_REQUEST",$S="METHOD_NOT_FOUND",US="INVALID_PARAMS",Fp="INTERNAL_ERROR",rh="SERVER_ERROR",DS=[-32700,-32600,-32601,-32602,-32603],bs={[CS]:{code:-32700,message:"Parse error"},[RS]:{code:-32600,message:"Invalid Request"},[$S]:{code:-32601,message:"Method not found"},[US]:{code:-32602,message:"Invalid params"},[Fp]:{code:-32603,message:"Internal error"},[rh]:{code:-32e3,message:"Server error"}},Lp=rh;function FS(n){return DS.includes(n)}function ed(n){return Object.keys(bs).includes(n)?bs[n]:bs[Lp]}function LS(n){const e=Object.values(bs).find(t=>t.code===n);return e||bs[Lp]}function jp(n,e,t){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):n}var Mp={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Au=function(n,e){return Au=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Au(n,e)};function jS(n,e){Au(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Nu=function(){return Nu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Nu.apply(this,arguments)};function MS(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function qS(n,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,e,t,s);else for(var f=n.length-1;f>=0;f--)(l=n[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function HS(n,e){return function(t,s){e(t,s,n)}}function zS(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function BS(n,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(S){try{p(s.next(S))}catch(T){l(T)}}function v(S){try{p(s.throw(S))}catch(T){l(T)}}function p(S){S.done?c(S.value):o(S.value).then(f,v)}p((s=s.apply(n,e||[])).next())})}function KS(n,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(S){return v([p,S])}}function v(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(S){p=[6,S],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function VS(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function kS(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function Cu(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function qp(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function GS(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(qp(arguments[e]));return n}function WS(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Ps(n){return this instanceof Ps?(this.v=n,this):new Ps(n)}function YS(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(x){s[x]&&(o[x]=function(A){return new Promise(function(U,z){c.push([x,A,U,z])>1||f(x,A)})})}function f(x,A){try{v(s[x](A))}catch(U){T(c[0][3],U)}}function v(x){x.value instanceof Ps?Promise.resolve(x.value.v).then(p,S):T(c[0][2],x)}function p(x){f("next",x)}function S(x){f("throw",x)}function T(x,A){x(A),c.shift(),c.length&&f(c[0][0],c[0][1])}}function JS(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=n[o]?function(l){return(t=!t)?{value:Ps(n[o](l)),done:o==="return"}:c?c(l):l}:c}}function QS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Cu=="function"?Cu(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=n[c]&&function(l){return new Promise(function(f,v){l=n[c](l),o(f,v,l.done,l.value)})}}function o(c,l,f,v){Promise.resolve(v).then(function(p){c({value:p,done:f})},l)}}function XS(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function ZS(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function e6(n){return n&&n.__esModule?n:{default:n}}function t6(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function r6(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}const n6=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Nu},__asyncDelegator:JS,__asyncGenerator:YS,__asyncValues:QS,__await:Ps,__awaiter:BS,__classPrivateFieldGet:t6,__classPrivateFieldSet:r6,__createBinding:VS,__decorate:qS,__exportStar:kS,__extends:jS,__generator:KS,__importDefault:e6,__importStar:ZS,__makeTemplateObject:XS,__metadata:zS,__param:HS,__read:qp,__rest:MS,__spread:GS,__spreadArrays:WS,__values:Cu},Symbol.toStringTag,{value:"Module"})),i6=Ui(n6);var _n={},td;function s6(){if(td)return _n;td=1,Object.defineProperty(_n,"__esModule",{value:!0}),_n.isBrowserCryptoAvailable=_n.getSubtleCrypto=_n.getBrowerCrypto=void 0;function n(){return(Ir===null||Ir===void 0?void 0:Ir.crypto)||(Ir===null||Ir===void 0?void 0:Ir.msCrypto)||{}}_n.getBrowerCrypto=n;function e(){const s=n();return s.subtle||s.webkitSubtle}_n.getSubtleCrypto=e;function t(){return!!n()&&!!e()}return _n.isBrowserCryptoAvailable=t,_n}var vn={},rd;function o6(){if(rd)return vn;rd=1,Object.defineProperty(vn,"__esModule",{value:!0}),vn.isBrowser=vn.isNode=vn.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}vn.isReactNative=n;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}vn.isNode=e;function t(){return!n()&&!e()}return vn.isBrowser=t,vn}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=i6;e.__exportStar(s6(),n),e.__exportStar(o6(),n)})(Mp);function nh(n=3){const e=Date.now()*Math.pow(10,n),t=Math.floor(Math.random()*Math.pow(10,n));return e+t}function Hp(n=6){return BigInt(nh(n))}function Ts(n,e,t){return{id:t||nh(),jsonrpc:"2.0",method:n,params:e}}function ih(n,e){return{id:n,jsonrpc:"2.0",result:e}}function la(n,e,t){return{id:n,jsonrpc:"2.0",error:a6(e,t)}}function a6(n,e){return typeof n>"u"?ed(Fp):(typeof n=="string"&&(n=Object.assign(Object.assign({},ed(rh)),{message:n})),typeof e<"u"&&(n.data=e),FS(n.code)&&(n=LS(n.code)),n)}class c6{}class u6 extends c6{constructor(){super()}}class h6 extends u6{constructor(e){super()}}const l6="^https?:",f6="^wss?:";function d6(n){const e=n.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function zp(n,e){const t=d6(n);return typeof t>"u"?!1:new RegExp(e).test(t)}function nd(n){return zp(n,l6)}function id(n){return zp(n,f6)}function p6(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function Bp(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function sh(n){return Bp(n)&&"method"in n}function fa(n){return Bp(n)&&(wn(n)||kr(n))}function wn(n){return"result"in n}function kr(n){return"error"in n}class Ln extends h6{constructor(e){super(e),this.events=new Mr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Ts(e.method,e.params||[],e.id||Hp().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{kr(c)?o(c.error):s(c.result)});try{await this.connection.send(e,t)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),fa(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const g6=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),y6=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",sd=n=>n.split("?")[0],od=10,_6=g6();class v6{constructor(e){if(this.url=e,this.events=new Mr.EventEmitter,this.registering=!1,!id(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(xs(e))}catch(s){this.onError(e.id,s)}}register(e=this.url){if(!id(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const o=Mp.isReactNative()?void 0:{rejectUnauthorized:!p6(e)},c=new _6(e,[],o);y6()?c.onerror=l=>{const f=l;s(this.emitError(f.error))}:c.on("error",l=>{s(this.emitError(l))}),c.onopen=()=>{this.onOpen(c),t(c)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Bu(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=la(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return jp(e,sd(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>od&&this.events.setMaxListeners(od)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${sd(this.url)}`));return this.events.emit("register_error",t),t}}var Zo={exports:{}};Zo.exports;(function(n,e){var t=200,s="__lodash_hash_undefined__",o=1,c=2,l=9007199254740991,f="[object Arguments]",v="[object Array]",p="[object AsyncFunction]",S="[object Boolean]",T="[object Date]",x="[object Error]",A="[object Function]",U="[object GeneratorFunction]",z="[object Map]",M="[object Number]",ne="[object Null]",y="[object Object]",E="[object Promise]",m="[object Proxy]",w="[object RegExp]",g="[object Set]",u="[object String]",b="[object Symbol]",K="[object Undefined]",k="[object WeakMap]",oe="[object ArrayBuffer]",ce="[object DataView]",ge="[object Float32Array]",D="[object Float64Array]",B="[object Int8Array]",le="[object Int16Array]",te="[object Int32Array]",W="[object Uint8Array]",ee="[object Uint8ClampedArray]",Y="[object Uint16Array]",re="[object Uint32Array]",xe=/[\\^$.*+?()[\]{}|]/g,ie=/^\[object .+?Constructor\]$/,be=/^(?:0|[1-9]\d*)$/,he={};he[ge]=he[D]=he[B]=he[le]=he[te]=he[W]=he[ee]=he[Y]=he[re]=!0,he[f]=he[v]=he[oe]=he[S]=he[ce]=he[T]=he[x]=he[A]=he[z]=he[M]=he[y]=he[w]=he[g]=he[u]=he[k]=!1;var ve=typeof Ir=="object"&&Ir&&Ir.Object===Object&&Ir,H=typeof self=="object"&&self&&self.Object===Object&&self,q=ve||H||Function("return this")(),$=e&&!e.nodeType&&e,d=$&&!0&&n&&!n.nodeType&&n,C=d&&d.exports===$,se=C&&ve.process,fe=function(){try{return se&&se.binding&&se.binding("util")}catch{}}(),Ie=fe&&fe.isTypedArray;function ze(P,F){for(var X=-1,de=P==null?0:P.length,at=0,Ce=[];++X<de;){var pt=P[X];F(pt,X,P)&&(Ce[at++]=pt)}return Ce}function Ve(P,F){for(var X=-1,de=F.length,at=P.length;++X<de;)P[at+X]=F[X];return P}function Le(P,F){for(var X=-1,de=P==null?0:P.length;++X<de;)if(F(P[X],X,P))return!0;return!1}function yt(P,F){for(var X=-1,de=Array(P);++X<P;)de[X]=F(X);return de}function _t(P){return function(F){return P(F)}}function Me(P,F){return P.has(F)}function Oe(P,F){return P==null?void 0:P[F]}function $e(P){var F=-1,X=Array(P.size);return P.forEach(function(de,at){X[++F]=[at,de]}),X}function Ue(P,F){return function(X){return P(F(X))}}function qe(P){var F=-1,X=Array(P.size);return P.forEach(function(de){X[++F]=de}),X}var Te=Array.prototype,De=Function.prototype,Se=Object.prototype,Ae=q["__core-js_shared__"],Be=De.toString,Pe=Se.hasOwnProperty,ke=function(){var P=/[^.]+$/.exec(Ae&&Ae.keys&&Ae.keys.IE_PROTO||"");return P?"Symbol(src)_1."+P:""}(),We=Se.toString,et=RegExp("^"+Be.call(Pe).replace(xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=C?q.Buffer:void 0,Je=q.Symbol,tr=q.Uint8Array,hr=Se.propertyIsEnumerable,Yr=Te.splice,rr=Je?Je.toStringTag:void 0,sn=Object.getOwnPropertySymbols,En=tt?tt.isBuffer:void 0,Mn=Ue(Object.keys,Object),St=vr(q,"DataView"),vt=vr(q,"Map"),It=vr(q,"Promise"),Ot=vr(q,"Set"),wt=vr(q,"WeakMap"),mt=vr(Object,"create"),Dt=an(St),Ft=an(vt),xt=an(It),Lt=an(Ot),Pt=an(wt),Nt=Je?Je.prototype:void 0,Tt=Nt?Nt.valueOf:void 0;function ht(P){var F=-1,X=P==null?0:P.length;for(this.clear();++F<X;){var de=P[F];this.set(de[0],de[1])}}function jt(){this.__data__=mt?mt(null):{},this.size=0}function Mt(P){var F=this.has(P)&&delete this.__data__[P];return this.size-=F?1:0,F}function ya(P){var F=this.__data__;if(mt){var X=F[P];return X===s?void 0:X}return Pe.call(F,P)?F[P]:void 0}function _a(P){var F=this.__data__;return mt?F[P]!==void 0:Pe.call(F,P)}function va(P,F){var X=this.__data__;return this.size+=this.has(P)?0:1,X[P]=mt&&F===void 0?s:F,this}ht.prototype.clear=jt,ht.prototype.delete=Mt,ht.prototype.get=ya,ht.prototype.has=_a,ht.prototype.set=va;function Pr(P){var F=-1,X=P==null?0:P.length;for(this.clear();++F<X;){var de=P[F];this.set(de[0],de[1])}}function ma(){this.__data__=[],this.size=0}function ba(P){var F=this.__data__,X=qn(F,P);if(X<0)return!1;var de=F.length-1;return X==de?F.pop():Yr.call(F,X,1),--this.size,!0}function wa(P){var F=this.__data__,X=qn(F,P);return X<0?void 0:F[X][1]}function Ea(P){return qn(this.__data__,P)>-1}function Sa(P,F){var X=this.__data__,de=qn(X,P);return de<0?(++this.size,X.push([P,F])):X[de][1]=F,this}Pr.prototype.clear=ma,Pr.prototype.delete=ba,Pr.prototype.get=wa,Pr.prototype.has=Ea,Pr.prototype.set=Sa;function on(P){var F=-1,X=P==null?0:P.length;for(this.clear();++F<X;){var de=P[F];this.set(de[0],de[1])}}function hi(){this.size=0,this.__data__={hash:new ht,map:new(vt||Pr),string:new ht}}function Ia(P){var F=Sn(this,P).delete(P);return this.size-=F?1:0,F}function li(P){return Sn(this,P).get(P)}function Oa(P){return Sn(this,P).has(P)}function xa(P,F){var X=Sn(this,P),de=X.size;return X.set(P,F),this.size+=X.size==de?0:1,this}on.prototype.clear=hi,on.prototype.delete=Ia,on.prototype.get=li,on.prototype.has=Oa,on.prototype.set=xa;function fi(P){var F=-1,X=P==null?0:P.length;for(this.__data__=new on;++F<X;)this.add(P[F])}function js(P){return this.__data__.set(P,s),this}function Ms(P){return this.__data__.has(P)}fi.prototype.add=fi.prototype.push=js,fi.prototype.has=Ms;function qr(P){var F=this.__data__=new Pr(P);this.size=F.size}function Pa(){this.__data__=new Pr,this.size=0}function Ta(P){var F=this.__data__,X=F.delete(P);return this.size=F.size,X}function Aa(P){return this.__data__.get(P)}function Na(P){return this.__data__.has(P)}function qs(P,F){var X=this.__data__;if(X instanceof Pr){var de=X.__data__;if(!vt||de.length<t-1)return de.push([P,F]),this.size=++X.size,this;X=this.__data__=new on(de)}return X.set(P,F),this.size=X.size,this}qr.prototype.clear=Pa,qr.prototype.delete=Ta,qr.prototype.get=Aa,qr.prototype.has=Na,qr.prototype.set=qs;function Hs(P,F){var X=gi(P),de=!X&&Zs(P),at=!X&&!de&&Bi(P),Ce=!X&&!de&&!at&&ro(P),pt=X||de||at||Ce,qt=pt?yt(P.length,String):[],Qe=qt.length;for(var ct in P)(F||Pe.call(P,ct))&&!(pt&&(ct=="length"||at&&(ct=="offset"||ct=="parent")||Ce&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Ws(ct,Qe)))&&qt.push(ct);return qt}function qn(P,F){for(var X=P.length;X--;)if(Xs(P[X][0],F))return X;return-1}function Hi(P,F,X){var de=F(P);return gi(P)?de:Ve(de,X(P))}function Hn(P){return P==null?P===void 0?K:ne:rr&&rr in Object(P)?ks(P):$a(P)}function zi(P){return Bn(P)&&Hn(P)==f}function zn(P,F,X,de,at){return P===F?!0:P==null||F==null||!Bn(P)&&!Bn(F)?P!==P&&F!==F:zs(P,F,X,de,zn,at)}function zs(P,F,X,de,at,Ce){var pt=gi(P),qt=gi(F),Qe=pt?v:Jr(P),ct=qt?v:Jr(F);Qe=Qe==f?y:Qe,ct=ct==f?y:ct;var Ct=Qe==y,lr=ct==y,Ht=Qe==ct;if(Ht&&Bi(P)){if(!Bi(F))return!1;pt=!0,Ct=!1}if(Ht&&!Ct)return Ce||(Ce=new qr),pt||ro(P)?di(P,F,X,de,at,Ce):Ra(P,F,Qe,X,de,at,Ce);if(!(X&o)){var gt=Ct&&Pe.call(P,"__wrapped__"),nr=lr&&Pe.call(F,"__wrapped__");if(gt||nr){var Hr=gt?P.value():P,Tr=nr?F.value():F;return Ce||(Ce=new qr),at(Hr,Tr,X,de,Ce)}}return Ht?(Ce||(Ce=new qr),Vs(P,F,X,de,at,Ce)):!1}function Ca(P){if(!to(P)||Js(P))return!1;var F=yi(P)?et:ie;return F.test(an(P))}function Bs(P){return Bn(P)&&eo(P.length)&&!!he[Hn(P)]}function Ks(P){if(!Qs(P))return Mn(P);var F=[];for(var X in Object(P))Pe.call(P,X)&&X!="constructor"&&F.push(X);return F}function di(P,F,X,de,at,Ce){var pt=X&o,qt=P.length,Qe=F.length;if(qt!=Qe&&!(pt&&Qe>qt))return!1;var ct=Ce.get(P);if(ct&&Ce.get(F))return ct==F;var Ct=-1,lr=!0,Ht=X&c?new fi:void 0;for(Ce.set(P,F),Ce.set(F,P);++Ct<qt;){var gt=P[Ct],nr=F[Ct];if(de)var Hr=pt?de(nr,gt,Ct,F,P,Ce):de(gt,nr,Ct,P,F,Ce);if(Hr!==void 0){if(Hr)continue;lr=!1;break}if(Ht){if(!Le(F,function(Tr,Qr){if(!Me(Ht,Qr)&&(gt===Tr||at(gt,Tr,X,de,Ce)))return Ht.push(Qr)})){lr=!1;break}}else if(!(gt===nr||at(gt,nr,X,de,Ce))){lr=!1;break}}return Ce.delete(P),Ce.delete(F),lr}function Ra(P,F,X,de,at,Ce,pt){switch(X){case ce:if(P.byteLength!=F.byteLength||P.byteOffset!=F.byteOffset)return!1;P=P.buffer,F=F.buffer;case oe:return!(P.byteLength!=F.byteLength||!Ce(new tr(P),new tr(F)));case S:case T:case M:return Xs(+P,+F);case x:return P.name==F.name&&P.message==F.message;case w:case u:return P==F+"";case z:var qt=$e;case g:var Qe=de&o;if(qt||(qt=qe),P.size!=F.size&&!Qe)return!1;var ct=pt.get(P);if(ct)return ct==F;de|=c,pt.set(P,F);var Ct=di(qt(P),qt(F),de,at,Ce,pt);return pt.delete(P),Ct;case b:if(Tt)return Tt.call(P)==Tt.call(F)}return!1}function Vs(P,F,X,de,at,Ce){var pt=X&o,qt=pi(P),Qe=qt.length,ct=pi(F),Ct=ct.length;if(Qe!=Ct&&!pt)return!1;for(var lr=Qe;lr--;){var Ht=qt[lr];if(!(pt?Ht in F:Pe.call(F,Ht)))return!1}var gt=Ce.get(P);if(gt&&Ce.get(F))return gt==F;var nr=!0;Ce.set(P,F),Ce.set(F,P);for(var Hr=pt;++lr<Qe;){Ht=qt[lr];var Tr=P[Ht],Qr=F[Ht];if(de)var Ki=pt?de(Qr,Tr,Ht,F,P,Ce):de(Tr,Qr,Ht,P,F,Ce);if(!(Ki===void 0?Tr===Qr||at(Tr,Qr,X,de,Ce):Ki)){nr=!1;break}Hr||(Hr=Ht=="constructor")}if(nr&&!Hr){var Kn=P.constructor,Vt=F.constructor;Kn!=Vt&&"constructor"in P&&"constructor"in F&&!(typeof Kn=="function"&&Kn instanceof Kn&&typeof Vt=="function"&&Vt instanceof Vt)&&(nr=!1)}return Ce.delete(P),Ce.delete(F),nr}function pi(P){return Hi(P,Fa,Gs)}function Sn(P,F){var X=P.__data__;return Ys(F)?X[typeof F=="string"?"string":"hash"]:X.map}function vr(P,F){var X=Oe(P,F);return Ca(X)?X:void 0}function ks(P){var F=Pe.call(P,rr),X=P[rr];try{P[rr]=void 0;var de=!0}catch{}var at=We.call(P);return de&&(F?P[rr]=X:delete P[rr]),at}var Gs=sn?function(P){return P==null?[]:(P=Object(P),ze(sn(P),function(F){return hr.call(P,F)}))}:ot,Jr=Hn;(St&&Jr(new St(new ArrayBuffer(1)))!=ce||vt&&Jr(new vt)!=z||It&&Jr(It.resolve())!=E||Ot&&Jr(new Ot)!=g||wt&&Jr(new wt)!=k)&&(Jr=function(P){var F=Hn(P),X=F==y?P.constructor:void 0,de=X?an(X):"";if(de)switch(de){case Dt:return ce;case Ft:return z;case xt:return E;case Lt:return g;case Pt:return k}return F});function Ws(P,F){return F=F??l,!!F&&(typeof P=="number"||be.test(P))&&P>-1&&P%1==0&&P<F}function Ys(P){var F=typeof P;return F=="string"||F=="number"||F=="symbol"||F=="boolean"?P!=="__proto__":P===null}function Js(P){return!!ke&&ke in P}function Qs(P){var F=P&&P.constructor,X=typeof F=="function"&&F.prototype||Se;return P===X}function $a(P){return We.call(P)}function an(P){if(P!=null){try{return Be.call(P)}catch{}try{return P+""}catch{}}return""}function Xs(P,F){return P===F||P!==P&&F!==F}var Zs=zi(function(){return arguments}())?zi:function(P){return Bn(P)&&Pe.call(P,"callee")&&!hr.call(P,"callee")},gi=Array.isArray;function Ua(P){return P!=null&&eo(P.length)&&!yi(P)}var Bi=En||st;function Da(P,F){return zn(P,F)}function yi(P){if(!to(P))return!1;var F=Hn(P);return F==A||F==U||F==p||F==m}function eo(P){return typeof P=="number"&&P>-1&&P%1==0&&P<=l}function to(P){var F=typeof P;return P!=null&&(F=="object"||F=="function")}function Bn(P){return P!=null&&typeof P=="object"}var ro=Ie?_t(Ie):Bs;function Fa(P){return Ua(P)?Hs(P):Ks(P)}function ot(){return[]}function st(){return!1}n.exports=Da})(Zo,Zo.exports);var m6=Zo.exports;const b6=ob(m6);class w6 extends ii{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}let E6=class extends ii{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}};class S6{constructor(e,t){this.logger=e,this.core=t}}let I6=class extends ii{constructor(e,t){super(),this.relayer=e,this.logger=t}},O6=class extends ii{constructor(e){super()}},x6=class{constructor(e,t,s,o){this.core=e,this.logger=t,this.name=s}};class P6 extends ii{constructor(e,t){super(),this.relayer=e,this.logger=t}}let T6=class extends ii{constructor(e,t){super(),this.core=e,this.logger=t}},A6=class{constructor(e,t){this.projectId=e,this.logger=t}},N6=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},C6=class{constructor(e){this.client=e}};function oh(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function Kp(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?oh(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function ad(n,e){e||(e=n.reduce((o,c)=>o+c.length,0));const t=Kp(e);let s=0;for(const o of n)t.set(o,s),s+=o.length;return oh(t)}function Vp(n,e,t,s){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:s}}}const cd=Vp("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Qc=Vp("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=Kp(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),kp={utf8:cd,"utf-8":cd,hex:Un.base16,latin1:Qc,ascii:Qc,binary:Qc,...Un};function Wr(n,e="utf8"){const t=kp[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?oh(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}function Lr(n,e="utf8"){const t=kp[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):t.encoder.encode(n).substring(1)}var ft={};Object.defineProperty(ft,"__esModule",{value:!0});ft.getLocalStorage=ft.getLocalStorageOrThrow=ft.getCrypto=ft.getCryptoOrThrow=Wp=ft.getLocation=ft.getLocationOrThrow=ah=ft.getNavigator=ft.getNavigatorOrThrow=Gp=ft.getDocument=ft.getDocumentOrThrow=ft.getFromWindowOrThrow=ft.getFromWindow=void 0;function oi(n){let e;return typeof window<"u"&&typeof window[n]<"u"&&(e=window[n]),e}ft.getFromWindow=oi;function ji(n){const e=oi(n);if(!e)throw new Error(`${n} is not defined in Window`);return e}ft.getFromWindowOrThrow=ji;function R6(){return ji("document")}ft.getDocumentOrThrow=R6;function $6(){return oi("document")}var Gp=ft.getDocument=$6;function U6(){return ji("navigator")}ft.getNavigatorOrThrow=U6;function D6(){return oi("navigator")}var ah=ft.getNavigator=D6;function F6(){return ji("location")}ft.getLocationOrThrow=F6;function L6(){return oi("location")}var Wp=ft.getLocation=L6;function j6(){return ji("crypto")}ft.getCryptoOrThrow=j6;function M6(){return oi("crypto")}ft.getCrypto=M6;function q6(){return ji("localStorage")}ft.getLocalStorageOrThrow=q6;function H6(){return oi("localStorage")}ft.getLocalStorage=H6;var ch={};Object.defineProperty(ch,"__esModule",{value:!0});var Yp=ch.getWindowMetadata=void 0;const ud=ft;function z6(){let n,e;try{n=ud.getDocumentOrThrow(),e=ud.getLocationOrThrow()}catch{return null}function t(){const T=n.getElementsByTagName("link"),x=[];for(let A=0;A<T.length;A++){const U=T[A],z=U.getAttribute("rel");if(z&&z.toLowerCase().indexOf("icon")>-1){const M=U.getAttribute("href");if(M)if(M.toLowerCase().indexOf("https:")===-1&&M.toLowerCase().indexOf("http:")===-1&&M.indexOf("//")!==0){let ne=e.protocol+"//"+e.host;if(M.indexOf("/")===0)ne+=M;else{const y=e.pathname.split("/");y.pop();const E=y.join("/");ne+=E+"/"+M}x.push(ne)}else if(M.indexOf("//")===0){const ne=e.protocol+M;x.push(ne)}else x.push(M)}}return x}function s(...T){const x=n.getElementsByTagName("meta");for(let A=0;A<x.length;A++){const U=x[A],z=["itemprop","property","name"].map(M=>U.getAttribute(M)).filter(M=>M?T.includes(M):!1);if(z.length&&z){const M=U.getAttribute("content");if(M)return M}}return""}function o(){let T=s("name","og:site_name","og:title","twitter:title");return T||(T=n.title),T}function c(){return s("description","og:description","twitter:description","keywords")}const l=o(),f=c(),v=e.origin,p=t();return{description:f,url:v,icons:p,name:l}}Yp=ch.getWindowMetadata=z6;var As={};(function(n){const e=Xu,t=Zu,s=eh,o=th,c=y=>y==null,l=Symbol("encodeFragmentIdentifier");function f(y){switch(y.arrayFormat){case"index":return E=>(m,w)=>{const g=m.length;return w===void 0||y.skipNull&&w===null||y.skipEmptyString&&w===""?m:w===null?[...m,[S(E,y),"[",g,"]"].join("")]:[...m,[S(E,y),"[",S(g,y),"]=",S(w,y)].join("")]};case"bracket":return E=>(m,w)=>w===void 0||y.skipNull&&w===null||y.skipEmptyString&&w===""?m:w===null?[...m,[S(E,y),"[]"].join("")]:[...m,[S(E,y),"[]=",S(w,y)].join("")];case"colon-list-separator":return E=>(m,w)=>w===void 0||y.skipNull&&w===null||y.skipEmptyString&&w===""?m:w===null?[...m,[S(E,y),":list="].join("")]:[...m,[S(E,y),":list=",S(w,y)].join("")];case"comma":case"separator":case"bracket-separator":{const E=y.arrayFormat==="bracket-separator"?"[]=":"=";return m=>(w,g)=>g===void 0||y.skipNull&&g===null||y.skipEmptyString&&g===""?w:(g=g===null?"":g,w.length===0?[[S(m,y),E,S(g,y)].join("")]:[[w,S(g,y)].join(y.arrayFormatSeparator)])}default:return E=>(m,w)=>w===void 0||y.skipNull&&w===null||y.skipEmptyString&&w===""?m:w===null?[...m,S(E,y)]:[...m,[S(E,y),"=",S(w,y)].join("")]}}function v(y){let E;switch(y.arrayFormat){case"index":return(m,w,g)=>{if(E=/\[(\d*)\]$/.exec(m),m=m.replace(/\[\d*\]$/,""),!E){g[m]=w;return}g[m]===void 0&&(g[m]={}),g[m][E[1]]=w};case"bracket":return(m,w,g)=>{if(E=/(\[\])$/.exec(m),m=m.replace(/\[\]$/,""),!E){g[m]=w;return}if(g[m]===void 0){g[m]=[w];return}g[m]=[].concat(g[m],w)};case"colon-list-separator":return(m,w,g)=>{if(E=/(:list)$/.exec(m),m=m.replace(/:list$/,""),!E){g[m]=w;return}if(g[m]===void 0){g[m]=[w];return}g[m]=[].concat(g[m],w)};case"comma":case"separator":return(m,w,g)=>{const u=typeof w=="string"&&w.includes(y.arrayFormatSeparator),b=typeof w=="string"&&!u&&T(w,y).includes(y.arrayFormatSeparator);w=b?T(w,y):w;const K=u||b?w.split(y.arrayFormatSeparator).map(k=>T(k,y)):w===null?w:T(w,y);g[m]=K};case"bracket-separator":return(m,w,g)=>{const u=/(\[\])$/.test(m);if(m=m.replace(/\[\]$/,""),!u){g[m]=w&&T(w,y);return}const b=w===null?[]:w.split(y.arrayFormatSeparator).map(K=>T(K,y));if(g[m]===void 0){g[m]=b;return}g[m]=[].concat(g[m],b)};default:return(m,w,g)=>{if(g[m]===void 0){g[m]=w;return}g[m]=[].concat(g[m],w)}}}function p(y){if(typeof y!="string"||y.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function S(y,E){return E.encode?E.strict?e(y):encodeURIComponent(y):y}function T(y,E){return E.decode?t(y):y}function x(y){return Array.isArray(y)?y.sort():typeof y=="object"?x(Object.keys(y)).sort((E,m)=>Number(E)-Number(m)).map(E=>y[E]):y}function A(y){const E=y.indexOf("#");return E!==-1&&(y=y.slice(0,E)),y}function U(y){let E="";const m=y.indexOf("#");return m!==-1&&(E=y.slice(m)),E}function z(y){y=A(y);const E=y.indexOf("?");return E===-1?"":y.slice(E+1)}function M(y,E){return E.parseNumbers&&!Number.isNaN(Number(y))&&typeof y=="string"&&y.trim()!==""?y=Number(y):E.parseBooleans&&y!==null&&(y.toLowerCase()==="true"||y.toLowerCase()==="false")&&(y=y.toLowerCase()==="true"),y}function ne(y,E){E=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},E),p(E.arrayFormatSeparator);const m=v(E),w=Object.create(null);if(typeof y!="string"||(y=y.trim().replace(/^[?#&]/,""),!y))return w;for(const g of y.split("&")){if(g==="")continue;let[u,b]=s(E.decode?g.replace(/\+/g," "):g,"=");b=b===void 0?null:["comma","separator","bracket-separator"].includes(E.arrayFormat)?b:T(b,E),m(T(u,E),b,w)}for(const g of Object.keys(w)){const u=w[g];if(typeof u=="object"&&u!==null)for(const b of Object.keys(u))u[b]=M(u[b],E);else w[g]=M(u,E)}return E.sort===!1?w:(E.sort===!0?Object.keys(w).sort():Object.keys(w).sort(E.sort)).reduce((g,u)=>{const b=w[u];return b&&typeof b=="object"&&!Array.isArray(b)?g[u]=x(b):g[u]=b,g},Object.create(null))}n.extract=z,n.parse=ne,n.stringify=(y,E)=>{if(!y)return"";E=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},E),p(E.arrayFormatSeparator);const m=b=>E.skipNull&&c(y[b])||E.skipEmptyString&&y[b]==="",w=f(E),g={};for(const b of Object.keys(y))m(b)||(g[b]=y[b]);const u=Object.keys(g);return E.sort!==!1&&u.sort(E.sort),u.map(b=>{const K=y[b];return K===void 0?"":K===null?S(b,E):Array.isArray(K)?K.length===0&&E.arrayFormat==="bracket-separator"?S(b,E)+"[]":K.reduce(w(b),[]).join("&"):S(b,E)+"="+S(K,E)}).filter(b=>b.length>0).join("&")},n.parseUrl=(y,E)=>{E=Object.assign({decode:!0},E);const[m,w]=s(y,"#");return Object.assign({url:m.split("?")[0]||"",query:ne(z(y),E)},E&&E.parseFragmentIdentifier&&w?{fragmentIdentifier:T(w,E)}:{})},n.stringifyUrl=(y,E)=>{E=Object.assign({encode:!0,strict:!0,[l]:!0},E);const m=A(y.url).split("?")[0]||"",w=n.extract(y.url),g=n.parse(w,{sort:!1}),u=Object.assign(g,y.query);let b=n.stringify(u,E);b&&(b=`?${b}`);let K=U(y.url);return y.fragmentIdentifier&&(K=`#${E[l]?S(y.fragmentIdentifier,E):y.fragmentIdentifier}`),`${m}${b}${K}`},n.pick=(y,E,m)=>{m=Object.assign({parseFragmentIdentifier:!0,[l]:!1},m);const{url:w,query:g,fragmentIdentifier:u}=n.parseUrl(y,m);return n.stringifyUrl({url:w,query:o(g,E),fragmentIdentifier:u},m)},n.exclude=(y,E,m)=>{const w=Array.isArray(E)?g=>!E.includes(g):(g,u)=>!E(g,u);return n.pick(y,w,m)}})(As);function Jp(n,e){return n.includes(":")?[n]:e.chains||[]}const Qp="base10",ur="base16",Ru="base64pad",uh="utf8",Xp=0,ai=1,B6=0,hd=1,$u=12,hh=32;function K6(){const n=Ju.generateKeyPair();return{privateKey:Lr(n.secretKey,ur),publicKey:Lr(n.publicKey,ur)}}function Uu(){const n=Fi.randomBytes(hh);return Lr(n,ur)}function V6(n,e){const t=Ju.sharedKey(Wr(n,ur),Wr(e,ur)),s=new hS(ha.SHA256,t).expand(hh);return Lr(s,ur)}function k6(n){const e=ha.hash(Wr(n,ur));return Lr(e,ur)}function $i(n){const e=ha.hash(Wr(n,uh));return Lr(e,ur)}function G6(n){return Wr(`${n}`,Qp)}function $s(n){return Number(Lr(n,Qp))}function W6(n){const e=G6(typeof n.type<"u"?n.type:Xp);if($s(e)===ai&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof n.senderPublicKey<"u"?Wr(n.senderPublicKey,ur):void 0,s=typeof n.iv<"u"?Wr(n.iv,ur):Fi.randomBytes($u),o=new Wu.ChaCha20Poly1305(Wr(n.symKey,ur)).seal(s,Wr(n.message,uh));return J6({type:e,sealed:o,iv:s,senderPublicKey:t})}function Y6(n){const e=new Wu.ChaCha20Poly1305(Wr(n.symKey,ur)),{sealed:t,iv:s}=ea(n.encoded),o=e.open(s,t);if(o===null)throw new Error("Failed to decrypt");return Lr(o,uh)}function J6(n){if($s(n.type)===ai){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Lr(ad([n.type,n.senderPublicKey,n.iv,n.sealed]),Ru)}return Lr(ad([n.type,n.iv,n.sealed]),Ru)}function ea(n){const e=Wr(n,Ru),t=e.slice(B6,hd),s=hd;if($s(t)===ai){const f=s+hh,v=f+$u,p=e.slice(s,f),S=e.slice(f,v),T=e.slice(v);return{type:t,sealed:T,iv:S,senderPublicKey:p}}const o=s+$u,c=e.slice(s,o),l=e.slice(o);return{type:t,sealed:l,iv:c}}function Q6(n,e){const t=ea(n);return Zp({type:$s(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?Lr(t.senderPublicKey,ur):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function Zp(n){const e=(n==null?void 0:n.type)||Xp;if(e===ai){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function ld(n){return n.type===ai&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var X6=Object.defineProperty,fd=Object.getOwnPropertySymbols,Z6=Object.prototype.hasOwnProperty,e2=Object.prototype.propertyIsEnumerable,dd=(n,e,t)=>e in n?X6(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,pd=(n,e)=>{for(var t in e||(e={}))Z6.call(e,t)&&dd(n,t,e[t]);if(fd)for(var t of fd(e))e2.call(e,t)&&dd(n,t,e[t]);return n};const t2="ReactNative",Or={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},r2="js";function lh(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function da(){return!Gp()&&!!ah()&&navigator.product===t2}function Us(){return!lh()&&!!ah()}function Ds(){return da()?Or.reactNative:lh()?Or.node:Us()?Or.browser:Or.unknown}function n2(n,e){let t=As.parse(n);return t=pd(pd({},t),e),n=As.stringify(t),n}function i2(){return Yp()||{name:"",description:"",url:"",icons:[""]}}function s2(){if(Ds()===Or.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:s}=global.Platform;return[t,s].join("-")}const n=ab();if(n===null)return"unknown";const e=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[e,n.name,n.version].join("-"):[e,n.version].join("-")}function o2(){var n;const e=Ds();return e===Or.browser?[e,((n=Wp())==null?void 0:n.host)||"unknown"].join(":"):e}function a2(n,e,t){const s=s2(),o=o2();return[[n,e].join("-"),[r2,t].join("-"),s,o].join("/")}function c2({protocol:n,version:e,relayUrl:t,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:l}){const f=t.split("?"),v=a2(n,e,s),p={auth:o,ua:v,projectId:c,useOnCloseEvent:l||void 0},S=n2(f[1]||"",p);return f[0]+"?"+S}function ni(n,e){return n.filter(t=>e.includes(t)).length===n.length}function eg(n){return Object.fromEntries(n.entries())}function tg(n){return new Map(Object.entries(n))}function Ri(n=_e.FIVE_MINUTES,e){const t=_e.toMiliseconds(n||_e.FIVE_MINUTES);let s,o,c;return{resolve:l=>{c&&s&&(clearTimeout(c),s(l))},reject:l=>{c&&o&&(clearTimeout(c),o(l))},done:()=>new Promise((l,f)=>{c=setTimeout(()=>{f(new Error(e))},t),s=l,o=f})}}function Ns(n,e,t){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(t)),e);try{const l=await n;s(l)}catch(l){o(l)}clearTimeout(c)})}function rg(n,e){if(typeof e=="string"&&e.startsWith(`${n}:`))return e;if(n.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(n.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${n}`)}function u2(n){return rg("topic",n)}function h2(n){return rg("id",n)}function ng(n){const[e,t]=n.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function Gr(n,e){return _e.fromMiliseconds((e||Date.now())+_e.toMiliseconds(n))}function $n(n){return Date.now()>=_e.toMiliseconds(n)}function zt(n,e){return`${n}${e?`:${e}`:""}`}async function l2({id:n,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${n}&sessionTopic=${e}`,l=Ds();l===Or.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):l===Or.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(c)}catch(s){console.error(s)}}const f2="irn";function Du(n){return(n==null?void 0:n.relay)||{protocol:f2}}function Go(n){const e=PS[n];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${n}`);return e}var d2=Object.defineProperty,gd=Object.getOwnPropertySymbols,p2=Object.prototype.hasOwnProperty,g2=Object.prototype.propertyIsEnumerable,yd=(n,e,t)=>e in n?d2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,y2=(n,e)=>{for(var t in e||(e={}))p2.call(e,t)&&yd(n,t,e[t]);if(gd)for(var t of gd(e))g2.call(e,t)&&yd(n,t,e[t]);return n};function _2(n,e="-"){const t={},s="relay"+e;return Object.keys(n).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),l=n[o];t[c]=l}}),t}function v2(n){const e=n.indexOf(":"),t=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,e),o=n.substring(e+1,t).split("@"),c=typeof t<"u"?n.substring(t):"",l=As.parse(c);return{protocol:s,topic:m2(o[0]),version:parseInt(o[1],10),symKey:l.symKey,relay:_2(l)}}function m2(n){return n.startsWith("//")?n.substring(2):n}function b2(n,e="-"){const t="relay",s={};return Object.keys(n).forEach(o=>{const c=t+e+o;n[o]&&(s[c]=n[o])}),s}function w2(n){return`${n.protocol}:${n.topic}@${n.version}?`+As.stringify(y2({symKey:n.symKey},b2(n.relay)))}function Mi(n){const e=[];return n.forEach(t=>{const[s,o]=t.split(":");e.push(`${s}:${o}`)}),e}function E2(n){const e=[];return Object.values(n).forEach(t=>{e.push(...Mi(t.accounts))}),e}function S2(n,e){const t=[];return Object.values(n).forEach(s=>{Mi(s.accounts).includes(e)&&t.push(...s.methods)}),t}function I2(n,e){const t=[];return Object.values(n).forEach(s=>{Mi(s.accounts).includes(e)&&t.push(...s.events)}),t}function O2(n,e){const t=Wo(n,e);if(t)throw new Error(t.message);const s={};for(const[o,c]of Object.entries(n))s[o]={methods:c.methods,events:c.events,chains:c.accounts.map(l=>`${l.split(":")[0]}:${l.split(":")[1]}`)};return s}const x2={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},P2={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ue(n,e){const{message:t,code:s}=P2[n];return{message:e?`${t} ${e}`:t,code:s}}function Gt(n,e){const{message:t,code:s}=x2[n];return{message:e?`${t} ${e}`:t,code:s}}function Fs(n,e){return Array.isArray(n)?typeof e<"u"&&n.length?n.every(e):!0:!1}function ws(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function cr(n){return typeof n>"u"}function Wt(n,e){return e&&cr(n)?!0:typeof n=="string"&&!!n.trim().length}function fh(n,e){return e&&cr(n)?!0:typeof n=="number"&&!isNaN(n)}function T2(n,e){const{requiredNamespaces:t}=e,s=Object.keys(n.namespaces),o=Object.keys(t);let c=!0;return ni(o,s)?(s.forEach(l=>{const{accounts:f,methods:v,events:p}=n.namespaces[l],S=Mi(f),T=t[l];(!ni(Jp(l,T),S)||!ni(T.methods,v)||!ni(T.events,p))&&(c=!1)}),c):!1}function ta(n){return Wt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function A2(n){if(Wt(n,!1)&&n.includes(":")){const e=n.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&ta(t)}}return!1}function N2(n){if(Wt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function C2(n){var e;return(e=n==null?void 0:n.proposer)==null?void 0:e.publicKey}function R2(n){return n==null?void 0:n.topic}function $2(n,e){let t=null;return Wt(n==null?void 0:n.publicKey,!1)||(t=ue("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function _d(n){let e=!0;return Fs(n)?n.length&&(e=n.every(t=>Wt(t,!1))):e=!1,e}function U2(n,e,t){let s=null;return Fs(e)&&e.length?e.forEach(o=>{s||ta(o)||(s=Gt("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):ta(n)||(s=Gt("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function D2(n,e,t){let s=null;return Object.entries(n).forEach(([o,c])=>{if(s)return;const l=U2(o,Jp(o,c),`${e} ${t}`);l&&(s=l)}),s}function F2(n,e){let t=null;return Fs(n)?n.forEach(s=>{t||A2(s)||(t=Gt("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=Gt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function L2(n,e){let t=null;return Object.values(n).forEach(s=>{if(t)return;const o=F2(s==null?void 0:s.accounts,`${e} namespace`);o&&(t=o)}),t}function j2(n,e){let t=null;return _d(n==null?void 0:n.methods)?_d(n==null?void 0:n.events)||(t=Gt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Gt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function ig(n,e){let t=null;return Object.values(n).forEach(s=>{if(t)return;const o=j2(s,`${e}, namespace`);o&&(t=o)}),t}function M2(n,e,t){let s=null;if(n&&ws(n)){const o=ig(n,e);o&&(s=o);const c=D2(n,e,t);c&&(s=c)}else s=ue("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function Wo(n,e){let t=null;if(n&&ws(n)){const s=ig(n,e);s&&(t=s);const o=L2(n,e);o&&(t=o)}else t=ue("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function sg(n){return Wt(n.protocol,!0)}function q2(n,e){let t=!1;return e&&!n?t=!0:n&&Fs(n)&&n.length&&n.forEach(s=>{t=sg(s)}),t}function H2(n){return typeof n=="number"}function _r(n){return typeof n<"u"&&typeof n!==null}function z2(n){return!(!n||typeof n!="object"||!n.code||!fh(n.code,!1)||!n.message||!Wt(n.message,!1))}function B2(n){return!(cr(n)||!Wt(n.method,!1))}function K2(n){return!(cr(n)||cr(n.result)&&cr(n.error)||!fh(n.id,!1)||!Wt(n.jsonrpc,!1))}function V2(n){return!(cr(n)||!Wt(n.name,!1))}function vd(n,e){return!(!ta(e)||!E2(n).includes(e))}function k2(n,e,t){return Wt(t,!1)?S2(n,e).includes(t):!1}function G2(n,e,t){return Wt(t,!1)?I2(n,e).includes(t):!1}function md(n,e,t){let s=null;const o=W2(n),c=Y2(e),l=Object.keys(o),f=Object.keys(c),v=bd(Object.keys(n)),p=bd(Object.keys(e)),S=v.filter(T=>!p.includes(T));return S.length&&(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${S.toString()}
      Received: ${Object.keys(e).toString()}`)),ni(l,f)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${l.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(T=>{if(!T.includes(":")||s)return;const x=Mi(e[T].accounts);x.includes(T)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${T}
        Required: ${T}
        Approved: ${x.toString()}`))}),l.forEach(T=>{s||(ni(o[T].methods,c[T].methods)?ni(o[T].events,c[T].events)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${T}`)):s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${T}`))}),s}function W2(n){const e={};return Object.keys(n).forEach(t=>{var s;t.includes(":")?e[t]=n[t]:(s=n[t].chains)==null||s.forEach(o=>{e[o]={methods:n[t].methods,events:n[t].events}})}),e}function bd(n){return[...new Set(n.map(e=>e.includes(":")?e.split(":")[0]:e))]}function Y2(n){const e={};return Object.keys(n).forEach(t=>{if(t.includes(":"))e[t]=n[t];else{const s=Mi(n[t].accounts);s==null||s.forEach(o=>{e[o]={accounts:n[t].accounts.filter(c=>c.includes(`${o}:`)),methods:n[t].methods,events:n[t].events}})}}),e}function J2(n,e){return fh(n,!1)&&n<=e.max&&n>=e.min}function wd(){const n=Ds();return new Promise(e=>{switch(n){case Or.browser:e(Q2());break;case Or.reactNative:e(X2());break;case Or.node:e(Z2());break;default:e(!0)}})}function Q2(){return Us()&&(navigator==null?void 0:navigator.onLine)}async function X2(){if(da()&&typeof global<"u"&&global!=null&&global.NetInfo){const n=await(global==null?void 0:global.NetInfo.fetch());return n==null?void 0:n.isConnected}return!0}function Z2(){return!0}function eI(n){switch(Ds()){case Or.browser:tI(n);break;case Or.reactNative:rI(n);break}}function tI(n){Us()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function rI(n){da()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>n(e==null?void 0:e.isConnected)))}const Xc={};let Bo=class{static get(e){return Xc[e]}static set(e,t){Xc[e]=t}static delete(e){delete Xc[e]}};function nI(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<n.length;o++){var c=n.charAt(o),l=c.charCodeAt(0);if(t[l]!==255)throw new TypeError(c+" is ambiguous");t[l]=o}var f=n.length,v=n.charAt(0),p=Math.log(f)/Math.log(256),S=Math.log(256)/Math.log(f);function T(U){if(U instanceof Uint8Array||(ArrayBuffer.isView(U)?U=new Uint8Array(U.buffer,U.byteOffset,U.byteLength):Array.isArray(U)&&(U=Uint8Array.from(U))),!(U instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(U.length===0)return"";for(var z=0,M=0,ne=0,y=U.length;ne!==y&&U[ne]===0;)ne++,z++;for(var E=(y-ne)*S+1>>>0,m=new Uint8Array(E);ne!==y;){for(var w=U[ne],g=0,u=E-1;(w!==0||g<M)&&u!==-1;u--,g++)w+=256*m[u]>>>0,m[u]=w%f>>>0,w=w/f>>>0;if(w!==0)throw new Error("Non-zero carry");M=g,ne++}for(var b=E-M;b!==E&&m[b]===0;)b++;for(var K=v.repeat(z);b<E;++b)K+=n.charAt(m[b]);return K}function x(U){if(typeof U!="string")throw new TypeError("Expected String");if(U.length===0)return new Uint8Array;var z=0;if(U[z]!==" "){for(var M=0,ne=0;U[z]===v;)M++,z++;for(var y=(U.length-z)*p+1>>>0,E=new Uint8Array(y);U[z];){var m=t[U.charCodeAt(z)];if(m===255)return;for(var w=0,g=y-1;(m!==0||w<ne)&&g!==-1;g--,w++)m+=f*E[g]>>>0,E[g]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");ne=w,z++}if(U[z]!==" "){for(var u=y-ne;u!==y&&E[u]===0;)u++;for(var b=new Uint8Array(M+(y-u)),K=M;u!==y;)b[K++]=E[u++];return b}}}function A(U){var z=x(U);if(z)return z;throw new Error(`Non-${e} character`)}return{encode:T,decodeUnsafe:x,decode:A}}var iI=nI,sI=iI;const og=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},oI=n=>new TextEncoder().encode(n),aI=n=>new TextDecoder().decode(n);class cI{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class uI{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ag(this,e)}}class hI{constructor(e){this.decoders=e}or(e){return ag(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ag=(n,e)=>new hI({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class lI{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new cI(e,t,s),this.decoder=new uI(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const pa=({name:n,prefix:e,encode:t,decode:s})=>new lI(n,e,t,s),Ls=({prefix:n,name:e,alphabet:t})=>{const{encode:s,decode:o}=sI(t,e);return pa({prefix:n,name:e,encode:s,decode:c=>og(o(c))})},fI=(n,e,t,s)=>{const o={};for(let S=0;S<e.length;++S)o[e[S]]=S;let c=n.length;for(;n[c-1]==="=";)--c;const l=new Uint8Array(c*t/8|0);let f=0,v=0,p=0;for(let S=0;S<c;++S){const T=o[n[S]];if(T===void 0)throw new SyntaxError(`Non-${s} character`);v=v<<t|T,f+=t,f>=8&&(f-=8,l[p++]=255&v>>f)}if(f>=t||255&v<<8-f)throw new SyntaxError("Unexpected end of data");return l},dI=(n,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",l=0,f=0;for(let v=0;v<n.length;++v)for(f=f<<8|n[v],l+=8;l>t;)l-=t,c+=e[o&f>>l];if(l&&(c+=e[o&f<<t-l]),s)for(;c.length*t&7;)c+="=";return c},Jt=({name:n,prefix:e,bitsPerChar:t,alphabet:s})=>pa({prefix:e,name:n,encode(o){return dI(o,s,t)},decode(o){return fI(o,s,t,n)}}),pI=pa({prefix:"\0",name:"identity",encode:n=>aI(n),decode:n=>oI(n)});var gI=Object.freeze({__proto__:null,identity:pI});const yI=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var _I=Object.freeze({__proto__:null,base2:yI});const vI=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var mI=Object.freeze({__proto__:null,base8:vI});const bI=Ls({prefix:"9",name:"base10",alphabet:"0123456789"});var wI=Object.freeze({__proto__:null,base10:bI});const EI=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),SI=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var II=Object.freeze({__proto__:null,base16:EI,base16upper:SI});const OI=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),xI=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),PI=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),TI=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),AI=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),NI=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),CI=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),RI=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$I=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var UI=Object.freeze({__proto__:null,base32:OI,base32upper:xI,base32pad:PI,base32padupper:TI,base32hex:AI,base32hexupper:NI,base32hexpad:CI,base32hexpadupper:RI,base32z:$I});const DI=Ls({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),FI=Ls({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var LI=Object.freeze({__proto__:null,base36:DI,base36upper:FI});const jI=Ls({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),MI=Ls({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var qI=Object.freeze({__proto__:null,base58btc:jI,base58flickr:MI});const HI=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),zI=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),BI=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),KI=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var VI=Object.freeze({__proto__:null,base64:HI,base64pad:zI,base64url:BI,base64urlpad:KI});const cg=Array.from(""),kI=cg.reduce((n,e,t)=>(n[t]=e,n),[]),GI=cg.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function WI(n){return n.reduce((e,t)=>(e+=kI[t],e),"")}function YI(n){const e=[];for(const t of n){const s=GI[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const JI=pa({prefix:"",name:"base256emoji",encode:WI,decode:YI});var QI=Object.freeze({__proto__:null,base256emoji:JI}),XI=ug,Ed=128,ZI=127,eO=~ZI,tO=Math.pow(2,31);function ug(n,e,t){e=e||[],t=t||0;for(var s=t;n>=tO;)e[t++]=n&255|Ed,n/=128;for(;n&eO;)e[t++]=n&255|Ed,n>>>=7;return e[t]=n|0,ug.bytes=t-s+1,e}var rO=Fu,nO=128,Sd=127;function Fu(n,s){var t=0,s=s||0,o=0,c=s,l,f=n.length;do{if(c>=f)throw Fu.bytes=0,new RangeError("Could not decode varint");l=n[c++],t+=o<28?(l&Sd)<<o:(l&Sd)*Math.pow(2,o),o+=7}while(l>=nO);return Fu.bytes=c-s,t}var iO=Math.pow(2,7),sO=Math.pow(2,14),oO=Math.pow(2,21),aO=Math.pow(2,28),cO=Math.pow(2,35),uO=Math.pow(2,42),hO=Math.pow(2,49),lO=Math.pow(2,56),fO=Math.pow(2,63),dO=function(n){return n<iO?1:n<sO?2:n<oO?3:n<aO?4:n<cO?5:n<uO?6:n<hO?7:n<lO?8:n<fO?9:10},pO={encode:XI,decode:rO,encodingLength:dO},hg=pO;const Id=(n,e,t=0)=>(hg.encode(n,e,t),e),Od=n=>hg.encodingLength(n),Lu=(n,e)=>{const t=e.byteLength,s=Od(n),o=s+Od(t),c=new Uint8Array(o+t);return Id(n,c,0),Id(t,c,s),c.set(e,o),new gO(n,t,e,c)};class gO{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const lg=({name:n,code:e,encode:t})=>new yO(n,e,t);class yO{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Lu(this.code,t):t.then(s=>Lu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const fg=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),_O=lg({name:"sha2-256",code:18,encode:fg("SHA-256")}),vO=lg({name:"sha2-512",code:19,encode:fg("SHA-512")});var mO=Object.freeze({__proto__:null,sha256:_O,sha512:vO});const dg=0,bO="identity",pg=og,wO=n=>Lu(dg,pg(n)),EO={code:dg,name:bO,encode:pg,digest:wO};var SO=Object.freeze({__proto__:null,identity:EO});new TextEncoder,new TextDecoder;const xd={...gI,..._I,...mI,...wI,...II,...UI,...LI,...qI,...VI,...QI};({...mO,...SO});function gg(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function IO(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?gg(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function yg(n,e,t,s){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:s}}}const Pd=yg("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Zc=yg("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=IO(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),OO={utf8:Pd,"utf-8":Pd,hex:xd.base16,latin1:Zc,ascii:Zc,binary:Zc,...xd};function xO(n,e="utf8"){const t=OO[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?gg(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}const _g="wc",PO=2,dh="core",Dn=`${_g}@2:${dh}:`,TO={name:dh,logger:"error"},AO={database:":memory:"},NO="crypto",Td="client_ed25519_seed",CO=_e.ONE_DAY,RO="keychain",$O="0.3",UO="messages",DO="0.3",FO=_e.SIX_HOURS,LO="publisher",vg="irn",jO="error",mg="wss://relay.walletconnect.com",Ad="wss://relay.walletconnect.org",MO="relayer",er={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},qO="_subscription",mn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},HO=_e.ONE_SECOND,zO="2.10.0",BO=1e4,KO="0.3",VO="WALLETCONNECT_CLIENT_ID",nn={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},kO="subscription",GO="0.3",WO=_e.FIVE_SECONDS*1e3,YO="pairing",JO="0.3",ds={wc_pairingDelete:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:0},res:{ttl:_e.ONE_DAY,prompt:!1,tag:0}}},rn={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},QO="history",XO="0.3",ZO="expirer",Fr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},e3="0.3",eu="verify-api",Yo="https://verify.walletconnect.com",Nd="https://verify.walletconnect.org";class t3{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=RO,this.version=$O,this.initialized=!1,this.storagePrefix=Dn,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=ue("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=Ze.generateChildLogger(t,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,eg(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?tg(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class r3{constructor(e,t,s){this.core=e,this.logger=t,this.name=NO,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=Gf(o);return Tp(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=K6();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),l=Gf(c),f=Uu();return await QE(f,o,CO,l)},this.generateSharedKey=(o,c,l)=>{this.isInitialized();const f=this.getPrivateKey(o),v=V6(f,c);return this.setSymKey(v,l)},this.setSymKey=async(o,c)=>{this.isInitialized();const l=c||k6(o);return await this.keychain.set(l,o),l},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,l)=>{this.isInitialized();const f=Zp(l),v=xs(c);if(ld(f)){const x=f.senderPublicKey,A=f.receiverPublicKey;o=await this.generateSharedKey(x,A)}const p=this.getSymKey(o),{type:S,senderPublicKey:T}=f;return W6({type:S,symKey:p,message:v,senderPublicKey:T})},this.decode=async(o,c,l)=>{this.isInitialized();const f=Q6(c,l);if(ld(f)){const v=f.receiverPublicKey,p=f.senderPublicKey;o=await this.generateSharedKey(v,p)}try{const v=this.getSymKey(o),p=Y6({symKey:v,encoded:c});return Bu(p)}catch(v){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(v)}},this.getPayloadType=o=>{const c=ea(o);return $s(c.type)},this.getPayloadSenderPublicKey=o=>{const c=ea(o);return c.senderPublicKey?Lr(c.senderPublicKey,ur):void 0},this.core=e,this.logger=Ze.generateChildLogger(t,this.name),this.keychain=s||new t3(this.core,this.logger)}get context(){return Ze.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Td)}catch{e=Uu(),await this.keychain.set(Td,e)}return xO(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}let n3=class extends S6{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=UO,this.version=DO,this.initialized=!1,this.storagePrefix=Dn,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=$i(o);let l=this.messages.get(s);return typeof l>"u"&&(l={}),typeof l[c]<"u"||(l[c]=o,this.messages.set(s,l),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),l=$i(o);return typeof c[l]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Ze.generateChildLogger(e,this.name),this.core=t}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,eg(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?tg(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}};class i3 extends I6{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new Mr.EventEmitter,this.name=LO,this.queue=new Map,this.publishTimeout=_e.toMiliseconds(_e.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{var l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const f=(c==null?void 0:c.ttl)||FO,v=Du(c),p=(c==null?void 0:c.prompt)||!1,S=(c==null?void 0:c.tag)||0,T=(c==null?void 0:c.id)||Hp().toString(),x={topic:s,message:o,opts:{ttl:f,relay:v,prompt:p,tag:S,id:T}},A=setTimeout(()=>this.queue.set(T,x),this.publishTimeout);try{await await Ns(this.rpcPublish(s,o,f,v,p,S,T),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(T),this.relayer.events.emit(er.publish,x)}catch(U){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(l=c==null?void 0:c.internal)!=null&&l.throwOnFailedPublish)throw this.removeRequestFromQueue(T),U;return}finally{clearTimeout(A)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=Ze.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Ze.getLoggerContext(this.logger)}rpcPublish(e,t,s,o,c,l,f){var v,p,S,T;const x={method:Go(o.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:c,tag:l},id:f};return cr((v=x.params)==null?void 0:v.prompt)&&((p=x.params)==null||delete p.prompt),cr((S=x.params)==null?void 0:S.tag)&&((T=x.params)==null||delete T.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:x}),this.relayer.request(x)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:o}=e;await this.publish(t,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Di.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(er.connection_stalled);return}this.checkQueue()}),this.relayer.on(er.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class s3{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const o=s.filter(c=>c!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var o3=Object.defineProperty,a3=Object.defineProperties,c3=Object.getOwnPropertyDescriptors,Cd=Object.getOwnPropertySymbols,u3=Object.prototype.hasOwnProperty,h3=Object.prototype.propertyIsEnumerable,Rd=(n,e,t)=>e in n?o3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ps=(n,e)=>{for(var t in e||(e={}))u3.call(e,t)&&Rd(n,t,e[t]);if(Cd)for(var t of Cd(e))h3.call(e,t)&&Rd(n,t,e[t]);return n},tu=(n,e)=>a3(n,c3(e));class l3 extends P6{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new s3,this.events=new Mr.EventEmitter,this.name=kO,this.version=GO,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Dn,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=Du(o),l={topic:s,relay:c};this.pending.set(s,l);const f=await this.rpcSubscribe(s,c);return this.onSubscribe(f,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,c)=>{const l=new _e.Watch;l.start(this.pendingSubscriptionWatchLabel);const f=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(f),l.stop(this.pendingSubscriptionWatchLabel),o(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=WO&&(clearInterval(f),l.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Ze.generateChildLogger(t,this.name),this.clientId=""}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const o=Du(s);await this.rpcUnsubscribe(e,t,o);const c=Gt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const s={method:Go(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Ns(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(er.connection_stalled)}return $i(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:Go(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Ns(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(er.connection_stalled)}}rpcUnsubscribe(e,t,s){const o={method:Go(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,tu(ps({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,ps({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,ps({},t)),this.topicMap.set(t.topic,e),this.events.emit(nn.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(nn.deleted,tu(ps({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(nn.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(nn.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);Fs(t)&&this.onBatchSubscribe(t.map((s,o)=>tu(ps({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Di.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(er.connect,async()=>{await this.onConnect()}),this.relayer.on(er.disconnect,()=>{this.onDisconnect()}),this.events.on(nn.created,async e=>{const t=nn.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(nn.deleted,async e=>{const t=nn.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var f3=Object.defineProperty,$d=Object.getOwnPropertySymbols,d3=Object.prototype.hasOwnProperty,p3=Object.prototype.propertyIsEnumerable,Ud=(n,e,t)=>e in n?f3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,g3=(n,e)=>{for(var t in e||(e={}))d3.call(e,t)&&Ud(n,t,e[t]);if($d)for(var t of $d(e))p3.call(e,t)&&Ud(n,t,e[t]);return n};class y3 extends O6{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Mr.EventEmitter,this.name=MO,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(er.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(er.error,t)},this.registerProviderListeners=()=>{this.provider.on(mn.payload,this.onPayloadHandler),this.provider.on(mn.connect,this.onConnectHandler),this.provider.on(mn.disconnect,this.onDisconnectHandler),this.provider.on(mn.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Ze.generateChildLogger(e.logger,this.name):Ze.pino(Ze.getDefaultLoggerOptions({level:e.logger||jO})),this.messages=new n3(this.logger,e.core),this.subscriber=new l3(this,this.logger),this.publisher=new i3(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||mg,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Ad}...`),await this.restartTransport(Ad)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},BO)}get context(){return Ze.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";return o||(await Promise.all([new Promise(c=>{this.subscriber.once(nn.created,l=>{l.topic===e&&c()})}),new Promise(async c=>{o=await this.subscriber.subscribe(e,t),c()})]),o)}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Ns(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(t=>{if(!this.initialized)return t();this.subscriber.once(nn.resubscribed,()=>{t()})}),new Promise(async(t,s)=>{try{await Ns(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}t()})])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.provider.events.emit(mn.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await wd())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ln(new v6(c2({sdkVersion:zO,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const o=this.messages.has(t,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),sh(e)){if(!e.method.endsWith(qO))return;const t=e.params,{topic:s,message:o,publishedAt:c}=t.data,l={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(g3({type:"event",event:t.id},l)),this.events.emit(t.id,l),await this.acknowledgePayload(e),await this.onMessageEvent(l)}else fa(e)&&this.events.emit(er.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(er.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=ih(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(mn.payload,this.onPayloadHandler),this.provider.off(mn.connect,this.onConnectHandler),this.provider.off(mn.disconnect,this.onDisconnectHandler),this.provider.off(mn.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(er.connection_stalled,()=>{this.restartTransport().catch(t=>this.logger.error(t))});let e=await wd();eI(async t=>{this.initialized&&e!==t&&(e=t,t?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(er.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},_e.toMiliseconds(HO)))}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var _3=Object.defineProperty,Dd=Object.getOwnPropertySymbols,v3=Object.prototype.hasOwnProperty,m3=Object.prototype.propertyIsEnumerable,Fd=(n,e,t)=>e in n?_3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ld=(n,e)=>{for(var t in e||(e={}))v3.call(e,t)&&Fd(n,t,e[t]);if(Dd)for(var t of Dd(e))m3.call(e,t)&&Fd(n,t,e[t]);return n};class ga extends x6{constructor(e,t,s,o=Dn,c=void 0){super(e,t,s,o),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=KO,this.cached=[],this.initialized=!1,this.storagePrefix=Dn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!cr(l)?this.map.set(this.getKey(l),l):C2(l)?this.map.set(l.id,l):R2(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,f)=>{this.isInitialized(),this.map.has(l)?await this.update(l,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:f}),this.map.set(l,f),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(f=>Object.keys(l).every(v=>b6(f[v],l[v]))):this.values),this.update=async(l,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:f});const v=Ld(Ld({},this.getData(l)),f);this.map.set(l,v),await this.persist()},this.delete=async(l,f)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:f}),this.map.delete(l),await this.persist())},this.logger=Ze.generateChildLogger(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class b3{constructor(e,t){this.core=e,this.logger=t,this.name=YO,this.version=JO,this.events=new zu,this.initialized=!1,this.storagePrefix=Dn,this.ignoredPayloadTypes=[ai],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Uu(),o=await this.core.crypto.setSymKey(s),c=Gr(_e.FIVE_MINUTES),l={protocol:vg},f={topic:o,expiry:c,relay:l,active:!1},v=w2({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:l});return await this.pairings.set(o,f),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:v}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:l}=v2(s.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const f=Gr(_e.FIVE_MINUTES),v={topic:o,relay:l,expiry:f,active:!1};return await this.pairings.set(o,v),await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:l}),this.core.expirer.set(o,f),s.activatePairing&&await this.activate({topic:o}),v},this.activate=async({topic:s})=>{this.isInitialized();const o=Gr(_e.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:l,resolve:f,reject:v}=Ri();this.events.once(zt("pairing_ping",c),({error:p})=>{p?v(p):f()}),await l()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Gt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const l=Ts(o,c),f=await this.core.crypto.encode(s,l),v=ds[o].req;return this.core.history.set(s,l),this.core.relayer.publish(s,f,v),l.id},this.sendResult=async(s,o,c)=>{const l=ih(s,c),f=await this.core.crypto.encode(o,l),v=await this.core.history.get(o,s),p=ds[v.request.method].res;await this.core.relayer.publish(o,f,p),await this.core.history.resolve(l)},this.sendError=async(s,o,c)=>{const l=la(s,c),f=await this.core.crypto.encode(o,l),v=await this.core.history.get(o,s),p=ds[v.request.method]?ds[v.request.method].res:ds.unregistered_method.res;await this.core.relayer.publish(o,f,p),await this.core.history.resolve(l)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Gt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>$n(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,l=(await this.core.history.get(o,c.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit("pairing_ping",{id:c,topic:s})}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{wn(o)?this.events.emit(zt("pairing_ping",c),{}):kr(o)&&this.events.emit(zt("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:c,topic:s})}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:l}=o;try{if(this.registeredMethods.includes(l))return;const f=Gt("WC_METHOD_UNSUPPORTED",l);await this.sendError(c,s,f),this.logger.error(f)}catch(f){await this.sendError(c,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Gt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!_r(s)){const{message:o}=ue("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(o)}if(!N2(s.uri)){const{message:o}=ue("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(o)}},this.isValidPing=async s=>{if(!_r(s)){const{message:c}=ue("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!_r(s)){const{message:c}=ue("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Wt(s,!1)){const{message:o}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if($n(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=ue("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=Ze.generateChildLogger(t,this.name),this.pairings=new ga(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ze.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(er.message,async e=>{const{topic:t,message:s}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(t,s);try{sh(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):fa(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Fr.expired,async e=>{const{topic:t}=ng(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}class w3 extends E6{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new Mr.EventEmitter,this.name=QO,this.version=XO,this.cached=[],this.initialized=!1,this.storagePrefix=Dn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const l={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:Gr(_e.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(rn.created,l)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=kr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(rn.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(rn.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Ze.generateChildLogger(t,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:Ts(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(rn.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(rn.created,e=>{const t=rn.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(rn.updated,e=>{const t=rn.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(rn.deleted,e=>{const t=rn.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(Di.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{_e.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class E3 extends T6{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new Mr.EventEmitter,this.name=ZO,this.version=e3,this.cached=[],this.initialized=!1,this.storagePrefix=Dn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),l={target:c,expiry:o};this.expirations.set(c,l),this.checkExpiry(c,l),this.events.emit(Fr.created,{target:c,expiration:l})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Fr.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Ze.generateChildLogger(t,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return u2(e);if(typeof e=="number")return h2(e);const{message:t}=ue("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Fr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;_e.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Fr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Di.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Fr.created,e=>{const t=Fr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Fr.expired,e=>{const t=Fr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Fr.deleted,e=>{const t=Fr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class S3 extends A6{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=eu,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||da()||!Us())return;const o=(s==null?void 0:s.verifyUrl)||Yo;this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.warn(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.warn(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Nd;try{await this.createIframe()}catch(c){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(c),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=(s==null?void 0:s.verifyUrl)||Yo;let c="";try{c=await this.fetchAttestation(s.attestationId,o)}catch(l){this.logger.warn(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.warn(l),c=await this.fetchAttestation(s.attestationId,Nd)}return c},this.fetchAttestation=async(s,o)=>{var c;this.logger.info(`resolving attestation: ${s} from url: ${o}`);const l=this.startAbortTimer(_e.ONE_SECOND*2),f=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(l),f.status===200?(c=await f.json())==null?void 0:c.origin:""},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(c=>{if(document.getElementById(eu))return c();window.addEventListener("message",o);const l=document.createElement("iframe");l.id=eu,l.src=`${this.verifyUrl}/${this.projectId}`,l.style.display="none",document.body.append(l),this.iframe=l,s=c}),new Promise((c,l)=>setTimeout(()=>{window.removeEventListener("message",o),l("verify iframe load timeout")},_e.toMiliseconds(_e.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=Ze.generateChildLogger(t,this.name),this.verifyUrl=Yo,this.abortController=new AbortController,this.isDevEnv=lh()&&{VITE_SERVER_URL:"https://anshu-f67g.onrender.com"}.IS_VITEST}get context(){return Ze.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),_e.toMiliseconds(e))}}var I3=Object.defineProperty,jd=Object.getOwnPropertySymbols,O3=Object.prototype.hasOwnProperty,x3=Object.prototype.propertyIsEnumerable,Md=(n,e,t)=>e in n?I3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,qd=(n,e)=>{for(var t in e||(e={}))O3.call(e,t)&&Md(n,t,e[t]);if(jd)for(var t of jd(e))x3.call(e,t)&&Md(n,t,e[t]);return n};class ph extends w6{constructor(e){super(e),this.protocol=_g,this.version=PO,this.name=dh,this.events=new Mr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||mg;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||TO.logger}));this.logger=Ze.generateChildLogger(t,this.name),this.heartbeat=new Di.HeartBeat,this.crypto=new r3(this,this.logger,e==null?void 0:e.keychain),this.history=new w3(this,this.logger),this.expirer=new E3(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new jb(qd(qd({},AO),e==null?void 0:e.storageOptions)),this.relayer=new y3({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new b3(this,this.logger),this.verify=new S3(this.projectId||"",this.logger)}static async init(e){const t=new ph(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(VO,s),t}get context(){return Ze.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const P3=ph,bg="wc",wg=2,Eg="client",gh=`${bg}@${wg}:${Eg}:`,ru={name:Eg,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Hd="WALLETCONNECT_DEEPLINK_CHOICE",T3="proposal",Sg="Proposal expired",A3="session",Ko=_e.SEVEN_DAYS,N3="engine",gs={wc_sessionPropose:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1104},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1106},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1112},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1115}}},nu={min:_e.FIVE_MINUTES,max:_e.SEVEN_DAYS},bn={idle:"IDLE",active:"ACTIVE"},C3="request",R3=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var $3=Object.defineProperty,U3=Object.defineProperties,D3=Object.getOwnPropertyDescriptors,zd=Object.getOwnPropertySymbols,F3=Object.prototype.hasOwnProperty,L3=Object.prototype.propertyIsEnumerable,Bd=(n,e,t)=>e in n?$3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,yr=(n,e)=>{for(var t in e||(e={}))F3.call(e,t)&&Bd(n,t,e[t]);if(zd)for(var t of zd(e))L3.call(e,t)&&Bd(n,t,e[t]);return n},ys=(n,e)=>U3(n,D3(e));class j3 extends C6{constructor(e){super(e),this.name=N3,this.events=new zu,this.initialized=!1,this.ignoredPayloadTypes=[ai],this.requestQueue={state:bn.idle,queue:[]},this.sessionRequestQueue={state:bn.idle,queue:[]},this.requestQueueDelay=_e.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(gs)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},_e.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const s=ys(yr({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:f,relays:v}=s;let p=o,S,T=!1;if(p&&(T=this.client.core.pairing.pairings.get(p).active),!p||!T){const{topic:E,uri:m}=await this.client.core.pairing.create();p=E,S=m}const x=await this.client.core.crypto.generateKeyPair(),A=yr({requiredNamespaces:c,optionalNamespaces:l,relays:v??[{protocol:vg}],proposer:{publicKey:x,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:U,resolve:z,done:M}=Ri(_e.FIVE_MINUTES,Sg);if(this.events.once(zt("session_connect"),async({error:E,session:m})=>{if(E)U(E);else if(m){m.self.publicKey=x;const w=ys(yr({},m),{requiredNamespaces:m.requiredNamespaces,optionalNamespaces:m.optionalNamespaces});await this.client.session.set(m.topic,w),await this.setExpiry(m.topic,m.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:m.peer.metadata}),z(w)}}),!p){const{message:E}=ue("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(E)}const ne=await this.sendRequest({topic:p,method:"wc_sessionPropose",params:A}),y=Gr(_e.FIVE_MINUTES);return await this.setProposal(ne,yr({id:ne,expiry:y},A)),{uri:S,approval:M}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:l}=t,f=this.client.proposal.get(s);let{pairingTopic:v,proposer:p,requiredNamespaces:S,optionalNamespaces:T}=f;v=v||"",ws(S)||(S=O2(c,"approve()"));const x=await this.client.core.crypto.generateKeyPair(),A=p.publicKey,U=await this.client.core.crypto.generateSharedKey(x,A);v&&s&&(await this.client.core.pairing.updateMetadata({topic:v,metadata:p.metadata}),await this.sendResult({id:s,topic:v,result:{relay:{protocol:o??"irn"},responderPublicKey:x}}),await this.client.proposal.delete(s,Gt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:v}));const z=yr({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:S,optionalNamespaces:T,pairingTopic:v,controller:{publicKey:x,metadata:this.client.metadata},expiry:Gr(Ko)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(U),await this.sendRequest({topic:U,method:"wc_sessionSettle",params:z,throwOnFailedPublish:!0});const M=ys(yr({},z),{topic:U,pairingTopic:v,acknowledged:!1,self:z.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:x});return await this.client.session.set(U,M),await this.setExpiry(U,Gr(Ko)),{topic:U,acknowledged:()=>new Promise(ne=>setTimeout(()=>ne(this.client.session.get(U)),500))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:s,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,Gt("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:o}=t,c=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:l,resolve:f,reject:v}=Ri();return this.events.once(zt("session_update",c),({error:p})=>{p?v(p):f()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:l}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:c,resolve:l,reject:f}=Ri();return this.events.once(zt("session_extend",o),({error:v})=>{v?f(v):l()}),await this.setExpiry(s,Gr(Ko)),{acknowledged:c}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:o,topic:c,expiry:l}=t,f=nh(),{done:v,resolve:p,reject:S}=Ri(l);return this.events.once(zt("session_request",f),({error:T,result:x})=>{T?S(T):p(x)}),await Promise.all([new Promise(async T=>{await this.sendRequest({clientRpcId:f,topic:c,method:"wc_sessionRequest",params:{request:o,chainId:s},expiry:l,throwOnFailedPublish:!0}).catch(x=>S(x)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:f}),T()}),new Promise(async T=>{const x=await this.client.core.storage.getItem(Hd);l2({id:f,topic:c,wcDeepLink:x}),T()}),v()]).then(T=>T[2])},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:o}=t,{id:c}=o;wn(o)?await this.sendResult({id:c,topic:s,result:o.result,throwOnFailedPublish:!0}):kr(o)&&await this.sendError(c,s,o.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:c,resolve:l,reject:f}=Ri();this.events.once(zt("session_ping",o),({error:v})=>{v?f(v):l()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:o,chainId:c}=t;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:Gt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>T2(s,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var l,f;return((l=c.peerMetadata)==null?void 0:l.url)&&((f=c.peerMetadata)==null?void 0:f.url)===t.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(t,s)=>{const{self:o}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,Gt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),s||this.client.core.expirer.del(t),this.client.core.storage.removeItem(Hd).catch(c=>this.client.logger.warn(c))},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,Gt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),o?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==t),o&&(this.sessionRequestQueue.state=bn.idle)},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,s.expiry)},this.setPendingSessionRequest=async t=>{const s=gs.wc_sessionRequest.req.ttl,{id:o,topic:c,params:l}=t;await this.client.pendingRequest.set(o,{id:o,topic:c,params:l}),s&&this.client.core.expirer.set(o,Gr(s))},this.sendRequest=async t=>{const{topic:s,method:o,params:c,expiry:l,relayRpcId:f,clientRpcId:v,throwOnFailedPublish:p}=t,S=Ts(o,c,v);if(Us()&&R3.includes(o)){const A=$i(JSON.stringify(S));this.client.core.verify.register({attestationId:A})}const T=await this.client.core.crypto.encode(s,S),x=gs[o].req;return l&&(x.ttl=l),f&&(x.id=f),this.client.core.history.set(s,S),p?(x.internal=ys(yr({},x.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,T,x)):this.client.core.relayer.publish(s,T,x).catch(A=>this.client.logger.error(A)),S.id},this.sendResult=async t=>{const{id:s,topic:o,result:c,throwOnFailedPublish:l}=t,f=ih(s,c),v=await this.client.core.crypto.encode(o,f),p=await this.client.core.history.get(o,s),S=gs[p.request.method].res;l?(S.internal=ys(yr({},S.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,v,S)):this.client.core.relayer.publish(o,v,S).catch(T=>this.client.logger.error(T)),await this.client.core.history.resolve(f)},this.sendError=async(t,s,o)=>{const c=la(t,o),l=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,t),v=gs[f.request.method].res;this.client.core.relayer.publish(s,l,v),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(o=>{$n(o.expiry)&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{$n(o.expiry)&&s.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===bn.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=bn.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=bn.idle},this.processRequest=t=>{const{topic:s,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:o}=t,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:o}=ue("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(yr({},s.params));const l=Gr(_e.FIVE_MINUTES),f=yr({id:c,pairingTopic:t,expiry:l},o);await this.setProposal(c,f);const v=$i(JSON.stringify(s)),p=await this.getVerifyContext(v,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:p})}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(t,s)=>{const{id:o}=s;if(wn(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const l=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const f=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const v=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:v});const p=await this.client.core.crypto.generateSharedKey(f,v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const S=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:S}),await this.client.core.pairing.activate({topic:t})}else kr(s)&&(await this.client.proposal.delete(o,Gt("USER_DISCONNECTED")),this.events.emit(zt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:l,controller:f,expiry:v,namespaces:p,requiredNamespaces:S,optionalNamespaces:T,sessionProperties:x,pairingTopic:A}=s.params,U=yr({topic:t,relay:l,expiry:v,namespaces:p,acknowledged:!0,pairingTopic:A,requiredNamespaces:S,optionalNamespaces:T,controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},x&&{sessionProperties:x});await this.sendResult({id:s.id,topic:t,result:!0}),this.events.emit(zt("session_connect"),{session:U}),this.cleanupDuplicatePairings(U)}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(t,s)=>{const{id:o}=s;wn(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(zt("session_approve",o),{})):kr(s)&&(await this.client.session.delete(t,Gt("USER_DISCONNECTED")),this.events.emit(zt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:o,id:c}=s;try{const l=`${t}_session_update`,f=Bo.get(l);if(f&&this.isRequestOutOfSync(f,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(yr({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:t,result:!0}),this.client.events.emit("session_update",{id:c,topic:t,params:o}),Bo.set(l,c)}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.isRequestOutOfSync=(t,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,s)=>{const{id:o}=s;wn(s)?this.events.emit(zt("session_update",o),{}):kr(s)&&this.events.emit(zt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:o}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Gr(Ko)),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,s)=>{const{id:o}=s;wn(s)?this.events.emit(zt("session_extend",o),{}):kr(s)&&this.events.emit(zt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:o}=s;try{this.isValidPing({topic:t}),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,s)=>{const{id:o}=s;setTimeout(()=>{wn(s)?this.events.emit(zt("session_ping",o),{}):kr(s)&&this.events.emit(zt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(er.publish,async()=>{c(await this.deleteSession(t))})}),this.sendResult({id:o,topic:t,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:t})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(yr({topic:t},c)),await this.setPendingSessionRequest({id:o,topic:t,params:c}),this.addSessionRequestToSessionRequestQueue({id:o,topic:t,params:c}),await this.processSessionRequestQueue()}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(t,s)=>{const{id:o}=s;wn(s)?this.events.emit(zt("session_request",o),{result:s.result}):kr(s)&&this.events.emit(zt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:o,params:c}=s;try{const l=`${t}_session_event_${c.event.name}`,f=Bo.get(l);if(f&&this.isRequestOutOfSync(f,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(yr({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c}),Bo.set(l,o)}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=bn.idle,this.processSessionRequestQueue()},_e.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=async()=>{if(this.sessionRequestQueue.state===bn.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{const{id:s,topic:o,params:c}=t,l=$i(JSON.stringify(Ts("wc_sessionRequest",c,s))),f=this.client.session.get(o),v=await this.getVerifyContext(l,f.peer.metadata);this.sessionRequestQueue.state=bn.active,this.client.events.emit("session_request",{id:s,topic:o,params:c,verifyContext:v})}catch(s){this.client.logger.error(s)}},this.isValidConnect=async t=>{if(!_r(t)){const{message:v}=ue("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(v)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:l,relays:f}=t;if(cr(s)||await this.isValidPairingTopic(s),!q2(f,!0)){const{message:v}=ue("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(v)}!cr(o)&&ws(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!cr(c)&&ws(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),cr(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(t,s)=>{const o=M2(t,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!_r(t))throw new Error(ue("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:l}=t;await this.isValidProposalId(s);const f=this.client.proposal.get(s),v=Wo(o,"approve()");if(v)throw new Error(v.message);const p=md(f.requiredNamespaces,o,"approve()");if(p)throw new Error(p.message);if(!Wt(c,!0)){const{message:S}=ue("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(S)}cr(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async t=>{if(!_r(t)){const{message:c}=ue("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:s,reason:o}=t;if(await this.isValidProposalId(s),!z2(o)){const{message:c}=ue("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!_r(t)){const{message:p}=ue("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(p)}const{relay:s,controller:o,namespaces:c,expiry:l}=t;if(!sg(s)){const{message:p}=ue("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const f=$2(o,"onSessionSettleRequest()");if(f)throw new Error(f.message);const v=Wo(c,"onSessionSettleRequest()");if(v)throw new Error(v.message);if($n(l)){const{message:p}=ue("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async t=>{if(!_r(t)){const{message:v}=ue("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(v)}const{topic:s,namespaces:o}=t;await this.isValidSessionTopic(s);const c=this.client.session.get(s),l=Wo(o,"update()");if(l)throw new Error(l.message);const f=md(c.requiredNamespaces,o,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async t=>{if(!_r(t)){const{message:o}=ue("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!_r(t)){const{message:v}=ue("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(v)}const{topic:s,request:o,chainId:c,expiry:l}=t;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!vd(f,c)){const{message:v}=ue("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(v)}if(!B2(o)){const{message:v}=ue("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(v)}if(!k2(f,c,o.method)){const{message:v}=ue("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(v)}if(l&&!J2(l,nu)){const{message:v}=ue("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${nu.min} and ${nu.max}`);throw new Error(v)}},this.isValidRespond=async t=>{if(!_r(t)){const{message:c}=ue("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(c)}const{topic:s,response:o}=t;if(await this.isValidSessionTopic(s),!K2(o)){const{message:c}=ue("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidPing=async t=>{if(!_r(t)){const{message:o}=ue("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!_r(t)){const{message:f}=ue("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(f)}const{topic:s,event:o,chainId:c}=t;await this.isValidSessionTopic(s);const{namespaces:l}=this.client.session.get(s);if(!vd(l,c)){const{message:f}=ue("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!V2(o)){const{message:f}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}if(!G2(l,c,o.name)){const{message:f}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}},this.isValidDisconnect=async t=>{if(!_r(t)){const{message:o}=ue("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const o={verified:{verifyUrl:s.verifyUrl||Yo,validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c,o.verified.validation=c===new URL(s.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.error(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(o=>{if(!Wt(o,!1)){const{message:c}=ue("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(er.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(t,s);try{sh(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):fa(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Fr.expired,async e=>{const{topic:t,id:s}=ng(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ue("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(e){if(!Wt(e,!1)){const{message:t}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if($n(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=ue("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Wt(e,!1)){const{message:t}=ue("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if($n(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:t}=ue("EXPIRED",`session topic: ${e}`);throw new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Wt(e,!1)){const{message:t}=ue("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=ue("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!H2(e)){const{message:t}=ue("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if($n(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:t}=ue("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class M3 extends ga{constructor(e,t){super(e,t,T3,gh),this.core=e,this.logger=t}}class q3 extends ga{constructor(e,t){super(e,t,A3,gh),this.core=e,this.logger=t}}class H3 extends ga{constructor(e,t){super(e,t,C3,gh,s=>s.id),this.core=e,this.logger=t}}let z3=class Ig extends N6{constructor(e){super(e),this.protocol=bg,this.version=wg,this.name=ru.name,this.events=new Mr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||ru.name,this.metadata=(e==null?void 0:e.metadata)||i2();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||ru.logger}));this.core=(e==null?void 0:e.core)||new P3(e),this.logger=Ze.generateChildLogger(t,this.name),this.session=new q3(this.core,this.logger),this.proposal=new M3(this.core,this.logger),this.pendingRequest=new H3(this.core,this.logger),this.engine=new j3(this)}static async init(e){const t=new Ig(e);return await t.initialize(),t}get context(){return Ze.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};function B3(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function K3(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?B3(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Og(n,e,t,s){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:s}}}const Kd=Og("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),iu=Og("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=K3(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e});({hex:Un.base16,...Un});var dt={};Object.defineProperty(dt,"__esModule",{value:!0});dt.getLocalStorage=dt.getLocalStorageOrThrow=dt.getCrypto=dt.getCryptoOrThrow=dt.getLocation=dt.getLocationOrThrow=dt.getNavigator=dt.getNavigatorOrThrow=dt.getDocument=dt.getDocumentOrThrow=dt.getFromWindowOrThrow=dt.getFromWindow=void 0;function ci(n){let e;return typeof window<"u"&&typeof window[n]<"u"&&(e=window[n]),e}dt.getFromWindow=ci;function qi(n){const e=ci(n);if(!e)throw new Error(`${n} is not defined in Window`);return e}dt.getFromWindowOrThrow=qi;function V3(){return qi("document")}dt.getDocumentOrThrow=V3;function k3(){return ci("document")}dt.getDocument=k3;function G3(){return qi("navigator")}dt.getNavigatorOrThrow=G3;function W3(){return ci("navigator")}dt.getNavigator=W3;function Y3(){return qi("location")}dt.getLocationOrThrow=Y3;function J3(){return ci("location")}dt.getLocation=J3;function Q3(){return qi("crypto")}dt.getCryptoOrThrow=Q3;function X3(){return ci("crypto")}dt.getCrypto=X3;function Z3(){return qi("localStorage")}dt.getLocalStorageOrThrow=Z3;function e5(){return ci("localStorage")}dt.getLocalStorage=e5;var yh={};Object.defineProperty(yh,"__esModule",{value:!0});yh.getWindowMetadata=void 0;const Vd=dt;function t5(){let n,e;try{n=Vd.getDocumentOrThrow(),e=Vd.getLocationOrThrow()}catch{return null}function t(){const T=n.getElementsByTagName("link"),x=[];for(let A=0;A<T.length;A++){const U=T[A],z=U.getAttribute("rel");if(z&&z.toLowerCase().indexOf("icon")>-1){const M=U.getAttribute("href");if(M)if(M.toLowerCase().indexOf("https:")===-1&&M.toLowerCase().indexOf("http:")===-1&&M.indexOf("//")!==0){let ne=e.protocol+"//"+e.host;if(M.indexOf("/")===0)ne+=M;else{const y=e.pathname.split("/");y.pop();const E=y.join("/");ne+=E+"/"+M}x.push(ne)}else if(M.indexOf("//")===0){const ne=e.protocol+M;x.push(ne)}else x.push(M)}}return x}function s(...T){const x=n.getElementsByTagName("meta");for(let A=0;A<x.length;A++){const U=x[A],z=["itemprop","property","name"].map(M=>U.getAttribute(M)).filter(M=>M?T.includes(M):!1);if(z.length&&z){const M=U.getAttribute("content");if(M)return M}}return""}function o(){let T=s("name","og:site_name","og:title","twitter:title");return T||(T=n.title),T}function c(){return s("description","og:description","twitter:description","keywords")}const l=o(),f=c(),v=e.origin,p=t();return{description:f,url:v,icons:p,name:l}}yh.getWindowMetadata=t5;var r5={};(function(n){const e=Xu,t=Zu,s=eh,o=th,c=y=>y==null,l=Symbol("encodeFragmentIdentifier");function f(y){switch(y.arrayFormat){case"index":return E=>(m,w)=>{const g=m.length;return w===void 0||y.skipNull&&w===null||y.skipEmptyString&&w===""?m:w===null?[...m,[S(E,y),"[",g,"]"].join("")]:[...m,[S(E,y),"[",S(g,y),"]=",S(w,y)].join("")]};case"bracket":return E=>(m,w)=>w===void 0||y.skipNull&&w===null||y.skipEmptyString&&w===""?m:w===null?[...m,[S(E,y),"[]"].join("")]:[...m,[S(E,y),"[]=",S(w,y)].join("")];case"colon-list-separator":return E=>(m,w)=>w===void 0||y.skipNull&&w===null||y.skipEmptyString&&w===""?m:w===null?[...m,[S(E,y),":list="].join("")]:[...m,[S(E,y),":list=",S(w,y)].join("")];case"comma":case"separator":case"bracket-separator":{const E=y.arrayFormat==="bracket-separator"?"[]=":"=";return m=>(w,g)=>g===void 0||y.skipNull&&g===null||y.skipEmptyString&&g===""?w:(g=g===null?"":g,w.length===0?[[S(m,y),E,S(g,y)].join("")]:[[w,S(g,y)].join(y.arrayFormatSeparator)])}default:return E=>(m,w)=>w===void 0||y.skipNull&&w===null||y.skipEmptyString&&w===""?m:w===null?[...m,S(E,y)]:[...m,[S(E,y),"=",S(w,y)].join("")]}}function v(y){let E;switch(y.arrayFormat){case"index":return(m,w,g)=>{if(E=/\[(\d*)\]$/.exec(m),m=m.replace(/\[\d*\]$/,""),!E){g[m]=w;return}g[m]===void 0&&(g[m]={}),g[m][E[1]]=w};case"bracket":return(m,w,g)=>{if(E=/(\[\])$/.exec(m),m=m.replace(/\[\]$/,""),!E){g[m]=w;return}if(g[m]===void 0){g[m]=[w];return}g[m]=[].concat(g[m],w)};case"colon-list-separator":return(m,w,g)=>{if(E=/(:list)$/.exec(m),m=m.replace(/:list$/,""),!E){g[m]=w;return}if(g[m]===void 0){g[m]=[w];return}g[m]=[].concat(g[m],w)};case"comma":case"separator":return(m,w,g)=>{const u=typeof w=="string"&&w.includes(y.arrayFormatSeparator),b=typeof w=="string"&&!u&&T(w,y).includes(y.arrayFormatSeparator);w=b?T(w,y):w;const K=u||b?w.split(y.arrayFormatSeparator).map(k=>T(k,y)):w===null?w:T(w,y);g[m]=K};case"bracket-separator":return(m,w,g)=>{const u=/(\[\])$/.test(m);if(m=m.replace(/\[\]$/,""),!u){g[m]=w&&T(w,y);return}const b=w===null?[]:w.split(y.arrayFormatSeparator).map(K=>T(K,y));if(g[m]===void 0){g[m]=b;return}g[m]=[].concat(g[m],b)};default:return(m,w,g)=>{if(g[m]===void 0){g[m]=w;return}g[m]=[].concat(g[m],w)}}}function p(y){if(typeof y!="string"||y.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function S(y,E){return E.encode?E.strict?e(y):encodeURIComponent(y):y}function T(y,E){return E.decode?t(y):y}function x(y){return Array.isArray(y)?y.sort():typeof y=="object"?x(Object.keys(y)).sort((E,m)=>Number(E)-Number(m)).map(E=>y[E]):y}function A(y){const E=y.indexOf("#");return E!==-1&&(y=y.slice(0,E)),y}function U(y){let E="";const m=y.indexOf("#");return m!==-1&&(E=y.slice(m)),E}function z(y){y=A(y);const E=y.indexOf("?");return E===-1?"":y.slice(E+1)}function M(y,E){return E.parseNumbers&&!Number.isNaN(Number(y))&&typeof y=="string"&&y.trim()!==""?y=Number(y):E.parseBooleans&&y!==null&&(y.toLowerCase()==="true"||y.toLowerCase()==="false")&&(y=y.toLowerCase()==="true"),y}function ne(y,E){E=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},E),p(E.arrayFormatSeparator);const m=v(E),w=Object.create(null);if(typeof y!="string"||(y=y.trim().replace(/^[?#&]/,""),!y))return w;for(const g of y.split("&")){if(g==="")continue;let[u,b]=s(E.decode?g.replace(/\+/g," "):g,"=");b=b===void 0?null:["comma","separator","bracket-separator"].includes(E.arrayFormat)?b:T(b,E),m(T(u,E),b,w)}for(const g of Object.keys(w)){const u=w[g];if(typeof u=="object"&&u!==null)for(const b of Object.keys(u))u[b]=M(u[b],E);else w[g]=M(u,E)}return E.sort===!1?w:(E.sort===!0?Object.keys(w).sort():Object.keys(w).sort(E.sort)).reduce((g,u)=>{const b=w[u];return b&&typeof b=="object"&&!Array.isArray(b)?g[u]=x(b):g[u]=b,g},Object.create(null))}n.extract=z,n.parse=ne,n.stringify=(y,E)=>{if(!y)return"";E=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},E),p(E.arrayFormatSeparator);const m=b=>E.skipNull&&c(y[b])||E.skipEmptyString&&y[b]==="",w=f(E),g={};for(const b of Object.keys(y))m(b)||(g[b]=y[b]);const u=Object.keys(g);return E.sort!==!1&&u.sort(E.sort),u.map(b=>{const K=y[b];return K===void 0?"":K===null?S(b,E):Array.isArray(K)?K.length===0&&E.arrayFormat==="bracket-separator"?S(b,E)+"[]":K.reduce(w(b),[]).join("&"):S(b,E)+"="+S(K,E)}).filter(b=>b.length>0).join("&")},n.parseUrl=(y,E)=>{E=Object.assign({decode:!0},E);const[m,w]=s(y,"#");return Object.assign({url:m.split("?")[0]||"",query:ne(z(y),E)},E&&E.parseFragmentIdentifier&&w?{fragmentIdentifier:T(w,E)}:{})},n.stringifyUrl=(y,E)=>{E=Object.assign({encode:!0,strict:!0,[l]:!0},E);const m=A(y.url).split("?")[0]||"",w=n.extract(y.url),g=n.parse(w,{sort:!1}),u=Object.assign(g,y.query);let b=n.stringify(u,E);b&&(b=`?${b}`);let K=U(y.url);return y.fragmentIdentifier&&(K=`#${E[l]?S(y.fragmentIdentifier,E):y.fragmentIdentifier}`),`${m}${b}${K}`},n.pick=(y,E,m)=>{m=Object.assign({parseFragmentIdentifier:!0,[l]:!1},m);const{url:w,query:g,fragmentIdentifier:u}=n.parseUrl(y,m);return n.stringifyUrl({url:w,query:o(g,E),fragmentIdentifier:u},m)},n.exclude=(y,E,m)=>{const w=Array.isArray(E)?g=>!E.includes(g):(g,u)=>!E(g,u);return n.pick(y,w,m)}})(r5);function su(n=[],e=[]){return[...new Set([...n,...e])]}function _h(n){return n.includes(":")}function vs(n){return _h(n)?n.split(":")[0]:n}const n5={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function kd(n,e){const{message:t,code:s}=n5[n];return{message:e?`${t} ${e}`:t,code:s}}function Gd(n,e){return Array.isArray(n)?typeof e<"u"&&n.length?n.every(e):!0:!1}function i5(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}const s5={Accept:"application/json","Content-Type":"application/json"},o5="POST",Wd={headers:s5,method:o5},Yd=10;class ui{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new Mr.EventEmitter,this.isAvailable=!1,this.registering=!1,!nd(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const s=xs(e),c=await(await bf(this.url,Object.assign(Object.assign({},Wd),{body:s}))).json();this.onPayload({data:c})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!nd(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=xs({id:1,jsonrpc:"2.0",method:"test",params:[]});await bf(e,Object.assign(Object.assign({},Wd),{body:t}))}this.onOpen()}catch(t){const s=this.parseError(t);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Bu(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=la(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return jp(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Yd&&this.events.setMaxListeners(Yd)}}const Jd="error",a5="wss://relay.walletconnect.com",c5="wc",u5="universal_provider",Qd=`${c5}@2:${u5}:`,h5="https://rpc.walletconnect.com/v1",jn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var _s=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ju={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,e){(function(){var t,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",f="Invalid `variable` option passed into `_.template`",v="__lodash_hash_undefined__",p=500,S="__lodash_placeholder__",T=1,x=2,A=4,U=1,z=2,M=1,ne=2,y=4,E=8,m=16,w=32,g=64,u=128,b=256,K=512,k=30,oe="...",ce=800,ge=16,D=1,B=2,le=3,te=1/0,W=9007199254740991,ee=17976931348623157e292,Y=0/0,re=4294967295,xe=re-1,ie=re>>>1,be=[["ary",u],["bind",M],["bindKey",ne],["curry",E],["curryRight",m],["flip",K],["partial",w],["partialRight",g],["rearg",b]],he="[object Arguments]",ve="[object Array]",H="[object AsyncFunction]",q="[object Boolean]",$="[object Date]",d="[object DOMException]",C="[object Error]",se="[object Function]",fe="[object GeneratorFunction]",Ie="[object Map]",ze="[object Number]",Ve="[object Null]",Le="[object Object]",yt="[object Promise]",_t="[object Proxy]",Me="[object RegExp]",Oe="[object Set]",$e="[object String]",Ue="[object Symbol]",qe="[object Undefined]",Te="[object WeakMap]",De="[object WeakSet]",Se="[object ArrayBuffer]",Ae="[object DataView]",Be="[object Float32Array]",Pe="[object Float64Array]",ke="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",tr="[object Uint16Array]",hr="[object Uint32Array]",Yr=/\b__p \+= '';/g,rr=/\b(__p \+=) '' \+/g,sn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,En=/&(?:amp|lt|gt|quot|#39);/g,Mn=/[&<>"']/g,St=RegExp(En.source),vt=RegExp(Mn.source),It=/<%-([\s\S]+?)%>/g,Ot=/<%([\s\S]+?)%>/g,wt=/<%=([\s\S]+?)%>/g,mt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dt=/^\w*$/,Ft=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,xt=/[\\^$.*+?()[\]{}|]/g,Lt=RegExp(xt.source),Pt=/^\s+/,Nt=/\s/,Tt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,jt=/,? & /,Mt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ya=/[()=,{}\[\]\/\s]/,_a=/\\(\\)?/g,va=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Pr=/\w*$/,ma=/^[-+]0x[0-9a-f]+$/i,ba=/^0b[01]+$/i,wa=/^\[object .+?Constructor\]$/,Ea=/^0o[0-7]+$/i,Sa=/^(?:0|[1-9]\d*)$/,on=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,hi=/($^)/,Ia=/['\n\r\u2028\u2029\\]/g,li="\\ud800-\\udfff",Oa="\\u0300-\\u036f",xa="\\ufe20-\\ufe2f",fi="\\u20d0-\\u20ff",js=Oa+xa+fi,Ms="\\u2700-\\u27bf",qr="a-z\\xdf-\\xf6\\xf8-\\xff",Pa="\\xac\\xb1\\xd7\\xf7",Ta="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Aa="\\u2000-\\u206f",Na=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",qs="A-Z\\xc0-\\xd6\\xd8-\\xde",Hs="\\ufe0e\\ufe0f",qn=Pa+Ta+Aa+Na,Hi="[']",Hn="["+li+"]",zi="["+qn+"]",zn="["+js+"]",zs="\\d+",Ca="["+Ms+"]",Bs="["+qr+"]",Ks="[^"+li+qn+zs+Ms+qr+qs+"]",di="\\ud83c[\\udffb-\\udfff]",Ra="(?:"+zn+"|"+di+")",Vs="[^"+li+"]",pi="(?:\\ud83c[\\udde6-\\uddff]){2}",Sn="[\\ud800-\\udbff][\\udc00-\\udfff]",vr="["+qs+"]",ks="\\u200d",Gs="(?:"+Bs+"|"+Ks+")",Jr="(?:"+vr+"|"+Ks+")",Ws="(?:"+Hi+"(?:d|ll|m|re|s|t|ve))?",Ys="(?:"+Hi+"(?:D|LL|M|RE|S|T|VE))?",Js=Ra+"?",Qs="["+Hs+"]?",$a="(?:"+ks+"(?:"+[Vs,pi,Sn].join("|")+")"+Qs+Js+")*",an="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Xs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Zs=Qs+Js+$a,gi="(?:"+[Ca,pi,Sn].join("|")+")"+Zs,Ua="(?:"+[Vs+zn+"?",zn,pi,Sn,Hn].join("|")+")",Bi=RegExp(Hi,"g"),Da=RegExp(zn,"g"),yi=RegExp(di+"(?="+di+")|"+Ua+Zs,"g"),eo=RegExp([vr+"?"+Bs+"+"+Ws+"(?="+[zi,vr,"$"].join("|")+")",Jr+"+"+Ys+"(?="+[zi,vr+Gs,"$"].join("|")+")",vr+"?"+Gs+"+"+Ws,vr+"+"+Ys,Xs,an,zs,gi].join("|"),"g"),to=RegExp("["+ks+li+js+Hs+"]"),Bn=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ro=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Fa=-1,ot={};ot[Be]=ot[Pe]=ot[ke]=ot[We]=ot[et]=ot[tt]=ot[Je]=ot[tr]=ot[hr]=!0,ot[he]=ot[ve]=ot[Se]=ot[q]=ot[Ae]=ot[$]=ot[C]=ot[se]=ot[Ie]=ot[ze]=ot[Le]=ot[Me]=ot[Oe]=ot[$e]=ot[Te]=!1;var st={};st[he]=st[ve]=st[Se]=st[Ae]=st[q]=st[$]=st[Be]=st[Pe]=st[ke]=st[We]=st[et]=st[Ie]=st[ze]=st[Le]=st[Me]=st[Oe]=st[$e]=st[Ue]=st[tt]=st[Je]=st[tr]=st[hr]=!0,st[C]=st[se]=st[Te]=!1;var P={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},F={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},X={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},de={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,Ce=parseInt,pt=typeof _s=="object"&&_s&&_s.Object===Object&&_s,qt=typeof self=="object"&&self&&self.Object===Object&&self,Qe=pt||qt||Function("return this")(),ct=e&&!e.nodeType&&e,Ct=ct&&!0&&n&&!n.nodeType&&n,lr=Ct&&Ct.exports===ct,Ht=lr&&pt.process,gt=function(){try{var L=Ct&&Ct.require&&Ct.require("util").types;return L||Ht&&Ht.binding&&Ht.binding("util")}catch{}}(),nr=gt&&gt.isArrayBuffer,Hr=gt&&gt.isDate,Tr=gt&&gt.isMap,Qr=gt&&gt.isRegExp,Ki=gt&&gt.isSet,Kn=gt&&gt.isTypedArray;function Vt(L,G,V){switch(V.length){case 0:return L.call(G);case 1:return L.call(G,V[0]);case 2:return L.call(G,V[0],V[1]);case 3:return L.call(G,V[0],V[1],V[2])}return L.apply(G,V)}function Tg(L,G,V,pe){for(var Ne=-1,rt=L==null?0:L.length;++Ne<rt;){var Bt=L[Ne];G(pe,Bt,V(Bt),L)}return pe}function Ar(L,G){for(var V=-1,pe=L==null?0:L.length;++V<pe&&G(L[V],V,L)!==!1;);return L}function Ag(L,G){for(var V=L==null?0:L.length;V--&&G(L[V],V,L)!==!1;);return L}function bh(L,G){for(var V=-1,pe=L==null?0:L.length;++V<pe;)if(!G(L[V],V,L))return!1;return!0}function In(L,G){for(var V=-1,pe=L==null?0:L.length,Ne=0,rt=[];++V<pe;){var Bt=L[V];G(Bt,V,L)&&(rt[Ne++]=Bt)}return rt}function no(L,G){var V=L==null?0:L.length;return!!V&&_i(L,G,0)>-1}function La(L,G,V){for(var pe=-1,Ne=L==null?0:L.length;++pe<Ne;)if(V(G,L[pe]))return!0;return!1}function bt(L,G){for(var V=-1,pe=L==null?0:L.length,Ne=Array(pe);++V<pe;)Ne[V]=G(L[V],V,L);return Ne}function On(L,G){for(var V=-1,pe=G.length,Ne=L.length;++V<pe;)L[Ne+V]=G[V];return L}function ja(L,G,V,pe){var Ne=-1,rt=L==null?0:L.length;for(pe&&rt&&(V=L[++Ne]);++Ne<rt;)V=G(V,L[Ne],Ne,L);return V}function Ng(L,G,V,pe){var Ne=L==null?0:L.length;for(pe&&Ne&&(V=L[--Ne]);Ne--;)V=G(V,L[Ne],Ne,L);return V}function Ma(L,G){for(var V=-1,pe=L==null?0:L.length;++V<pe;)if(G(L[V],V,L))return!0;return!1}var Cg=qa("length");function Rg(L){return L.split("")}function $g(L){return L.match(Mt)||[]}function wh(L,G,V){var pe;return V(L,function(Ne,rt,Bt){if(G(Ne,rt,Bt))return pe=rt,!1}),pe}function io(L,G,V,pe){for(var Ne=L.length,rt=V+(pe?1:-1);pe?rt--:++rt<Ne;)if(G(L[rt],rt,L))return rt;return-1}function _i(L,G,V){return G===G?Vg(L,G,V):io(L,Eh,V)}function Ug(L,G,V,pe){for(var Ne=V-1,rt=L.length;++Ne<rt;)if(pe(L[Ne],G))return Ne;return-1}function Eh(L){return L!==L}function Sh(L,G){var V=L==null?0:L.length;return V?za(L,G)/V:Y}function qa(L){return function(G){return G==null?t:G[L]}}function Ha(L){return function(G){return L==null?t:L[G]}}function Ih(L,G,V,pe,Ne){return Ne(L,function(rt,Bt,ut){V=pe?(pe=!1,rt):G(V,rt,Bt,ut)}),V}function Dg(L,G){var V=L.length;for(L.sort(G);V--;)L[V]=L[V].value;return L}function za(L,G){for(var V,pe=-1,Ne=L.length;++pe<Ne;){var rt=G(L[pe]);rt!==t&&(V=V===t?rt:V+rt)}return V}function Ba(L,G){for(var V=-1,pe=Array(L);++V<L;)pe[V]=G(V);return pe}function Fg(L,G){return bt(G,function(V){return[V,L[V]]})}function Oh(L){return L&&L.slice(0,Ah(L)+1).replace(Pt,"")}function mr(L){return function(G){return L(G)}}function Ka(L,G){return bt(G,function(V){return L[V]})}function Vi(L,G){return L.has(G)}function xh(L,G){for(var V=-1,pe=L.length;++V<pe&&_i(G,L[V],0)>-1;);return V}function Ph(L,G){for(var V=L.length;V--&&_i(G,L[V],0)>-1;);return V}function Lg(L,G){for(var V=L.length,pe=0;V--;)L[V]===G&&++pe;return pe}var jg=Ha(P),Mg=Ha(F);function qg(L){return"\\"+de[L]}function Hg(L,G){return L==null?t:L[G]}function vi(L){return to.test(L)}function zg(L){return Bn.test(L)}function Bg(L){for(var G,V=[];!(G=L.next()).done;)V.push(G.value);return V}function Va(L){var G=-1,V=Array(L.size);return L.forEach(function(pe,Ne){V[++G]=[Ne,pe]}),V}function Th(L,G){return function(V){return L(G(V))}}function xn(L,G){for(var V=-1,pe=L.length,Ne=0,rt=[];++V<pe;){var Bt=L[V];(Bt===G||Bt===S)&&(L[V]=S,rt[Ne++]=V)}return rt}function so(L){var G=-1,V=Array(L.size);return L.forEach(function(pe){V[++G]=pe}),V}function Kg(L){var G=-1,V=Array(L.size);return L.forEach(function(pe){V[++G]=[pe,pe]}),V}function Vg(L,G,V){for(var pe=V-1,Ne=L.length;++pe<Ne;)if(L[pe]===G)return pe;return-1}function kg(L,G,V){for(var pe=V+1;pe--;)if(L[pe]===G)return pe;return pe}function mi(L){return vi(L)?Wg(L):Cg(L)}function zr(L){return vi(L)?Yg(L):Rg(L)}function Ah(L){for(var G=L.length;G--&&Nt.test(L.charAt(G)););return G}var Gg=Ha(X);function Wg(L){for(var G=yi.lastIndex=0;yi.test(L);)++G;return G}function Yg(L){return L.match(yi)||[]}function Jg(L){return L.match(eo)||[]}var Qg=function L(G){G=G==null?Qe:bi.defaults(Qe.Object(),G,bi.pick(Qe,ro));var V=G.Array,pe=G.Date,Ne=G.Error,rt=G.Function,Bt=G.Math,ut=G.Object,ka=G.RegExp,Xg=G.String,Nr=G.TypeError,oo=V.prototype,Zg=rt.prototype,wi=ut.prototype,ao=G["__core-js_shared__"],co=Zg.toString,it=wi.hasOwnProperty,e0=0,Nh=function(){var r=/[^.]+$/.exec(ao&&ao.keys&&ao.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),uo=wi.toString,t0=co.call(ut),r0=Qe._,n0=ka("^"+co.call(it).replace(xt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ho=lr?G.Buffer:t,Pn=G.Symbol,lo=G.Uint8Array,Ch=ho?ho.allocUnsafe:t,fo=Th(ut.getPrototypeOf,ut),Rh=ut.create,$h=wi.propertyIsEnumerable,po=oo.splice,Uh=Pn?Pn.isConcatSpreadable:t,ki=Pn?Pn.iterator:t,Vn=Pn?Pn.toStringTag:t,go=function(){try{var r=Jn(ut,"defineProperty");return r({},"",{}),r}catch{}}(),i0=G.clearTimeout!==Qe.clearTimeout&&G.clearTimeout,s0=pe&&pe.now!==Qe.Date.now&&pe.now,o0=G.setTimeout!==Qe.setTimeout&&G.setTimeout,yo=Bt.ceil,_o=Bt.floor,Ga=ut.getOwnPropertySymbols,a0=ho?ho.isBuffer:t,Dh=G.isFinite,c0=oo.join,u0=Th(ut.keys,ut),Kt=Bt.max,Qt=Bt.min,h0=pe.now,l0=G.parseInt,Fh=Bt.random,f0=oo.reverse,Wa=Jn(G,"DataView"),Gi=Jn(G,"Map"),Ya=Jn(G,"Promise"),Ei=Jn(G,"Set"),Wi=Jn(G,"WeakMap"),Yi=Jn(ut,"create"),vo=Wi&&new Wi,Si={},d0=Qn(Wa),p0=Qn(Gi),g0=Qn(Ya),y0=Qn(Ei),_0=Qn(Wi),mo=Pn?Pn.prototype:t,Ji=mo?mo.valueOf:t,Lh=mo?mo.toString:t;function I(r){if(At(r)&&!Re(r)&&!(r instanceof Ye)){if(r instanceof Cr)return r;if(it.call(r,"__wrapped__"))return jl(r)}return new Cr(r)}var Ii=function(){function r(){}return function(i){if(!Et(i))return{};if(Rh)return Rh(i);r.prototype=i;var a=new r;return r.prototype=t,a}}();function bo(){}function Cr(r,i){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=t}I.templateSettings={escape:It,evaluate:Ot,interpolate:wt,variable:"",imports:{_:I}},I.prototype=bo.prototype,I.prototype.constructor=I,Cr.prototype=Ii(bo.prototype),Cr.prototype.constructor=Cr;function Ye(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function v0(){var r=new Ye(this.__wrapped__);return r.__actions__=fr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=fr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=fr(this.__views__),r}function m0(){if(this.__filtered__){var r=new Ye(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function b0(){var r=this.__wrapped__.value(),i=this.__dir__,a=Re(r),h=i<0,_=a?r.length:0,O=Ry(0,_,this.__views__),N=O.start,R=O.end,j=R-N,J=h?R:N-1,Q=this.__iteratees__,Z=Q.length,ae=0,ye=Qt(j,this.__takeCount__);if(!a||!h&&_==j&&ye==j)return al(r,this.__actions__);var we=[];e:for(;j--&&ae<ye;){J+=i;for(var He=-1,Ee=r[J];++He<Z;){var Ge=Q[He],Xe=Ge.iteratee,Er=Ge.type,or=Xe(Ee);if(Er==B)Ee=or;else if(!or){if(Er==D)continue e;break e}}we[ae++]=Ee}return we}Ye.prototype=Ii(bo.prototype),Ye.prototype.constructor=Ye;function kn(r){var i=-1,a=r==null?0:r.length;for(this.clear();++i<a;){var h=r[i];this.set(h[0],h[1])}}function w0(){this.__data__=Yi?Yi(null):{},this.size=0}function E0(r){var i=this.has(r)&&delete this.__data__[r];return this.size-=i?1:0,i}function S0(r){var i=this.__data__;if(Yi){var a=i[r];return a===v?t:a}return it.call(i,r)?i[r]:t}function I0(r){var i=this.__data__;return Yi?i[r]!==t:it.call(i,r)}function O0(r,i){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=Yi&&i===t?v:i,this}kn.prototype.clear=w0,kn.prototype.delete=E0,kn.prototype.get=S0,kn.prototype.has=I0,kn.prototype.set=O0;function cn(r){var i=-1,a=r==null?0:r.length;for(this.clear();++i<a;){var h=r[i];this.set(h[0],h[1])}}function x0(){this.__data__=[],this.size=0}function P0(r){var i=this.__data__,a=wo(i,r);if(a<0)return!1;var h=i.length-1;return a==h?i.pop():po.call(i,a,1),--this.size,!0}function T0(r){var i=this.__data__,a=wo(i,r);return a<0?t:i[a][1]}function A0(r){return wo(this.__data__,r)>-1}function N0(r,i){var a=this.__data__,h=wo(a,r);return h<0?(++this.size,a.push([r,i])):a[h][1]=i,this}cn.prototype.clear=x0,cn.prototype.delete=P0,cn.prototype.get=T0,cn.prototype.has=A0,cn.prototype.set=N0;function un(r){var i=-1,a=r==null?0:r.length;for(this.clear();++i<a;){var h=r[i];this.set(h[0],h[1])}}function C0(){this.size=0,this.__data__={hash:new kn,map:new(Gi||cn),string:new kn}}function R0(r){var i=$o(this,r).delete(r);return this.size-=i?1:0,i}function $0(r){return $o(this,r).get(r)}function U0(r){return $o(this,r).has(r)}function D0(r,i){var a=$o(this,r),h=a.size;return a.set(r,i),this.size+=a.size==h?0:1,this}un.prototype.clear=C0,un.prototype.delete=R0,un.prototype.get=$0,un.prototype.has=U0,un.prototype.set=D0;function Gn(r){var i=-1,a=r==null?0:r.length;for(this.__data__=new un;++i<a;)this.add(r[i])}function F0(r){return this.__data__.set(r,v),this}function L0(r){return this.__data__.has(r)}Gn.prototype.add=Gn.prototype.push=F0,Gn.prototype.has=L0;function Br(r){var i=this.__data__=new cn(r);this.size=i.size}function j0(){this.__data__=new cn,this.size=0}function M0(r){var i=this.__data__,a=i.delete(r);return this.size=i.size,a}function q0(r){return this.__data__.get(r)}function H0(r){return this.__data__.has(r)}function z0(r,i){var a=this.__data__;if(a instanceof cn){var h=a.__data__;if(!Gi||h.length<o-1)return h.push([r,i]),this.size=++a.size,this;a=this.__data__=new un(h)}return a.set(r,i),this.size=a.size,this}Br.prototype.clear=j0,Br.prototype.delete=M0,Br.prototype.get=q0,Br.prototype.has=H0,Br.prototype.set=z0;function jh(r,i){var a=Re(r),h=!a&&Xn(r),_=!a&&!h&&Rn(r),O=!a&&!h&&!_&&Ti(r),N=a||h||_||O,R=N?Ba(r.length,Xg):[],j=R.length;for(var J in r)(i||it.call(r,J))&&!(N&&(J=="length"||_&&(J=="offset"||J=="parent")||O&&(J=="buffer"||J=="byteLength"||J=="byteOffset")||dn(J,j)))&&R.push(J);return R}function Mh(r){var i=r.length;return i?r[oc(0,i-1)]:t}function B0(r,i){return Uo(fr(r),Wn(i,0,r.length))}function K0(r){return Uo(fr(r))}function Ja(r,i,a){(a!==t&&!Kr(r[i],a)||a===t&&!(i in r))&&hn(r,i,a)}function Qi(r,i,a){var h=r[i];(!(it.call(r,i)&&Kr(h,a))||a===t&&!(i in r))&&hn(r,i,a)}function wo(r,i){for(var a=r.length;a--;)if(Kr(r[a][0],i))return a;return-1}function V0(r,i,a,h){return Tn(r,function(_,O,N){i(h,_,a(_),N)}),h}function qh(r,i){return r&&Zr(i,kt(i),r)}function k0(r,i){return r&&Zr(i,pr(i),r)}function hn(r,i,a){i=="__proto__"&&go?go(r,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[i]=a}function Qa(r,i){for(var a=-1,h=i.length,_=V(h),O=r==null;++a<h;)_[a]=O?t:Cc(r,i[a]);return _}function Wn(r,i,a){return r===r&&(a!==t&&(r=r<=a?r:a),i!==t&&(r=r>=i?r:i)),r}function Rr(r,i,a,h,_,O){var N,R=i&T,j=i&x,J=i&A;if(a&&(N=_?a(r,h,_,O):a(r)),N!==t)return N;if(!Et(r))return r;var Q=Re(r);if(Q){if(N=Uy(r),!R)return fr(r,N)}else{var Z=Xt(r),ae=Z==se||Z==fe;if(Rn(r))return hl(r,R);if(Z==Le||Z==he||ae&&!_){if(N=j||ae?{}:Al(r),!R)return j?Sy(r,k0(N,r)):Ey(r,qh(N,r))}else{if(!st[Z])return _?r:{};N=Dy(r,Z,R)}}O||(O=new Br);var ye=O.get(r);if(ye)return ye;O.set(r,N),sf(r)?r.forEach(function(Ee){N.add(Rr(Ee,i,a,Ee,r,O))}):rf(r)&&r.forEach(function(Ee,Ge){N.set(Ge,Rr(Ee,i,a,Ge,r,O))});var we=J?j?_c:yc:j?pr:kt,He=Q?t:we(r);return Ar(He||r,function(Ee,Ge){He&&(Ge=Ee,Ee=r[Ge]),Qi(N,Ge,Rr(Ee,i,a,Ge,r,O))}),N}function G0(r){var i=kt(r);return function(a){return Hh(a,r,i)}}function Hh(r,i,a){var h=a.length;if(r==null)return!h;for(r=ut(r);h--;){var _=a[h],O=i[_],N=r[_];if(N===t&&!(_ in r)||!O(N))return!1}return!0}function zh(r,i,a){if(typeof r!="function")throw new Nr(l);return is(function(){r.apply(t,a)},i)}function Xi(r,i,a,h){var _=-1,O=no,N=!0,R=r.length,j=[],J=i.length;if(!R)return j;a&&(i=bt(i,mr(a))),h?(O=La,N=!1):i.length>=o&&(O=Vi,N=!1,i=new Gn(i));e:for(;++_<R;){var Q=r[_],Z=a==null?Q:a(Q);if(Q=h||Q!==0?Q:0,N&&Z===Z){for(var ae=J;ae--;)if(i[ae]===Z)continue e;j.push(Q)}else O(i,Z,h)||j.push(Q)}return j}var Tn=gl(Xr),Bh=gl(Za,!0);function W0(r,i){var a=!0;return Tn(r,function(h,_,O){return a=!!i(h,_,O),a}),a}function Eo(r,i,a){for(var h=-1,_=r.length;++h<_;){var O=r[h],N=i(O);if(N!=null&&(R===t?N===N&&!wr(N):a(N,R)))var R=N,j=O}return j}function Y0(r,i,a,h){var _=r.length;for(a=je(a),a<0&&(a=-a>_?0:_+a),h=h===t||h>_?_:je(h),h<0&&(h+=_),h=a>h?0:af(h);a<h;)r[a++]=i;return r}function Kh(r,i){var a=[];return Tn(r,function(h,_,O){i(h,_,O)&&a.push(h)}),a}function Yt(r,i,a,h,_){var O=-1,N=r.length;for(a||(a=Ly),_||(_=[]);++O<N;){var R=r[O];i>0&&a(R)?i>1?Yt(R,i-1,a,h,_):On(_,R):h||(_[_.length]=R)}return _}var Xa=yl(),Vh=yl(!0);function Xr(r,i){return r&&Xa(r,i,kt)}function Za(r,i){return r&&Vh(r,i,kt)}function So(r,i){return In(i,function(a){return pn(r[a])})}function Yn(r,i){i=Nn(i,r);for(var a=0,h=i.length;r!=null&&a<h;)r=r[en(i[a++])];return a&&a==h?r:t}function kh(r,i,a){var h=i(r);return Re(r)?h:On(h,a(r))}function ir(r){return r==null?r===t?qe:Ve:Vn&&Vn in ut(r)?Cy(r):Ky(r)}function ec(r,i){return r>i}function J0(r,i){return r!=null&&it.call(r,i)}function Q0(r,i){return r!=null&&i in ut(r)}function X0(r,i,a){return r>=Qt(i,a)&&r<Kt(i,a)}function tc(r,i,a){for(var h=a?La:no,_=r[0].length,O=r.length,N=O,R=V(O),j=1/0,J=[];N--;){var Q=r[N];N&&i&&(Q=bt(Q,mr(i))),j=Qt(Q.length,j),R[N]=!a&&(i||_>=120&&Q.length>=120)?new Gn(N&&Q):t}Q=r[0];var Z=-1,ae=R[0];e:for(;++Z<_&&J.length<j;){var ye=Q[Z],we=i?i(ye):ye;if(ye=a||ye!==0?ye:0,!(ae?Vi(ae,we):h(J,we,a))){for(N=O;--N;){var He=R[N];if(!(He?Vi(He,we):h(r[N],we,a)))continue e}ae&&ae.push(we),J.push(ye)}}return J}function Z0(r,i,a,h){return Xr(r,function(_,O,N){i(h,a(_),O,N)}),h}function Zi(r,i,a){i=Nn(i,r),r=$l(r,i);var h=r==null?r:r[en(Ur(i))];return h==null?t:Vt(h,r,a)}function Gh(r){return At(r)&&ir(r)==he}function ey(r){return At(r)&&ir(r)==Se}function ty(r){return At(r)&&ir(r)==$}function es(r,i,a,h,_){return r===i?!0:r==null||i==null||!At(r)&&!At(i)?r!==r&&i!==i:ry(r,i,a,h,es,_)}function ry(r,i,a,h,_,O){var N=Re(r),R=Re(i),j=N?ve:Xt(r),J=R?ve:Xt(i);j=j==he?Le:j,J=J==he?Le:J;var Q=j==Le,Z=J==Le,ae=j==J;if(ae&&Rn(r)){if(!Rn(i))return!1;N=!0,Q=!1}if(ae&&!Q)return O||(O=new Br),N||Ti(r)?xl(r,i,a,h,_,O):Ay(r,i,j,a,h,_,O);if(!(a&U)){var ye=Q&&it.call(r,"__wrapped__"),we=Z&&it.call(i,"__wrapped__");if(ye||we){var He=ye?r.value():r,Ee=we?i.value():i;return O||(O=new Br),_(He,Ee,a,h,O)}}return ae?(O||(O=new Br),Ny(r,i,a,h,_,O)):!1}function ny(r){return At(r)&&Xt(r)==Ie}function rc(r,i,a,h){var _=a.length,O=_,N=!h;if(r==null)return!O;for(r=ut(r);_--;){var R=a[_];if(N&&R[2]?R[1]!==r[R[0]]:!(R[0]in r))return!1}for(;++_<O;){R=a[_];var j=R[0],J=r[j],Q=R[1];if(N&&R[2]){if(J===t&&!(j in r))return!1}else{var Z=new Br;if(h)var ae=h(J,Q,j,r,i,Z);if(!(ae===t?es(Q,J,U|z,h,Z):ae))return!1}}return!0}function Wh(r){if(!Et(r)||My(r))return!1;var i=pn(r)?n0:wa;return i.test(Qn(r))}function iy(r){return At(r)&&ir(r)==Me}function sy(r){return At(r)&&Xt(r)==Oe}function oy(r){return At(r)&&qo(r.length)&&!!ot[ir(r)]}function Yh(r){return typeof r=="function"?r:r==null?gr:typeof r=="object"?Re(r)?Xh(r[0],r[1]):Qh(r):vf(r)}function nc(r){if(!ns(r))return u0(r);var i=[];for(var a in ut(r))it.call(r,a)&&a!="constructor"&&i.push(a);return i}function ay(r){if(!Et(r))return By(r);var i=ns(r),a=[];for(var h in r)h=="constructor"&&(i||!it.call(r,h))||a.push(h);return a}function ic(r,i){return r<i}function Jh(r,i){var a=-1,h=dr(r)?V(r.length):[];return Tn(r,function(_,O,N){h[++a]=i(_,O,N)}),h}function Qh(r){var i=mc(r);return i.length==1&&i[0][2]?Cl(i[0][0],i[0][1]):function(a){return a===r||rc(a,r,i)}}function Xh(r,i){return wc(r)&&Nl(i)?Cl(en(r),i):function(a){var h=Cc(a,r);return h===t&&h===i?Rc(a,r):es(i,h,U|z)}}function Io(r,i,a,h,_){r!==i&&Xa(i,function(O,N){if(_||(_=new Br),Et(O))cy(r,i,N,a,Io,h,_);else{var R=h?h(Sc(r,N),O,N+"",r,i,_):t;R===t&&(R=O),Ja(r,N,R)}},pr)}function cy(r,i,a,h,_,O,N){var R=Sc(r,a),j=Sc(i,a),J=N.get(j);if(J){Ja(r,a,J);return}var Q=O?O(R,j,a+"",r,i,N):t,Z=Q===t;if(Z){var ae=Re(j),ye=!ae&&Rn(j),we=!ae&&!ye&&Ti(j);Q=j,ae||ye||we?Re(R)?Q=R:Rt(R)?Q=fr(R):ye?(Z=!1,Q=hl(j,!0)):we?(Z=!1,Q=ll(j,!0)):Q=[]:ss(j)||Xn(j)?(Q=R,Xn(R)?Q=cf(R):(!Et(R)||pn(R))&&(Q=Al(j))):Z=!1}Z&&(N.set(j,Q),_(Q,j,h,O,N),N.delete(j)),Ja(r,a,Q)}function Zh(r,i){var a=r.length;if(a)return i+=i<0?a:0,dn(i,a)?r[i]:t}function el(r,i,a){i.length?i=bt(i,function(O){return Re(O)?function(N){return Yn(N,O.length===1?O[0]:O)}:O}):i=[gr];var h=-1;i=bt(i,mr(me()));var _=Jh(r,function(O,N,R){var j=bt(i,function(J){return J(O)});return{criteria:j,index:++h,value:O}});return Dg(_,function(O,N){return wy(O,N,a)})}function uy(r,i){return tl(r,i,function(a,h){return Rc(r,h)})}function tl(r,i,a){for(var h=-1,_=i.length,O={};++h<_;){var N=i[h],R=Yn(r,N);a(R,N)&&ts(O,Nn(N,r),R)}return O}function hy(r){return function(i){return Yn(i,r)}}function sc(r,i,a,h){var _=h?Ug:_i,O=-1,N=i.length,R=r;for(r===i&&(i=fr(i)),a&&(R=bt(r,mr(a)));++O<N;)for(var j=0,J=i[O],Q=a?a(J):J;(j=_(R,Q,j,h))>-1;)R!==r&&po.call(R,j,1),po.call(r,j,1);return r}function rl(r,i){for(var a=r?i.length:0,h=a-1;a--;){var _=i[a];if(a==h||_!==O){var O=_;dn(_)?po.call(r,_,1):uc(r,_)}}return r}function oc(r,i){return r+_o(Fh()*(i-r+1))}function ly(r,i,a,h){for(var _=-1,O=Kt(yo((i-r)/(a||1)),0),N=V(O);O--;)N[h?O:++_]=r,r+=a;return N}function ac(r,i){var a="";if(!r||i<1||i>W)return a;do i%2&&(a+=r),i=_o(i/2),i&&(r+=r);while(i);return a}function Ke(r,i){return Ic(Rl(r,i,gr),r+"")}function fy(r){return Mh(Ai(r))}function dy(r,i){var a=Ai(r);return Uo(a,Wn(i,0,a.length))}function ts(r,i,a,h){if(!Et(r))return r;i=Nn(i,r);for(var _=-1,O=i.length,N=O-1,R=r;R!=null&&++_<O;){var j=en(i[_]),J=a;if(j==="__proto__"||j==="constructor"||j==="prototype")return r;if(_!=N){var Q=R[j];J=h?h(Q,j,R):t,J===t&&(J=Et(Q)?Q:dn(i[_+1])?[]:{})}Qi(R,j,J),R=R[j]}return r}var nl=vo?function(r,i){return vo.set(r,i),r}:gr,py=go?function(r,i){return go(r,"toString",{configurable:!0,enumerable:!1,value:Uc(i),writable:!0})}:gr;function gy(r){return Uo(Ai(r))}function $r(r,i,a){var h=-1,_=r.length;i<0&&(i=-i>_?0:_+i),a=a>_?_:a,a<0&&(a+=_),_=i>a?0:a-i>>>0,i>>>=0;for(var O=V(_);++h<_;)O[h]=r[h+i];return O}function yy(r,i){var a;return Tn(r,function(h,_,O){return a=i(h,_,O),!a}),!!a}function Oo(r,i,a){var h=0,_=r==null?h:r.length;if(typeof i=="number"&&i===i&&_<=ie){for(;h<_;){var O=h+_>>>1,N=r[O];N!==null&&!wr(N)&&(a?N<=i:N<i)?h=O+1:_=O}return _}return cc(r,i,gr,a)}function cc(r,i,a,h){var _=0,O=r==null?0:r.length;if(O===0)return 0;i=a(i);for(var N=i!==i,R=i===null,j=wr(i),J=i===t;_<O;){var Q=_o((_+O)/2),Z=a(r[Q]),ae=Z!==t,ye=Z===null,we=Z===Z,He=wr(Z);if(N)var Ee=h||we;else J?Ee=we&&(h||ae):R?Ee=we&&ae&&(h||!ye):j?Ee=we&&ae&&!ye&&(h||!He):ye||He?Ee=!1:Ee=h?Z<=i:Z<i;Ee?_=Q+1:O=Q}return Qt(O,xe)}function il(r,i){for(var a=-1,h=r.length,_=0,O=[];++a<h;){var N=r[a],R=i?i(N):N;if(!a||!Kr(R,j)){var j=R;O[_++]=N===0?0:N}}return O}function sl(r){return typeof r=="number"?r:wr(r)?Y:+r}function br(r){if(typeof r=="string")return r;if(Re(r))return bt(r,br)+"";if(wr(r))return Lh?Lh.call(r):"";var i=r+"";return i=="0"&&1/r==-te?"-0":i}function An(r,i,a){var h=-1,_=no,O=r.length,N=!0,R=[],j=R;if(a)N=!1,_=La;else if(O>=o){var J=i?null:Py(r);if(J)return so(J);N=!1,_=Vi,j=new Gn}else j=i?[]:R;e:for(;++h<O;){var Q=r[h],Z=i?i(Q):Q;if(Q=a||Q!==0?Q:0,N&&Z===Z){for(var ae=j.length;ae--;)if(j[ae]===Z)continue e;i&&j.push(Z),R.push(Q)}else _(j,Z,a)||(j!==R&&j.push(Z),R.push(Q))}return R}function uc(r,i){return i=Nn(i,r),r=$l(r,i),r==null||delete r[en(Ur(i))]}function ol(r,i,a,h){return ts(r,i,a(Yn(r,i)),h)}function xo(r,i,a,h){for(var _=r.length,O=h?_:-1;(h?O--:++O<_)&&i(r[O],O,r););return a?$r(r,h?0:O,h?O+1:_):$r(r,h?O+1:0,h?_:O)}function al(r,i){var a=r;return a instanceof Ye&&(a=a.value()),ja(i,function(h,_){return _.func.apply(_.thisArg,On([h],_.args))},a)}function hc(r,i,a){var h=r.length;if(h<2)return h?An(r[0]):[];for(var _=-1,O=V(h);++_<h;)for(var N=r[_],R=-1;++R<h;)R!=_&&(O[_]=Xi(O[_]||N,r[R],i,a));return An(Yt(O,1),i,a)}function cl(r,i,a){for(var h=-1,_=r.length,O=i.length,N={};++h<_;){var R=h<O?i[h]:t;a(N,r[h],R)}return N}function lc(r){return Rt(r)?r:[]}function fc(r){return typeof r=="function"?r:gr}function Nn(r,i){return Re(r)?r:wc(r,i)?[r]:Ll(nt(r))}var _y=Ke;function Cn(r,i,a){var h=r.length;return a=a===t?h:a,!i&&a>=h?r:$r(r,i,a)}var ul=i0||function(r){return Qe.clearTimeout(r)};function hl(r,i){if(i)return r.slice();var a=r.length,h=Ch?Ch(a):new r.constructor(a);return r.copy(h),h}function dc(r){var i=new r.constructor(r.byteLength);return new lo(i).set(new lo(r)),i}function vy(r,i){var a=i?dc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function my(r){var i=new r.constructor(r.source,Pr.exec(r));return i.lastIndex=r.lastIndex,i}function by(r){return Ji?ut(Ji.call(r)):{}}function ll(r,i){var a=i?dc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function fl(r,i){if(r!==i){var a=r!==t,h=r===null,_=r===r,O=wr(r),N=i!==t,R=i===null,j=i===i,J=wr(i);if(!R&&!J&&!O&&r>i||O&&N&&j&&!R&&!J||h&&N&&j||!a&&j||!_)return 1;if(!h&&!O&&!J&&r<i||J&&a&&_&&!h&&!O||R&&a&&_||!N&&_||!j)return-1}return 0}function wy(r,i,a){for(var h=-1,_=r.criteria,O=i.criteria,N=_.length,R=a.length;++h<N;){var j=fl(_[h],O[h]);if(j){if(h>=R)return j;var J=a[h];return j*(J=="desc"?-1:1)}}return r.index-i.index}function dl(r,i,a,h){for(var _=-1,O=r.length,N=a.length,R=-1,j=i.length,J=Kt(O-N,0),Q=V(j+J),Z=!h;++R<j;)Q[R]=i[R];for(;++_<N;)(Z||_<O)&&(Q[a[_]]=r[_]);for(;J--;)Q[R++]=r[_++];return Q}function pl(r,i,a,h){for(var _=-1,O=r.length,N=-1,R=a.length,j=-1,J=i.length,Q=Kt(O-R,0),Z=V(Q+J),ae=!h;++_<Q;)Z[_]=r[_];for(var ye=_;++j<J;)Z[ye+j]=i[j];for(;++N<R;)(ae||_<O)&&(Z[ye+a[N]]=r[_++]);return Z}function fr(r,i){var a=-1,h=r.length;for(i||(i=V(h));++a<h;)i[a]=r[a];return i}function Zr(r,i,a,h){var _=!a;a||(a={});for(var O=-1,N=i.length;++O<N;){var R=i[O],j=h?h(a[R],r[R],R,a,r):t;j===t&&(j=r[R]),_?hn(a,R,j):Qi(a,R,j)}return a}function Ey(r,i){return Zr(r,bc(r),i)}function Sy(r,i){return Zr(r,Pl(r),i)}function Po(r,i){return function(a,h){var _=Re(a)?Tg:V0,O=i?i():{};return _(a,r,me(h,2),O)}}function Oi(r){return Ke(function(i,a){var h=-1,_=a.length,O=_>1?a[_-1]:t,N=_>2?a[2]:t;for(O=r.length>3&&typeof O=="function"?(_--,O):t,N&&sr(a[0],a[1],N)&&(O=_<3?t:O,_=1),i=ut(i);++h<_;){var R=a[h];R&&r(i,R,h,O)}return i})}function gl(r,i){return function(a,h){if(a==null)return a;if(!dr(a))return r(a,h);for(var _=a.length,O=i?_:-1,N=ut(a);(i?O--:++O<_)&&h(N[O],O,N)!==!1;);return a}}function yl(r){return function(i,a,h){for(var _=-1,O=ut(i),N=h(i),R=N.length;R--;){var j=N[r?R:++_];if(a(O[j],j,O)===!1)break}return i}}function Iy(r,i,a){var h=i&M,_=rs(r);function O(){var N=this&&this!==Qe&&this instanceof O?_:r;return N.apply(h?a:this,arguments)}return O}function _l(r){return function(i){i=nt(i);var a=vi(i)?zr(i):t,h=a?a[0]:i.charAt(0),_=a?Cn(a,1).join(""):i.slice(1);return h[r]()+_}}function xi(r){return function(i){return ja(yf(gf(i).replace(Bi,"")),r,"")}}function rs(r){return function(){var i=arguments;switch(i.length){case 0:return new r;case 1:return new r(i[0]);case 2:return new r(i[0],i[1]);case 3:return new r(i[0],i[1],i[2]);case 4:return new r(i[0],i[1],i[2],i[3]);case 5:return new r(i[0],i[1],i[2],i[3],i[4]);case 6:return new r(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new r(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var a=Ii(r.prototype),h=r.apply(a,i);return Et(h)?h:a}}function Oy(r,i,a){var h=rs(r);function _(){for(var O=arguments.length,N=V(O),R=O,j=Pi(_);R--;)N[R]=arguments[R];var J=O<3&&N[0]!==j&&N[O-1]!==j?[]:xn(N,j);if(O-=J.length,O<a)return El(r,i,To,_.placeholder,t,N,J,t,t,a-O);var Q=this&&this!==Qe&&this instanceof _?h:r;return Vt(Q,this,N)}return _}function vl(r){return function(i,a,h){var _=ut(i);if(!dr(i)){var O=me(a,3);i=kt(i),a=function(R){return O(_[R],R,_)}}var N=r(i,a,h);return N>-1?_[O?i[N]:N]:t}}function ml(r){return fn(function(i){var a=i.length,h=a,_=Cr.prototype.thru;for(r&&i.reverse();h--;){var O=i[h];if(typeof O!="function")throw new Nr(l);if(_&&!N&&Ro(O)=="wrapper")var N=new Cr([],!0)}for(h=N?h:a;++h<a;){O=i[h];var R=Ro(O),j=R=="wrapper"?vc(O):t;j&&Ec(j[0])&&j[1]==(u|E|w|b)&&!j[4].length&&j[9]==1?N=N[Ro(j[0])].apply(N,j[3]):N=O.length==1&&Ec(O)?N[R]():N.thru(O)}return function(){var J=arguments,Q=J[0];if(N&&J.length==1&&Re(Q))return N.plant(Q).value();for(var Z=0,ae=a?i[Z].apply(this,J):Q;++Z<a;)ae=i[Z].call(this,ae);return ae}})}function To(r,i,a,h,_,O,N,R,j,J){var Q=i&u,Z=i&M,ae=i&ne,ye=i&(E|m),we=i&K,He=ae?t:rs(r);function Ee(){for(var Ge=arguments.length,Xe=V(Ge),Er=Ge;Er--;)Xe[Er]=arguments[Er];if(ye)var or=Pi(Ee),Sr=Lg(Xe,or);if(h&&(Xe=dl(Xe,h,_,ye)),O&&(Xe=pl(Xe,O,N,ye)),Ge-=Sr,ye&&Ge<J){var $t=xn(Xe,or);return El(r,i,To,Ee.placeholder,a,Xe,$t,R,j,J-Ge)}var Vr=Z?a:this,yn=ae?Vr[r]:r;return Ge=Xe.length,R?Xe=Vy(Xe,R):we&&Ge>1&&Xe.reverse(),Q&&j<Ge&&(Xe.length=j),this&&this!==Qe&&this instanceof Ee&&(yn=He||rs(yn)),yn.apply(Vr,Xe)}return Ee}function bl(r,i){return function(a,h){return Z0(a,r,i(h),{})}}function Ao(r,i){return function(a,h){var _;if(a===t&&h===t)return i;if(a!==t&&(_=a),h!==t){if(_===t)return h;typeof a=="string"||typeof h=="string"?(a=br(a),h=br(h)):(a=sl(a),h=sl(h)),_=r(a,h)}return _}}function pc(r){return fn(function(i){return i=bt(i,mr(me())),Ke(function(a){var h=this;return r(i,function(_){return Vt(_,h,a)})})})}function No(r,i){i=i===t?" ":br(i);var a=i.length;if(a<2)return a?ac(i,r):i;var h=ac(i,yo(r/mi(i)));return vi(i)?Cn(zr(h),0,r).join(""):h.slice(0,r)}function xy(r,i,a,h){var _=i&M,O=rs(r);function N(){for(var R=-1,j=arguments.length,J=-1,Q=h.length,Z=V(Q+j),ae=this&&this!==Qe&&this instanceof N?O:r;++J<Q;)Z[J]=h[J];for(;j--;)Z[J++]=arguments[++R];return Vt(ae,_?a:this,Z)}return N}function wl(r){return function(i,a,h){return h&&typeof h!="number"&&sr(i,a,h)&&(a=h=t),i=gn(i),a===t?(a=i,i=0):a=gn(a),h=h===t?i<a?1:-1:gn(h),ly(i,a,h,r)}}function Co(r){return function(i,a){return typeof i=="string"&&typeof a=="string"||(i=Dr(i),a=Dr(a)),r(i,a)}}function El(r,i,a,h,_,O,N,R,j,J){var Q=i&E,Z=Q?N:t,ae=Q?t:N,ye=Q?O:t,we=Q?t:O;i|=Q?w:g,i&=~(Q?g:w),i&y||(i&=~(M|ne));var He=[r,i,_,ye,Z,we,ae,R,j,J],Ee=a.apply(t,He);return Ec(r)&&Ul(Ee,He),Ee.placeholder=h,Dl(Ee,r,i)}function gc(r){var i=Bt[r];return function(a,h){if(a=Dr(a),h=h==null?0:Qt(je(h),292),h&&Dh(a)){var _=(nt(a)+"e").split("e"),O=i(_[0]+"e"+(+_[1]+h));return _=(nt(O)+"e").split("e"),+(_[0]+"e"+(+_[1]-h))}return i(a)}}var Py=Ei&&1/so(new Ei([,-0]))[1]==te?function(r){return new Ei(r)}:Lc;function Sl(r){return function(i){var a=Xt(i);return a==Ie?Va(i):a==Oe?Kg(i):Fg(i,r(i))}}function ln(r,i,a,h,_,O,N,R){var j=i&ne;if(!j&&typeof r!="function")throw new Nr(l);var J=h?h.length:0;if(J||(i&=~(w|g),h=_=t),N=N===t?N:Kt(je(N),0),R=R===t?R:je(R),J-=_?_.length:0,i&g){var Q=h,Z=_;h=_=t}var ae=j?t:vc(r),ye=[r,i,a,h,_,Q,Z,O,N,R];if(ae&&zy(ye,ae),r=ye[0],i=ye[1],a=ye[2],h=ye[3],_=ye[4],R=ye[9]=ye[9]===t?j?0:r.length:Kt(ye[9]-J,0),!R&&i&(E|m)&&(i&=~(E|m)),!i||i==M)var we=Iy(r,i,a);else i==E||i==m?we=Oy(r,i,R):(i==w||i==(M|w))&&!_.length?we=xy(r,i,a,h):we=To.apply(t,ye);var He=ae?nl:Ul;return Dl(He(we,ye),r,i)}function Il(r,i,a,h){return r===t||Kr(r,wi[a])&&!it.call(h,a)?i:r}function Ol(r,i,a,h,_,O){return Et(r)&&Et(i)&&(O.set(i,r),Io(r,i,t,Ol,O),O.delete(i)),r}function Ty(r){return ss(r)?t:r}function xl(r,i,a,h,_,O){var N=a&U,R=r.length,j=i.length;if(R!=j&&!(N&&j>R))return!1;var J=O.get(r),Q=O.get(i);if(J&&Q)return J==i&&Q==r;var Z=-1,ae=!0,ye=a&z?new Gn:t;for(O.set(r,i),O.set(i,r);++Z<R;){var we=r[Z],He=i[Z];if(h)var Ee=N?h(He,we,Z,i,r,O):h(we,He,Z,r,i,O);if(Ee!==t){if(Ee)continue;ae=!1;break}if(ye){if(!Ma(i,function(Ge,Xe){if(!Vi(ye,Xe)&&(we===Ge||_(we,Ge,a,h,O)))return ye.push(Xe)})){ae=!1;break}}else if(!(we===He||_(we,He,a,h,O))){ae=!1;break}}return O.delete(r),O.delete(i),ae}function Ay(r,i,a,h,_,O,N){switch(a){case Ae:if(r.byteLength!=i.byteLength||r.byteOffset!=i.byteOffset)return!1;r=r.buffer,i=i.buffer;case Se:return!(r.byteLength!=i.byteLength||!O(new lo(r),new lo(i)));case q:case $:case ze:return Kr(+r,+i);case C:return r.name==i.name&&r.message==i.message;case Me:case $e:return r==i+"";case Ie:var R=Va;case Oe:var j=h&U;if(R||(R=so),r.size!=i.size&&!j)return!1;var J=N.get(r);if(J)return J==i;h|=z,N.set(r,i);var Q=xl(R(r),R(i),h,_,O,N);return N.delete(r),Q;case Ue:if(Ji)return Ji.call(r)==Ji.call(i)}return!1}function Ny(r,i,a,h,_,O){var N=a&U,R=yc(r),j=R.length,J=yc(i),Q=J.length;if(j!=Q&&!N)return!1;for(var Z=j;Z--;){var ae=R[Z];if(!(N?ae in i:it.call(i,ae)))return!1}var ye=O.get(r),we=O.get(i);if(ye&&we)return ye==i&&we==r;var He=!0;O.set(r,i),O.set(i,r);for(var Ee=N;++Z<j;){ae=R[Z];var Ge=r[ae],Xe=i[ae];if(h)var Er=N?h(Xe,Ge,ae,i,r,O):h(Ge,Xe,ae,r,i,O);if(!(Er===t?Ge===Xe||_(Ge,Xe,a,h,O):Er)){He=!1;break}Ee||(Ee=ae=="constructor")}if(He&&!Ee){var or=r.constructor,Sr=i.constructor;or!=Sr&&"constructor"in r&&"constructor"in i&&!(typeof or=="function"&&or instanceof or&&typeof Sr=="function"&&Sr instanceof Sr)&&(He=!1)}return O.delete(r),O.delete(i),He}function fn(r){return Ic(Rl(r,t,Hl),r+"")}function yc(r){return kh(r,kt,bc)}function _c(r){return kh(r,pr,Pl)}var vc=vo?function(r){return vo.get(r)}:Lc;function Ro(r){for(var i=r.name+"",a=Si[i],h=it.call(Si,i)?a.length:0;h--;){var _=a[h],O=_.func;if(O==null||O==r)return _.name}return i}function Pi(r){var i=it.call(I,"placeholder")?I:r;return i.placeholder}function me(){var r=I.iteratee||Dc;return r=r===Dc?Yh:r,arguments.length?r(arguments[0],arguments[1]):r}function $o(r,i){var a=r.__data__;return jy(i)?a[typeof i=="string"?"string":"hash"]:a.map}function mc(r){for(var i=kt(r),a=i.length;a--;){var h=i[a],_=r[h];i[a]=[h,_,Nl(_)]}return i}function Jn(r,i){var a=Hg(r,i);return Wh(a)?a:t}function Cy(r){var i=it.call(r,Vn),a=r[Vn];try{r[Vn]=t;var h=!0}catch{}var _=uo.call(r);return h&&(i?r[Vn]=a:delete r[Vn]),_}var bc=Ga?function(r){return r==null?[]:(r=ut(r),In(Ga(r),function(i){return $h.call(r,i)}))}:jc,Pl=Ga?function(r){for(var i=[];r;)On(i,bc(r)),r=fo(r);return i}:jc,Xt=ir;(Wa&&Xt(new Wa(new ArrayBuffer(1)))!=Ae||Gi&&Xt(new Gi)!=Ie||Ya&&Xt(Ya.resolve())!=yt||Ei&&Xt(new Ei)!=Oe||Wi&&Xt(new Wi)!=Te)&&(Xt=function(r){var i=ir(r),a=i==Le?r.constructor:t,h=a?Qn(a):"";if(h)switch(h){case d0:return Ae;case p0:return Ie;case g0:return yt;case y0:return Oe;case _0:return Te}return i});function Ry(r,i,a){for(var h=-1,_=a.length;++h<_;){var O=a[h],N=O.size;switch(O.type){case"drop":r+=N;break;case"dropRight":i-=N;break;case"take":i=Qt(i,r+N);break;case"takeRight":r=Kt(r,i-N);break}}return{start:r,end:i}}function $y(r){var i=r.match(ht);return i?i[1].split(jt):[]}function Tl(r,i,a){i=Nn(i,r);for(var h=-1,_=i.length,O=!1;++h<_;){var N=en(i[h]);if(!(O=r!=null&&a(r,N)))break;r=r[N]}return O||++h!=_?O:(_=r==null?0:r.length,!!_&&qo(_)&&dn(N,_)&&(Re(r)||Xn(r)))}function Uy(r){var i=r.length,a=new r.constructor(i);return i&&typeof r[0]=="string"&&it.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function Al(r){return typeof r.constructor=="function"&&!ns(r)?Ii(fo(r)):{}}function Dy(r,i,a){var h=r.constructor;switch(i){case Se:return dc(r);case q:case $:return new h(+r);case Ae:return vy(r,a);case Be:case Pe:case ke:case We:case et:case tt:case Je:case tr:case hr:return ll(r,a);case Ie:return new h;case ze:case $e:return new h(r);case Me:return my(r);case Oe:return new h;case Ue:return by(r)}}function Fy(r,i){var a=i.length;if(!a)return r;var h=a-1;return i[h]=(a>1?"& ":"")+i[h],i=i.join(a>2?", ":" "),r.replace(Tt,`{
/* [wrapped with `+i+`] */
`)}function Ly(r){return Re(r)||Xn(r)||!!(Uh&&r&&r[Uh])}function dn(r,i){var a=typeof r;return i=i??W,!!i&&(a=="number"||a!="symbol"&&Sa.test(r))&&r>-1&&r%1==0&&r<i}function sr(r,i,a){if(!Et(a))return!1;var h=typeof i;return(h=="number"?dr(a)&&dn(i,a.length):h=="string"&&i in a)?Kr(a[i],r):!1}function wc(r,i){if(Re(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||wr(r)?!0:Dt.test(r)||!mt.test(r)||i!=null&&r in ut(i)}function jy(r){var i=typeof r;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?r!=="__proto__":r===null}function Ec(r){var i=Ro(r),a=I[i];if(typeof a!="function"||!(i in Ye.prototype))return!1;if(r===a)return!0;var h=vc(a);return!!h&&r===h[0]}function My(r){return!!Nh&&Nh in r}var qy=ao?pn:Mc;function ns(r){var i=r&&r.constructor,a=typeof i=="function"&&i.prototype||wi;return r===a}function Nl(r){return r===r&&!Et(r)}function Cl(r,i){return function(a){return a==null?!1:a[r]===i&&(i!==t||r in ut(a))}}function Hy(r){var i=jo(r,function(h){return a.size===p&&a.clear(),h}),a=i.cache;return i}function zy(r,i){var a=r[1],h=i[1],_=a|h,O=_<(M|ne|u),N=h==u&&a==E||h==u&&a==b&&r[7].length<=i[8]||h==(u|b)&&i[7].length<=i[8]&&a==E;if(!(O||N))return r;h&M&&(r[2]=i[2],_|=a&M?0:y);var R=i[3];if(R){var j=r[3];r[3]=j?dl(j,R,i[4]):R,r[4]=j?xn(r[3],S):i[4]}return R=i[5],R&&(j=r[5],r[5]=j?pl(j,R,i[6]):R,r[6]=j?xn(r[5],S):i[6]),R=i[7],R&&(r[7]=R),h&u&&(r[8]=r[8]==null?i[8]:Qt(r[8],i[8])),r[9]==null&&(r[9]=i[9]),r[0]=i[0],r[1]=_,r}function By(r){var i=[];if(r!=null)for(var a in ut(r))i.push(a);return i}function Ky(r){return uo.call(r)}function Rl(r,i,a){return i=Kt(i===t?r.length-1:i,0),function(){for(var h=arguments,_=-1,O=Kt(h.length-i,0),N=V(O);++_<O;)N[_]=h[i+_];_=-1;for(var R=V(i+1);++_<i;)R[_]=h[_];return R[i]=a(N),Vt(r,this,R)}}function $l(r,i){return i.length<2?r:Yn(r,$r(i,0,-1))}function Vy(r,i){for(var a=r.length,h=Qt(i.length,a),_=fr(r);h--;){var O=i[h];r[h]=dn(O,a)?_[O]:t}return r}function Sc(r,i){if(!(i==="constructor"&&typeof r[i]=="function")&&i!="__proto__")return r[i]}var Ul=Fl(nl),is=o0||function(r,i){return Qe.setTimeout(r,i)},Ic=Fl(py);function Dl(r,i,a){var h=i+"";return Ic(r,Fy(h,ky($y(h),a)))}function Fl(r){var i=0,a=0;return function(){var h=h0(),_=ge-(h-a);if(a=h,_>0){if(++i>=ce)return arguments[0]}else i=0;return r.apply(t,arguments)}}function Uo(r,i){var a=-1,h=r.length,_=h-1;for(i=i===t?h:i;++a<i;){var O=oc(a,_),N=r[O];r[O]=r[a],r[a]=N}return r.length=i,r}var Ll=Hy(function(r){var i=[];return r.charCodeAt(0)===46&&i.push(""),r.replace(Ft,function(a,h,_,O){i.push(_?O.replace(_a,"$1"):h||a)}),i});function en(r){if(typeof r=="string"||wr(r))return r;var i=r+"";return i=="0"&&1/r==-te?"-0":i}function Qn(r){if(r!=null){try{return co.call(r)}catch{}try{return r+""}catch{}}return""}function ky(r,i){return Ar(be,function(a){var h="_."+a[0];i&a[1]&&!no(r,h)&&r.push(h)}),r.sort()}function jl(r){if(r instanceof Ye)return r.clone();var i=new Cr(r.__wrapped__,r.__chain__);return i.__actions__=fr(r.__actions__),i.__index__=r.__index__,i.__values__=r.__values__,i}function Gy(r,i,a){(a?sr(r,i,a):i===t)?i=1:i=Kt(je(i),0);var h=r==null?0:r.length;if(!h||i<1)return[];for(var _=0,O=0,N=V(yo(h/i));_<h;)N[O++]=$r(r,_,_+=i);return N}function Wy(r){for(var i=-1,a=r==null?0:r.length,h=0,_=[];++i<a;){var O=r[i];O&&(_[h++]=O)}return _}function Yy(){var r=arguments.length;if(!r)return[];for(var i=V(r-1),a=arguments[0],h=r;h--;)i[h-1]=arguments[h];return On(Re(a)?fr(a):[a],Yt(i,1))}var Jy=Ke(function(r,i){return Rt(r)?Xi(r,Yt(i,1,Rt,!0)):[]}),Qy=Ke(function(r,i){var a=Ur(i);return Rt(a)&&(a=t),Rt(r)?Xi(r,Yt(i,1,Rt,!0),me(a,2)):[]}),Xy=Ke(function(r,i){var a=Ur(i);return Rt(a)&&(a=t),Rt(r)?Xi(r,Yt(i,1,Rt,!0),t,a):[]});function Zy(r,i,a){var h=r==null?0:r.length;return h?(i=a||i===t?1:je(i),$r(r,i<0?0:i,h)):[]}function e_(r,i,a){var h=r==null?0:r.length;return h?(i=a||i===t?1:je(i),i=h-i,$r(r,0,i<0?0:i)):[]}function t_(r,i){return r&&r.length?xo(r,me(i,3),!0,!0):[]}function r_(r,i){return r&&r.length?xo(r,me(i,3),!0):[]}function n_(r,i,a,h){var _=r==null?0:r.length;return _?(a&&typeof a!="number"&&sr(r,i,a)&&(a=0,h=_),Y0(r,i,a,h)):[]}function Ml(r,i,a){var h=r==null?0:r.length;if(!h)return-1;var _=a==null?0:je(a);return _<0&&(_=Kt(h+_,0)),io(r,me(i,3),_)}function ql(r,i,a){var h=r==null?0:r.length;if(!h)return-1;var _=h-1;return a!==t&&(_=je(a),_=a<0?Kt(h+_,0):Qt(_,h-1)),io(r,me(i,3),_,!0)}function Hl(r){var i=r==null?0:r.length;return i?Yt(r,1):[]}function i_(r){var i=r==null?0:r.length;return i?Yt(r,te):[]}function s_(r,i){var a=r==null?0:r.length;return a?(i=i===t?1:je(i),Yt(r,i)):[]}function o_(r){for(var i=-1,a=r==null?0:r.length,h={};++i<a;){var _=r[i];h[_[0]]=_[1]}return h}function zl(r){return r&&r.length?r[0]:t}function a_(r,i,a){var h=r==null?0:r.length;if(!h)return-1;var _=a==null?0:je(a);return _<0&&(_=Kt(h+_,0)),_i(r,i,_)}function c_(r){var i=r==null?0:r.length;return i?$r(r,0,-1):[]}var u_=Ke(function(r){var i=bt(r,lc);return i.length&&i[0]===r[0]?tc(i):[]}),h_=Ke(function(r){var i=Ur(r),a=bt(r,lc);return i===Ur(a)?i=t:a.pop(),a.length&&a[0]===r[0]?tc(a,me(i,2)):[]}),l_=Ke(function(r){var i=Ur(r),a=bt(r,lc);return i=typeof i=="function"?i:t,i&&a.pop(),a.length&&a[0]===r[0]?tc(a,t,i):[]});function f_(r,i){return r==null?"":c0.call(r,i)}function Ur(r){var i=r==null?0:r.length;return i?r[i-1]:t}function d_(r,i,a){var h=r==null?0:r.length;if(!h)return-1;var _=h;return a!==t&&(_=je(a),_=_<0?Kt(h+_,0):Qt(_,h-1)),i===i?kg(r,i,_):io(r,Eh,_,!0)}function p_(r,i){return r&&r.length?Zh(r,je(i)):t}var g_=Ke(Bl);function Bl(r,i){return r&&r.length&&i&&i.length?sc(r,i):r}function y_(r,i,a){return r&&r.length&&i&&i.length?sc(r,i,me(a,2)):r}function __(r,i,a){return r&&r.length&&i&&i.length?sc(r,i,t,a):r}var v_=fn(function(r,i){var a=r==null?0:r.length,h=Qa(r,i);return rl(r,bt(i,function(_){return dn(_,a)?+_:_}).sort(fl)),h});function m_(r,i){var a=[];if(!(r&&r.length))return a;var h=-1,_=[],O=r.length;for(i=me(i,3);++h<O;){var N=r[h];i(N,h,r)&&(a.push(N),_.push(h))}return rl(r,_),a}function Oc(r){return r==null?r:f0.call(r)}function b_(r,i,a){var h=r==null?0:r.length;return h?(a&&typeof a!="number"&&sr(r,i,a)?(i=0,a=h):(i=i==null?0:je(i),a=a===t?h:je(a)),$r(r,i,a)):[]}function w_(r,i){return Oo(r,i)}function E_(r,i,a){return cc(r,i,me(a,2))}function S_(r,i){var a=r==null?0:r.length;if(a){var h=Oo(r,i);if(h<a&&Kr(r[h],i))return h}return-1}function I_(r,i){return Oo(r,i,!0)}function O_(r,i,a){return cc(r,i,me(a,2),!0)}function x_(r,i){var a=r==null?0:r.length;if(a){var h=Oo(r,i,!0)-1;if(Kr(r[h],i))return h}return-1}function P_(r){return r&&r.length?il(r):[]}function T_(r,i){return r&&r.length?il(r,me(i,2)):[]}function A_(r){var i=r==null?0:r.length;return i?$r(r,1,i):[]}function N_(r,i,a){return r&&r.length?(i=a||i===t?1:je(i),$r(r,0,i<0?0:i)):[]}function C_(r,i,a){var h=r==null?0:r.length;return h?(i=a||i===t?1:je(i),i=h-i,$r(r,i<0?0:i,h)):[]}function R_(r,i){return r&&r.length?xo(r,me(i,3),!1,!0):[]}function $_(r,i){return r&&r.length?xo(r,me(i,3)):[]}var U_=Ke(function(r){return An(Yt(r,1,Rt,!0))}),D_=Ke(function(r){var i=Ur(r);return Rt(i)&&(i=t),An(Yt(r,1,Rt,!0),me(i,2))}),F_=Ke(function(r){var i=Ur(r);return i=typeof i=="function"?i:t,An(Yt(r,1,Rt,!0),t,i)});function L_(r){return r&&r.length?An(r):[]}function j_(r,i){return r&&r.length?An(r,me(i,2)):[]}function M_(r,i){return i=typeof i=="function"?i:t,r&&r.length?An(r,t,i):[]}function xc(r){if(!(r&&r.length))return[];var i=0;return r=In(r,function(a){if(Rt(a))return i=Kt(a.length,i),!0}),Ba(i,function(a){return bt(r,qa(a))})}function Kl(r,i){if(!(r&&r.length))return[];var a=xc(r);return i==null?a:bt(a,function(h){return Vt(i,t,h)})}var q_=Ke(function(r,i){return Rt(r)?Xi(r,i):[]}),H_=Ke(function(r){return hc(In(r,Rt))}),z_=Ke(function(r){var i=Ur(r);return Rt(i)&&(i=t),hc(In(r,Rt),me(i,2))}),B_=Ke(function(r){var i=Ur(r);return i=typeof i=="function"?i:t,hc(In(r,Rt),t,i)}),K_=Ke(xc);function V_(r,i){return cl(r||[],i||[],Qi)}function k_(r,i){return cl(r||[],i||[],ts)}var G_=Ke(function(r){var i=r.length,a=i>1?r[i-1]:t;return a=typeof a=="function"?(r.pop(),a):t,Kl(r,a)});function Vl(r){var i=I(r);return i.__chain__=!0,i}function W_(r,i){return i(r),r}function Do(r,i){return i(r)}var Y_=fn(function(r){var i=r.length,a=i?r[0]:0,h=this.__wrapped__,_=function(O){return Qa(O,r)};return i>1||this.__actions__.length||!(h instanceof Ye)||!dn(a)?this.thru(_):(h=h.slice(a,+a+(i?1:0)),h.__actions__.push({func:Do,args:[_],thisArg:t}),new Cr(h,this.__chain__).thru(function(O){return i&&!O.length&&O.push(t),O}))});function J_(){return Vl(this)}function Q_(){return new Cr(this.value(),this.__chain__)}function X_(){this.__values__===t&&(this.__values__=of(this.value()));var r=this.__index__>=this.__values__.length,i=r?t:this.__values__[this.__index__++];return{done:r,value:i}}function Z_(){return this}function e1(r){for(var i,a=this;a instanceof bo;){var h=jl(a);h.__index__=0,h.__values__=t,i?_.__wrapped__=h:i=h;var _=h;a=a.__wrapped__}return _.__wrapped__=r,i}function t1(){var r=this.__wrapped__;if(r instanceof Ye){var i=r;return this.__actions__.length&&(i=new Ye(this)),i=i.reverse(),i.__actions__.push({func:Do,args:[Oc],thisArg:t}),new Cr(i,this.__chain__)}return this.thru(Oc)}function r1(){return al(this.__wrapped__,this.__actions__)}var n1=Po(function(r,i,a){it.call(r,a)?++r[a]:hn(r,a,1)});function i1(r,i,a){var h=Re(r)?bh:W0;return a&&sr(r,i,a)&&(i=t),h(r,me(i,3))}function s1(r,i){var a=Re(r)?In:Kh;return a(r,me(i,3))}var o1=vl(Ml),a1=vl(ql);function c1(r,i){return Yt(Fo(r,i),1)}function u1(r,i){return Yt(Fo(r,i),te)}function h1(r,i,a){return a=a===t?1:je(a),Yt(Fo(r,i),a)}function kl(r,i){var a=Re(r)?Ar:Tn;return a(r,me(i,3))}function Gl(r,i){var a=Re(r)?Ag:Bh;return a(r,me(i,3))}var l1=Po(function(r,i,a){it.call(r,a)?r[a].push(i):hn(r,a,[i])});function f1(r,i,a,h){r=dr(r)?r:Ai(r),a=a&&!h?je(a):0;var _=r.length;return a<0&&(a=Kt(_+a,0)),Ho(r)?a<=_&&r.indexOf(i,a)>-1:!!_&&_i(r,i,a)>-1}var d1=Ke(function(r,i,a){var h=-1,_=typeof i=="function",O=dr(r)?V(r.length):[];return Tn(r,function(N){O[++h]=_?Vt(i,N,a):Zi(N,i,a)}),O}),p1=Po(function(r,i,a){hn(r,a,i)});function Fo(r,i){var a=Re(r)?bt:Jh;return a(r,me(i,3))}function g1(r,i,a,h){return r==null?[]:(Re(i)||(i=i==null?[]:[i]),a=h?t:a,Re(a)||(a=a==null?[]:[a]),el(r,i,a))}var y1=Po(function(r,i,a){r[a?0:1].push(i)},function(){return[[],[]]});function _1(r,i,a){var h=Re(r)?ja:Ih,_=arguments.length<3;return h(r,me(i,4),a,_,Tn)}function v1(r,i,a){var h=Re(r)?Ng:Ih,_=arguments.length<3;return h(r,me(i,4),a,_,Bh)}function m1(r,i){var a=Re(r)?In:Kh;return a(r,Mo(me(i,3)))}function b1(r){var i=Re(r)?Mh:fy;return i(r)}function w1(r,i,a){(a?sr(r,i,a):i===t)?i=1:i=je(i);var h=Re(r)?B0:dy;return h(r,i)}function E1(r){var i=Re(r)?K0:gy;return i(r)}function S1(r){if(r==null)return 0;if(dr(r))return Ho(r)?mi(r):r.length;var i=Xt(r);return i==Ie||i==Oe?r.size:nc(r).length}function I1(r,i,a){var h=Re(r)?Ma:yy;return a&&sr(r,i,a)&&(i=t),h(r,me(i,3))}var O1=Ke(function(r,i){if(r==null)return[];var a=i.length;return a>1&&sr(r,i[0],i[1])?i=[]:a>2&&sr(i[0],i[1],i[2])&&(i=[i[0]]),el(r,Yt(i,1),[])}),Lo=s0||function(){return Qe.Date.now()};function x1(r,i){if(typeof i!="function")throw new Nr(l);return r=je(r),function(){if(--r<1)return i.apply(this,arguments)}}function Wl(r,i,a){return i=a?t:i,i=r&&i==null?r.length:i,ln(r,u,t,t,t,t,i)}function Yl(r,i){var a;if(typeof i!="function")throw new Nr(l);return r=je(r),function(){return--r>0&&(a=i.apply(this,arguments)),r<=1&&(i=t),a}}var Pc=Ke(function(r,i,a){var h=M;if(a.length){var _=xn(a,Pi(Pc));h|=w}return ln(r,h,i,a,_)}),Jl=Ke(function(r,i,a){var h=M|ne;if(a.length){var _=xn(a,Pi(Jl));h|=w}return ln(i,h,r,a,_)});function Ql(r,i,a){i=a?t:i;var h=ln(r,E,t,t,t,t,t,i);return h.placeholder=Ql.placeholder,h}function Xl(r,i,a){i=a?t:i;var h=ln(r,m,t,t,t,t,t,i);return h.placeholder=Xl.placeholder,h}function Zl(r,i,a){var h,_,O,N,R,j,J=0,Q=!1,Z=!1,ae=!0;if(typeof r!="function")throw new Nr(l);i=Dr(i)||0,Et(a)&&(Q=!!a.leading,Z="maxWait"in a,O=Z?Kt(Dr(a.maxWait)||0,i):O,ae="trailing"in a?!!a.trailing:ae);function ye($t){var Vr=h,yn=_;return h=_=t,J=$t,N=r.apply(yn,Vr),N}function we($t){return J=$t,R=is(Ge,i),Q?ye($t):N}function He($t){var Vr=$t-j,yn=$t-J,mf=i-Vr;return Z?Qt(mf,O-yn):mf}function Ee($t){var Vr=$t-j,yn=$t-J;return j===t||Vr>=i||Vr<0||Z&&yn>=O}function Ge(){var $t=Lo();if(Ee($t))return Xe($t);R=is(Ge,He($t))}function Xe($t){return R=t,ae&&h?ye($t):(h=_=t,N)}function Er(){R!==t&&ul(R),J=0,h=j=_=R=t}function or(){return R===t?N:Xe(Lo())}function Sr(){var $t=Lo(),Vr=Ee($t);if(h=arguments,_=this,j=$t,Vr){if(R===t)return we(j);if(Z)return ul(R),R=is(Ge,i),ye(j)}return R===t&&(R=is(Ge,i)),N}return Sr.cancel=Er,Sr.flush=or,Sr}var P1=Ke(function(r,i){return zh(r,1,i)}),T1=Ke(function(r,i,a){return zh(r,Dr(i)||0,a)});function A1(r){return ln(r,K)}function jo(r,i){if(typeof r!="function"||i!=null&&typeof i!="function")throw new Nr(l);var a=function(){var h=arguments,_=i?i.apply(this,h):h[0],O=a.cache;if(O.has(_))return O.get(_);var N=r.apply(this,h);return a.cache=O.set(_,N)||O,N};return a.cache=new(jo.Cache||un),a}jo.Cache=un;function Mo(r){if(typeof r!="function")throw new Nr(l);return function(){var i=arguments;switch(i.length){case 0:return!r.call(this);case 1:return!r.call(this,i[0]);case 2:return!r.call(this,i[0],i[1]);case 3:return!r.call(this,i[0],i[1],i[2])}return!r.apply(this,i)}}function N1(r){return Yl(2,r)}var C1=_y(function(r,i){i=i.length==1&&Re(i[0])?bt(i[0],mr(me())):bt(Yt(i,1),mr(me()));var a=i.length;return Ke(function(h){for(var _=-1,O=Qt(h.length,a);++_<O;)h[_]=i[_].call(this,h[_]);return Vt(r,this,h)})}),Tc=Ke(function(r,i){var a=xn(i,Pi(Tc));return ln(r,w,t,i,a)}),ef=Ke(function(r,i){var a=xn(i,Pi(ef));return ln(r,g,t,i,a)}),R1=fn(function(r,i){return ln(r,b,t,t,t,i)});function $1(r,i){if(typeof r!="function")throw new Nr(l);return i=i===t?i:je(i),Ke(r,i)}function U1(r,i){if(typeof r!="function")throw new Nr(l);return i=i==null?0:Kt(je(i),0),Ke(function(a){var h=a[i],_=Cn(a,0,i);return h&&On(_,h),Vt(r,this,_)})}function D1(r,i,a){var h=!0,_=!0;if(typeof r!="function")throw new Nr(l);return Et(a)&&(h="leading"in a?!!a.leading:h,_="trailing"in a?!!a.trailing:_),Zl(r,i,{leading:h,maxWait:i,trailing:_})}function F1(r){return Wl(r,1)}function L1(r,i){return Tc(fc(i),r)}function j1(){if(!arguments.length)return[];var r=arguments[0];return Re(r)?r:[r]}function M1(r){return Rr(r,A)}function q1(r,i){return i=typeof i=="function"?i:t,Rr(r,A,i)}function H1(r){return Rr(r,T|A)}function z1(r,i){return i=typeof i=="function"?i:t,Rr(r,T|A,i)}function B1(r,i){return i==null||Hh(r,i,kt(i))}function Kr(r,i){return r===i||r!==r&&i!==i}var K1=Co(ec),V1=Co(function(r,i){return r>=i}),Xn=Gh(function(){return arguments}())?Gh:function(r){return At(r)&&it.call(r,"callee")&&!$h.call(r,"callee")},Re=V.isArray,k1=nr?mr(nr):ey;function dr(r){return r!=null&&qo(r.length)&&!pn(r)}function Rt(r){return At(r)&&dr(r)}function G1(r){return r===!0||r===!1||At(r)&&ir(r)==q}var Rn=a0||Mc,W1=Hr?mr(Hr):ty;function Y1(r){return At(r)&&r.nodeType===1&&!ss(r)}function J1(r){if(r==null)return!0;if(dr(r)&&(Re(r)||typeof r=="string"||typeof r.splice=="function"||Rn(r)||Ti(r)||Xn(r)))return!r.length;var i=Xt(r);if(i==Ie||i==Oe)return!r.size;if(ns(r))return!nc(r).length;for(var a in r)if(it.call(r,a))return!1;return!0}function Q1(r,i){return es(r,i)}function X1(r,i,a){a=typeof a=="function"?a:t;var h=a?a(r,i):t;return h===t?es(r,i,t,a):!!h}function Ac(r){if(!At(r))return!1;var i=ir(r);return i==C||i==d||typeof r.message=="string"&&typeof r.name=="string"&&!ss(r)}function Z1(r){return typeof r=="number"&&Dh(r)}function pn(r){if(!Et(r))return!1;var i=ir(r);return i==se||i==fe||i==H||i==_t}function tf(r){return typeof r=="number"&&r==je(r)}function qo(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=W}function Et(r){var i=typeof r;return r!=null&&(i=="object"||i=="function")}function At(r){return r!=null&&typeof r=="object"}var rf=Tr?mr(Tr):ny;function ev(r,i){return r===i||rc(r,i,mc(i))}function tv(r,i,a){return a=typeof a=="function"?a:t,rc(r,i,mc(i),a)}function rv(r){return nf(r)&&r!=+r}function nv(r){if(qy(r))throw new Ne(c);return Wh(r)}function iv(r){return r===null}function sv(r){return r==null}function nf(r){return typeof r=="number"||At(r)&&ir(r)==ze}function ss(r){if(!At(r)||ir(r)!=Le)return!1;var i=fo(r);if(i===null)return!0;var a=it.call(i,"constructor")&&i.constructor;return typeof a=="function"&&a instanceof a&&co.call(a)==t0}var Nc=Qr?mr(Qr):iy;function ov(r){return tf(r)&&r>=-W&&r<=W}var sf=Ki?mr(Ki):sy;function Ho(r){return typeof r=="string"||!Re(r)&&At(r)&&ir(r)==$e}function wr(r){return typeof r=="symbol"||At(r)&&ir(r)==Ue}var Ti=Kn?mr(Kn):oy;function av(r){return r===t}function cv(r){return At(r)&&Xt(r)==Te}function uv(r){return At(r)&&ir(r)==De}var hv=Co(ic),lv=Co(function(r,i){return r<=i});function of(r){if(!r)return[];if(dr(r))return Ho(r)?zr(r):fr(r);if(ki&&r[ki])return Bg(r[ki]());var i=Xt(r),a=i==Ie?Va:i==Oe?so:Ai;return a(r)}function gn(r){if(!r)return r===0?r:0;if(r=Dr(r),r===te||r===-te){var i=r<0?-1:1;return i*ee}return r===r?r:0}function je(r){var i=gn(r),a=i%1;return i===i?a?i-a:i:0}function af(r){return r?Wn(je(r),0,re):0}function Dr(r){if(typeof r=="number")return r;if(wr(r))return Y;if(Et(r)){var i=typeof r.valueOf=="function"?r.valueOf():r;r=Et(i)?i+"":i}if(typeof r!="string")return r===0?r:+r;r=Oh(r);var a=ba.test(r);return a||Ea.test(r)?Ce(r.slice(2),a?2:8):ma.test(r)?Y:+r}function cf(r){return Zr(r,pr(r))}function fv(r){return r?Wn(je(r),-W,W):r===0?r:0}function nt(r){return r==null?"":br(r)}var dv=Oi(function(r,i){if(ns(i)||dr(i)){Zr(i,kt(i),r);return}for(var a in i)it.call(i,a)&&Qi(r,a,i[a])}),uf=Oi(function(r,i){Zr(i,pr(i),r)}),zo=Oi(function(r,i,a,h){Zr(i,pr(i),r,h)}),pv=Oi(function(r,i,a,h){Zr(i,kt(i),r,h)}),gv=fn(Qa);function yv(r,i){var a=Ii(r);return i==null?a:qh(a,i)}var _v=Ke(function(r,i){r=ut(r);var a=-1,h=i.length,_=h>2?i[2]:t;for(_&&sr(i[0],i[1],_)&&(h=1);++a<h;)for(var O=i[a],N=pr(O),R=-1,j=N.length;++R<j;){var J=N[R],Q=r[J];(Q===t||Kr(Q,wi[J])&&!it.call(r,J))&&(r[J]=O[J])}return r}),vv=Ke(function(r){return r.push(t,Ol),Vt(hf,t,r)});function mv(r,i){return wh(r,me(i,3),Xr)}function bv(r,i){return wh(r,me(i,3),Za)}function wv(r,i){return r==null?r:Xa(r,me(i,3),pr)}function Ev(r,i){return r==null?r:Vh(r,me(i,3),pr)}function Sv(r,i){return r&&Xr(r,me(i,3))}function Iv(r,i){return r&&Za(r,me(i,3))}function Ov(r){return r==null?[]:So(r,kt(r))}function xv(r){return r==null?[]:So(r,pr(r))}function Cc(r,i,a){var h=r==null?t:Yn(r,i);return h===t?a:h}function Pv(r,i){return r!=null&&Tl(r,i,J0)}function Rc(r,i){return r!=null&&Tl(r,i,Q0)}var Tv=bl(function(r,i,a){i!=null&&typeof i.toString!="function"&&(i=uo.call(i)),r[i]=a},Uc(gr)),Av=bl(function(r,i,a){i!=null&&typeof i.toString!="function"&&(i=uo.call(i)),it.call(r,i)?r[i].push(a):r[i]=[a]},me),Nv=Ke(Zi);function kt(r){return dr(r)?jh(r):nc(r)}function pr(r){return dr(r)?jh(r,!0):ay(r)}function Cv(r,i){var a={};return i=me(i,3),Xr(r,function(h,_,O){hn(a,i(h,_,O),h)}),a}function Rv(r,i){var a={};return i=me(i,3),Xr(r,function(h,_,O){hn(a,_,i(h,_,O))}),a}var $v=Oi(function(r,i,a){Io(r,i,a)}),hf=Oi(function(r,i,a,h){Io(r,i,a,h)}),Uv=fn(function(r,i){var a={};if(r==null)return a;var h=!1;i=bt(i,function(O){return O=Nn(O,r),h||(h=O.length>1),O}),Zr(r,_c(r),a),h&&(a=Rr(a,T|x|A,Ty));for(var _=i.length;_--;)uc(a,i[_]);return a});function Dv(r,i){return lf(r,Mo(me(i)))}var Fv=fn(function(r,i){return r==null?{}:uy(r,i)});function lf(r,i){if(r==null)return{};var a=bt(_c(r),function(h){return[h]});return i=me(i),tl(r,a,function(h,_){return i(h,_[0])})}function Lv(r,i,a){i=Nn(i,r);var h=-1,_=i.length;for(_||(_=1,r=t);++h<_;){var O=r==null?t:r[en(i[h])];O===t&&(h=_,O=a),r=pn(O)?O.call(r):O}return r}function jv(r,i,a){return r==null?r:ts(r,i,a)}function Mv(r,i,a,h){return h=typeof h=="function"?h:t,r==null?r:ts(r,i,a,h)}var ff=Sl(kt),df=Sl(pr);function qv(r,i,a){var h=Re(r),_=h||Rn(r)||Ti(r);if(i=me(i,4),a==null){var O=r&&r.constructor;_?a=h?new O:[]:Et(r)?a=pn(O)?Ii(fo(r)):{}:a={}}return(_?Ar:Xr)(r,function(N,R,j){return i(a,N,R,j)}),a}function Hv(r,i){return r==null?!0:uc(r,i)}function zv(r,i,a){return r==null?r:ol(r,i,fc(a))}function Bv(r,i,a,h){return h=typeof h=="function"?h:t,r==null?r:ol(r,i,fc(a),h)}function Ai(r){return r==null?[]:Ka(r,kt(r))}function Kv(r){return r==null?[]:Ka(r,pr(r))}function Vv(r,i,a){return a===t&&(a=i,i=t),a!==t&&(a=Dr(a),a=a===a?a:0),i!==t&&(i=Dr(i),i=i===i?i:0),Wn(Dr(r),i,a)}function kv(r,i,a){return i=gn(i),a===t?(a=i,i=0):a=gn(a),r=Dr(r),X0(r,i,a)}function Gv(r,i,a){if(a&&typeof a!="boolean"&&sr(r,i,a)&&(i=a=t),a===t&&(typeof i=="boolean"?(a=i,i=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&i===t?(r=0,i=1):(r=gn(r),i===t?(i=r,r=0):i=gn(i)),r>i){var h=r;r=i,i=h}if(a||r%1||i%1){var _=Fh();return Qt(r+_*(i-r+at("1e-"+((_+"").length-1))),i)}return oc(r,i)}var Wv=xi(function(r,i,a){return i=i.toLowerCase(),r+(a?pf(i):i)});function pf(r){return $c(nt(r).toLowerCase())}function gf(r){return r=nt(r),r&&r.replace(on,jg).replace(Da,"")}function Yv(r,i,a){r=nt(r),i=br(i);var h=r.length;a=a===t?h:Wn(je(a),0,h);var _=a;return a-=i.length,a>=0&&r.slice(a,_)==i}function Jv(r){return r=nt(r),r&&vt.test(r)?r.replace(Mn,Mg):r}function Qv(r){return r=nt(r),r&&Lt.test(r)?r.replace(xt,"\\$&"):r}var Xv=xi(function(r,i,a){return r+(a?"-":"")+i.toLowerCase()}),Zv=xi(function(r,i,a){return r+(a?" ":"")+i.toLowerCase()}),em=_l("toLowerCase");function tm(r,i,a){r=nt(r),i=je(i);var h=i?mi(r):0;if(!i||h>=i)return r;var _=(i-h)/2;return No(_o(_),a)+r+No(yo(_),a)}function rm(r,i,a){r=nt(r),i=je(i);var h=i?mi(r):0;return i&&h<i?r+No(i-h,a):r}function nm(r,i,a){r=nt(r),i=je(i);var h=i?mi(r):0;return i&&h<i?No(i-h,a)+r:r}function im(r,i,a){return a||i==null?i=0:i&&(i=+i),l0(nt(r).replace(Pt,""),i||0)}function sm(r,i,a){return(a?sr(r,i,a):i===t)?i=1:i=je(i),ac(nt(r),i)}function om(){var r=arguments,i=nt(r[0]);return r.length<3?i:i.replace(r[1],r[2])}var am=xi(function(r,i,a){return r+(a?"_":"")+i.toLowerCase()});function cm(r,i,a){return a&&typeof a!="number"&&sr(r,i,a)&&(i=a=t),a=a===t?re:a>>>0,a?(r=nt(r),r&&(typeof i=="string"||i!=null&&!Nc(i))&&(i=br(i),!i&&vi(r))?Cn(zr(r),0,a):r.split(i,a)):[]}var um=xi(function(r,i,a){return r+(a?" ":"")+$c(i)});function hm(r,i,a){return r=nt(r),a=a==null?0:Wn(je(a),0,r.length),i=br(i),r.slice(a,a+i.length)==i}function lm(r,i,a){var h=I.templateSettings;a&&sr(r,i,a)&&(i=t),r=nt(r),i=zo({},i,h,Il);var _=zo({},i.imports,h.imports,Il),O=kt(_),N=Ka(_,O),R,j,J=0,Q=i.interpolate||hi,Z="__p += '",ae=ka((i.escape||hi).source+"|"+Q.source+"|"+(Q===wt?va:hi).source+"|"+(i.evaluate||hi).source+"|$","g"),ye="//# sourceURL="+(it.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Fa+"]")+`
`;r.replace(ae,function(Ee,Ge,Xe,Er,or,Sr){return Xe||(Xe=Er),Z+=r.slice(J,Sr).replace(Ia,qg),Ge&&(R=!0,Z+=`' +
__e(`+Ge+`) +
'`),or&&(j=!0,Z+=`';
`+or+`;
__p += '`),Xe&&(Z+=`' +
((__t = (`+Xe+`)) == null ? '' : __t) +
'`),J=Sr+Ee.length,Ee}),Z+=`';
`;var we=it.call(i,"variable")&&i.variable;if(!we)Z=`with (obj) {
`+Z+`
}
`;else if(ya.test(we))throw new Ne(f);Z=(j?Z.replace(Yr,""):Z).replace(rr,"$1").replace(sn,"$1;"),Z="function("+(we||"obj")+`) {
`+(we?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(R?", __e = _.escape":"")+(j?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Z+`return __p
}`;var He=_f(function(){return rt(O,ye+"return "+Z).apply(t,N)});if(He.source=Z,Ac(He))throw He;return He}function fm(r){return nt(r).toLowerCase()}function dm(r){return nt(r).toUpperCase()}function pm(r,i,a){if(r=nt(r),r&&(a||i===t))return Oh(r);if(!r||!(i=br(i)))return r;var h=zr(r),_=zr(i),O=xh(h,_),N=Ph(h,_)+1;return Cn(h,O,N).join("")}function gm(r,i,a){if(r=nt(r),r&&(a||i===t))return r.slice(0,Ah(r)+1);if(!r||!(i=br(i)))return r;var h=zr(r),_=Ph(h,zr(i))+1;return Cn(h,0,_).join("")}function ym(r,i,a){if(r=nt(r),r&&(a||i===t))return r.replace(Pt,"");if(!r||!(i=br(i)))return r;var h=zr(r),_=xh(h,zr(i));return Cn(h,_).join("")}function _m(r,i){var a=k,h=oe;if(Et(i)){var _="separator"in i?i.separator:_;a="length"in i?je(i.length):a,h="omission"in i?br(i.omission):h}r=nt(r);var O=r.length;if(vi(r)){var N=zr(r);O=N.length}if(a>=O)return r;var R=a-mi(h);if(R<1)return h;var j=N?Cn(N,0,R).join(""):r.slice(0,R);if(_===t)return j+h;if(N&&(R+=j.length-R),Nc(_)){if(r.slice(R).search(_)){var J,Q=j;for(_.global||(_=ka(_.source,nt(Pr.exec(_))+"g")),_.lastIndex=0;J=_.exec(Q);)var Z=J.index;j=j.slice(0,Z===t?R:Z)}}else if(r.indexOf(br(_),R)!=R){var ae=j.lastIndexOf(_);ae>-1&&(j=j.slice(0,ae))}return j+h}function vm(r){return r=nt(r),r&&St.test(r)?r.replace(En,Gg):r}var mm=xi(function(r,i,a){return r+(a?" ":"")+i.toUpperCase()}),$c=_l("toUpperCase");function yf(r,i,a){return r=nt(r),i=a?t:i,i===t?zg(r)?Jg(r):$g(r):r.match(i)||[]}var _f=Ke(function(r,i){try{return Vt(r,t,i)}catch(a){return Ac(a)?a:new Ne(a)}}),bm=fn(function(r,i){return Ar(i,function(a){a=en(a),hn(r,a,Pc(r[a],r))}),r});function wm(r){var i=r==null?0:r.length,a=me();return r=i?bt(r,function(h){if(typeof h[1]!="function")throw new Nr(l);return[a(h[0]),h[1]]}):[],Ke(function(h){for(var _=-1;++_<i;){var O=r[_];if(Vt(O[0],this,h))return Vt(O[1],this,h)}})}function Em(r){return G0(Rr(r,T))}function Uc(r){return function(){return r}}function Sm(r,i){return r==null||r!==r?i:r}var Im=ml(),Om=ml(!0);function gr(r){return r}function Dc(r){return Yh(typeof r=="function"?r:Rr(r,T))}function xm(r){return Qh(Rr(r,T))}function Pm(r,i){return Xh(r,Rr(i,T))}var Tm=Ke(function(r,i){return function(a){return Zi(a,r,i)}}),Am=Ke(function(r,i){return function(a){return Zi(r,a,i)}});function Fc(r,i,a){var h=kt(i),_=So(i,h);a==null&&!(Et(i)&&(_.length||!h.length))&&(a=i,i=r,r=this,_=So(i,kt(i)));var O=!(Et(a)&&"chain"in a)||!!a.chain,N=pn(r);return Ar(_,function(R){var j=i[R];r[R]=j,N&&(r.prototype[R]=function(){var J=this.__chain__;if(O||J){var Q=r(this.__wrapped__),Z=Q.__actions__=fr(this.__actions__);return Z.push({func:j,args:arguments,thisArg:r}),Q.__chain__=J,Q}return j.apply(r,On([this.value()],arguments))})}),r}function Nm(){return Qe._===this&&(Qe._=r0),this}function Lc(){}function Cm(r){return r=je(r),Ke(function(i){return Zh(i,r)})}var Rm=pc(bt),$m=pc(bh),Um=pc(Ma);function vf(r){return wc(r)?qa(en(r)):hy(r)}function Dm(r){return function(i){return r==null?t:Yn(r,i)}}var Fm=wl(),Lm=wl(!0);function jc(){return[]}function Mc(){return!1}function jm(){return{}}function Mm(){return""}function qm(){return!0}function Hm(r,i){if(r=je(r),r<1||r>W)return[];var a=re,h=Qt(r,re);i=me(i),r-=re;for(var _=Ba(h,i);++a<r;)i(a);return _}function zm(r){return Re(r)?bt(r,en):wr(r)?[r]:fr(Ll(nt(r)))}function Bm(r){var i=++e0;return nt(r)+i}var Km=Ao(function(r,i){return r+i},0),Vm=gc("ceil"),km=Ao(function(r,i){return r/i},1),Gm=gc("floor");function Wm(r){return r&&r.length?Eo(r,gr,ec):t}function Ym(r,i){return r&&r.length?Eo(r,me(i,2),ec):t}function Jm(r){return Sh(r,gr)}function Qm(r,i){return Sh(r,me(i,2))}function Xm(r){return r&&r.length?Eo(r,gr,ic):t}function Zm(r,i){return r&&r.length?Eo(r,me(i,2),ic):t}var eb=Ao(function(r,i){return r*i},1),tb=gc("round"),rb=Ao(function(r,i){return r-i},0);function nb(r){return r&&r.length?za(r,gr):0}function ib(r,i){return r&&r.length?za(r,me(i,2)):0}return I.after=x1,I.ary=Wl,I.assign=dv,I.assignIn=uf,I.assignInWith=zo,I.assignWith=pv,I.at=gv,I.before=Yl,I.bind=Pc,I.bindAll=bm,I.bindKey=Jl,I.castArray=j1,I.chain=Vl,I.chunk=Gy,I.compact=Wy,I.concat=Yy,I.cond=wm,I.conforms=Em,I.constant=Uc,I.countBy=n1,I.create=yv,I.curry=Ql,I.curryRight=Xl,I.debounce=Zl,I.defaults=_v,I.defaultsDeep=vv,I.defer=P1,I.delay=T1,I.difference=Jy,I.differenceBy=Qy,I.differenceWith=Xy,I.drop=Zy,I.dropRight=e_,I.dropRightWhile=t_,I.dropWhile=r_,I.fill=n_,I.filter=s1,I.flatMap=c1,I.flatMapDeep=u1,I.flatMapDepth=h1,I.flatten=Hl,I.flattenDeep=i_,I.flattenDepth=s_,I.flip=A1,I.flow=Im,I.flowRight=Om,I.fromPairs=o_,I.functions=Ov,I.functionsIn=xv,I.groupBy=l1,I.initial=c_,I.intersection=u_,I.intersectionBy=h_,I.intersectionWith=l_,I.invert=Tv,I.invertBy=Av,I.invokeMap=d1,I.iteratee=Dc,I.keyBy=p1,I.keys=kt,I.keysIn=pr,I.map=Fo,I.mapKeys=Cv,I.mapValues=Rv,I.matches=xm,I.matchesProperty=Pm,I.memoize=jo,I.merge=$v,I.mergeWith=hf,I.method=Tm,I.methodOf=Am,I.mixin=Fc,I.negate=Mo,I.nthArg=Cm,I.omit=Uv,I.omitBy=Dv,I.once=N1,I.orderBy=g1,I.over=Rm,I.overArgs=C1,I.overEvery=$m,I.overSome=Um,I.partial=Tc,I.partialRight=ef,I.partition=y1,I.pick=Fv,I.pickBy=lf,I.property=vf,I.propertyOf=Dm,I.pull=g_,I.pullAll=Bl,I.pullAllBy=y_,I.pullAllWith=__,I.pullAt=v_,I.range=Fm,I.rangeRight=Lm,I.rearg=R1,I.reject=m1,I.remove=m_,I.rest=$1,I.reverse=Oc,I.sampleSize=w1,I.set=jv,I.setWith=Mv,I.shuffle=E1,I.slice=b_,I.sortBy=O1,I.sortedUniq=P_,I.sortedUniqBy=T_,I.split=cm,I.spread=U1,I.tail=A_,I.take=N_,I.takeRight=C_,I.takeRightWhile=R_,I.takeWhile=$_,I.tap=W_,I.throttle=D1,I.thru=Do,I.toArray=of,I.toPairs=ff,I.toPairsIn=df,I.toPath=zm,I.toPlainObject=cf,I.transform=qv,I.unary=F1,I.union=U_,I.unionBy=D_,I.unionWith=F_,I.uniq=L_,I.uniqBy=j_,I.uniqWith=M_,I.unset=Hv,I.unzip=xc,I.unzipWith=Kl,I.update=zv,I.updateWith=Bv,I.values=Ai,I.valuesIn=Kv,I.without=q_,I.words=yf,I.wrap=L1,I.xor=H_,I.xorBy=z_,I.xorWith=B_,I.zip=K_,I.zipObject=V_,I.zipObjectDeep=k_,I.zipWith=G_,I.entries=ff,I.entriesIn=df,I.extend=uf,I.extendWith=zo,Fc(I,I),I.add=Km,I.attempt=_f,I.camelCase=Wv,I.capitalize=pf,I.ceil=Vm,I.clamp=Vv,I.clone=M1,I.cloneDeep=H1,I.cloneDeepWith=z1,I.cloneWith=q1,I.conformsTo=B1,I.deburr=gf,I.defaultTo=Sm,I.divide=km,I.endsWith=Yv,I.eq=Kr,I.escape=Jv,I.escapeRegExp=Qv,I.every=i1,I.find=o1,I.findIndex=Ml,I.findKey=mv,I.findLast=a1,I.findLastIndex=ql,I.findLastKey=bv,I.floor=Gm,I.forEach=kl,I.forEachRight=Gl,I.forIn=wv,I.forInRight=Ev,I.forOwn=Sv,I.forOwnRight=Iv,I.get=Cc,I.gt=K1,I.gte=V1,I.has=Pv,I.hasIn=Rc,I.head=zl,I.identity=gr,I.includes=f1,I.indexOf=a_,I.inRange=kv,I.invoke=Nv,I.isArguments=Xn,I.isArray=Re,I.isArrayBuffer=k1,I.isArrayLike=dr,I.isArrayLikeObject=Rt,I.isBoolean=G1,I.isBuffer=Rn,I.isDate=W1,I.isElement=Y1,I.isEmpty=J1,I.isEqual=Q1,I.isEqualWith=X1,I.isError=Ac,I.isFinite=Z1,I.isFunction=pn,I.isInteger=tf,I.isLength=qo,I.isMap=rf,I.isMatch=ev,I.isMatchWith=tv,I.isNaN=rv,I.isNative=nv,I.isNil=sv,I.isNull=iv,I.isNumber=nf,I.isObject=Et,I.isObjectLike=At,I.isPlainObject=ss,I.isRegExp=Nc,I.isSafeInteger=ov,I.isSet=sf,I.isString=Ho,I.isSymbol=wr,I.isTypedArray=Ti,I.isUndefined=av,I.isWeakMap=cv,I.isWeakSet=uv,I.join=f_,I.kebabCase=Xv,I.last=Ur,I.lastIndexOf=d_,I.lowerCase=Zv,I.lowerFirst=em,I.lt=hv,I.lte=lv,I.max=Wm,I.maxBy=Ym,I.mean=Jm,I.meanBy=Qm,I.min=Xm,I.minBy=Zm,I.stubArray=jc,I.stubFalse=Mc,I.stubObject=jm,I.stubString=Mm,I.stubTrue=qm,I.multiply=eb,I.nth=p_,I.noConflict=Nm,I.noop=Lc,I.now=Lo,I.pad=tm,I.padEnd=rm,I.padStart=nm,I.parseInt=im,I.random=Gv,I.reduce=_1,I.reduceRight=v1,I.repeat=sm,I.replace=om,I.result=Lv,I.round=tb,I.runInContext=L,I.sample=b1,I.size=S1,I.snakeCase=am,I.some=I1,I.sortedIndex=w_,I.sortedIndexBy=E_,I.sortedIndexOf=S_,I.sortedLastIndex=I_,I.sortedLastIndexBy=O_,I.sortedLastIndexOf=x_,I.startCase=um,I.startsWith=hm,I.subtract=rb,I.sum=nb,I.sumBy=ib,I.template=lm,I.times=Hm,I.toFinite=gn,I.toInteger=je,I.toLength=af,I.toLower=fm,I.toNumber=Dr,I.toSafeInteger=fv,I.toString=nt,I.toUpper=dm,I.trim=pm,I.trimEnd=gm,I.trimStart=ym,I.truncate=_m,I.unescape=vm,I.uniqueId=Bm,I.upperCase=mm,I.upperFirst=$c,I.each=kl,I.eachRight=Gl,I.first=zl,Fc(I,function(){var r={};return Xr(I,function(i,a){it.call(I.prototype,a)||(r[a]=i)}),r}(),{chain:!1}),I.VERSION=s,Ar(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){I[r].placeholder=I}),Ar(["drop","take"],function(r,i){Ye.prototype[r]=function(a){a=a===t?1:Kt(je(a),0);var h=this.__filtered__&&!i?new Ye(this):this.clone();return h.__filtered__?h.__takeCount__=Qt(a,h.__takeCount__):h.__views__.push({size:Qt(a,re),type:r+(h.__dir__<0?"Right":"")}),h},Ye.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Ar(["filter","map","takeWhile"],function(r,i){var a=i+1,h=a==D||a==le;Ye.prototype[r]=function(_){var O=this.clone();return O.__iteratees__.push({iteratee:me(_,3),type:a}),O.__filtered__=O.__filtered__||h,O}}),Ar(["head","last"],function(r,i){var a="take"+(i?"Right":"");Ye.prototype[r]=function(){return this[a](1).value()[0]}}),Ar(["initial","tail"],function(r,i){var a="drop"+(i?"":"Right");Ye.prototype[r]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(gr)},Ye.prototype.find=function(r){return this.filter(r).head()},Ye.prototype.findLast=function(r){return this.reverse().find(r)},Ye.prototype.invokeMap=Ke(function(r,i){return typeof r=="function"?new Ye(this):this.map(function(a){return Zi(a,r,i)})}),Ye.prototype.reject=function(r){return this.filter(Mo(me(r)))},Ye.prototype.slice=function(r,i){r=je(r);var a=this;return a.__filtered__&&(r>0||i<0)?new Ye(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),i!==t&&(i=je(i),a=i<0?a.dropRight(-i):a.take(i-r)),a)},Ye.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Ye.prototype.toArray=function(){return this.take(re)},Xr(Ye.prototype,function(r,i){var a=/^(?:filter|find|map|reject)|While$/.test(i),h=/^(?:head|last)$/.test(i),_=I[h?"take"+(i=="last"?"Right":""):i],O=h||/^find/.test(i);_&&(I.prototype[i]=function(){var N=this.__wrapped__,R=h?[1]:arguments,j=N instanceof Ye,J=R[0],Q=j||Re(N),Z=function(Ge){var Xe=_.apply(I,On([Ge],R));return h&&ae?Xe[0]:Xe};Q&&a&&typeof J=="function"&&J.length!=1&&(j=Q=!1);var ae=this.__chain__,ye=!!this.__actions__.length,we=O&&!ae,He=j&&!ye;if(!O&&Q){N=He?N:new Ye(this);var Ee=r.apply(N,R);return Ee.__actions__.push({func:Do,args:[Z],thisArg:t}),new Cr(Ee,ae)}return we&&He?r.apply(this,R):(Ee=this.thru(Z),we?h?Ee.value()[0]:Ee.value():Ee)})}),Ar(["pop","push","shift","sort","splice","unshift"],function(r){var i=oo[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",h=/^(?:pop|shift)$/.test(r);I.prototype[r]=function(){var _=arguments;if(h&&!this.__chain__){var O=this.value();return i.apply(Re(O)?O:[],_)}return this[a](function(N){return i.apply(Re(N)?N:[],_)})}}),Xr(Ye.prototype,function(r,i){var a=I[i];if(a){var h=a.name+"";it.call(Si,h)||(Si[h]=[]),Si[h].push({name:i,func:a})}}),Si[To(t,ne).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=v0,Ye.prototype.reverse=m0,Ye.prototype.value=b0,I.prototype.at=Y_,I.prototype.chain=J_,I.prototype.commit=Q_,I.prototype.next=X_,I.prototype.plant=e1,I.prototype.reverse=t1,I.prototype.toJSON=I.prototype.valueOf=I.prototype.value=r1,I.prototype.first=I.prototype.head,ki&&(I.prototype[ki]=Z_),I},bi=Qg();Ct?((Ct.exports=bi)._=bi,ct._=bi):Qe._=bi}).call(_s)})(ju,ju.exports);var l5=Object.defineProperty,f5=Object.defineProperties,d5=Object.getOwnPropertyDescriptors,Xd=Object.getOwnPropertySymbols,p5=Object.prototype.hasOwnProperty,g5=Object.prototype.propertyIsEnumerable,Zd=(n,e,t)=>e in n?l5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Vo=(n,e)=>{for(var t in e||(e={}))p5.call(e,t)&&Zd(n,t,e[t]);if(Xd)for(var t of Xd(e))g5.call(e,t)&&Zd(n,t,e[t]);return n},y5=(n,e)=>f5(n,d5(e));function jr(n,e,t){let s;const o=Mu(n);return e.rpcMap&&(s=e.rpcMap[o]),s||(s=`${h5}?chainId=eip155:${o}&projectId=${t}`),s}function Mu(n){return n.includes("eip155")?Number(n.split(":")[1]):Number(n)}function xg(n){return n.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function _5(n,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(n));if(!t.length)return[];const s=[];return t.forEach(o=>{const c=e.namespaces[o].accounts;s.push(...c)}),s}function v5(n={},e={}){const t=ep(n),s=ep(e);return ju.exports.merge(t,s)}function ep(n){var e,t,s,o;const c={};if(!i5(n))return c;for(const[l,f]of Object.entries(n)){const v=_h(l)?[l]:f.chains,p=f.methods||[],S=f.events||[],T=f.rpcMap||{},x=vs(l);c[x]=y5(Vo(Vo({},c[x]),f),{chains:su(v,(e=c[x])==null?void 0:e.chains),methods:su(p,(t=c[x])==null?void 0:t.methods),events:su(S,(s=c[x])==null?void 0:s.events),rpcMap:Vo(Vo({},T),(o=c[x])==null?void 0:o.rpcMap)})}return c}function m5(n){return n.includes(":")?n.split(":")[2]:n}function b5(n){const e={};for(const[t,s]of Object.entries(n)){const o=s.methods||[],c=s.events||[],l=s.accounts||[],f=_h(t)?[t]:s.chains?s.chains:xg(s.accounts);e[t]={chains:f,methods:o,events:c,accounts:l}}return e}function ou(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):n.includes(":")?Number(n.split(":")[1]):Number(n)}const Pg={},Ut=n=>Pg[n],au=(n,e)=>{Pg[n]=e};class w5{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||jr(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||jr(e,this.namespace);return typeof s>"u"?void 0:new Ln(new ui(s,Ut("disableProviderPing")))}}class E5{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=Ut("events"),this.client=Ut("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){const s=Mu(e);if(!this.httpProviders[s]){const o=t||jr(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,o)}this.chainId=s,this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||jr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ln(new ui(s,Ut("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=Mu(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class S5{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||jr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||jr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ln(new ui(s,Ut("disableProviderPing")))}}class I5{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||jr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||jr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ln(new ui(s,Ut("disableProviderPing")))}}class O5{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t);e[t]=this.createHttpProvider(t,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);return typeof s>"u"?void 0:new Ln(new ui(s,Ut("disableProviderPing")))}}class x5{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||jr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||jr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ln(new ui(s,Ut("disableProviderPing")))}}class P5{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||jr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||jr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ln(new ui(s,Ut("disableProviderPing")))}}var T5=Object.defineProperty,A5=Object.defineProperties,N5=Object.getOwnPropertyDescriptors,tp=Object.getOwnPropertySymbols,C5=Object.prototype.hasOwnProperty,R5=Object.prototype.propertyIsEnumerable,rp=(n,e,t)=>e in n?T5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ko=(n,e)=>{for(var t in e||(e={}))C5.call(e,t)&&rp(n,t,e[t]);if(tp)for(var t of tp(e))R5.call(e,t)&&rp(n,t,e[t]);return n},cu=(n,e)=>A5(n,N5(e));class vh{constructor(e){this.events=new zu,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Jd})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new vh(e);return await t.initialize(),t}async request(e,t){const[s,o]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:ko({},e),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(e,t,s){this.request(e,s).then(o=>t(null,o)).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:kd("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c,this.namespaces||(this.namespaces=b5(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==Sg)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(Gd(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await z3.init({logger:this.providerOpts.logger||Jd,relayUrl:this.providerOpts.relayUrl||a5,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>vs(t)))];au("client",this.client),au("events",this.events),au("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=_5(t,this.session),o=xg(s),c=v5(this.namespaces,this.optionalNamespaces),l=cu(ko({},c[t]),{accounts:s,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new E5({namespace:l});break;case"solana":this.rpcProviders[t]=new S5({namespace:l});break;case"cosmos":this.rpcProviders[t]=new I5({namespace:l});break;case"polkadot":this.rpcProviders[t]=new w5({namespace:l});break;case"cip34":this.rpcProviders[t]=new O5({namespace:l});break;case"elrond":this.rpcProviders[t]=new x5({namespace:l});break;case"multiversx":this.rpcProviders[t]=new P5({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const o=s.data;o&&Gd(o)&&this.events.emit("accountsChanged",o.map(m5))}else if(s.name==="chainChanged"){const o=t.chainId,c=t.event.data,l=vs(o),f=ou(o)!==ou(c)?`${l}:${ou(c)}`:o;this.onChainChanged(f)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:o}=t,c=(s=this.client)==null?void 0:s.session.get(e);this.session=cu(ko({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",cu(ko({},kd("USER_DISCONNECTED")),{data:e.topic}))}),this.on(jn.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(l=>vs(l)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const o=vs(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){var s;if(!this.namespaces)return;const[o,c]=this.validateChain(e);t||this.getProvider(o).setDefaultChain(c),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${Qd}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${Qd}/${e}`)}}const $5=vh,U5="wc",D5="ethereum_provider",F5=`${U5}@2:${D5}:`,L5="https://rpc.walletconnect.com/v1/",qu=["eth_sendTransaction","personal_sign"],j5=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Hu=["chainChanged","accountsChanged"],M5=["message","disconnect","connect"];var q5=Object.defineProperty,H5=Object.defineProperties,z5=Object.getOwnPropertyDescriptors,np=Object.getOwnPropertySymbols,B5=Object.prototype.hasOwnProperty,K5=Object.prototype.propertyIsEnumerable,ip=(n,e,t)=>e in n?q5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ms=(n,e)=>{for(var t in e||(e={}))B5.call(e,t)&&ip(n,t,e[t]);if(np)for(var t of np(e))K5.call(e,t)&&ip(n,t,e[t]);return n},sp=(n,e)=>H5(n,z5(e));function ra(n){return Number(n[0].split(":")[1])}function uu(n){return`0x${n.toString(16)}`}function V5(n){const{chains:e,optionalChains:t,methods:s,optionalMethods:o,events:c,optionalEvents:l,rpcMap:f}=n;if(!Tu(e))throw new Error("Invalid chains");const v={chains:e,methods:s||qu,events:c||Hu,rpcMap:ms({},e.length?{[ra(e)]:f[ra(e)]}:{})},p=c==null?void 0:c.filter(A=>!Hu.includes(A)),S=s==null?void 0:s.filter(A=>!qu.includes(A));if(!t&&!l&&!o&&!(p!=null&&p.length)&&!(S!=null&&S.length))return{required:e.length?v:void 0};const T=(p==null?void 0:p.length)&&(S==null?void 0:S.length)||!t,x={chains:[...new Set(T?v.chains.concat(t||[]):t)],methods:[...new Set(v.methods.concat(o!=null&&o.length?o:j5))],events:[...new Set(v.events.concat(l||M5))],rpcMap:f};return{required:e.length?v:void 0,optional:t.length?x:void 0}}class mh{constructor(){this.events=new Mr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=F5,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new mh;return await t.initialize(e),t}async request(e){return await this.signer.request(e,this.formatChainId(this.chainId))}sendAsync(e,t){this.signer.sendAsync(e,t,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:s}=V5(this.rpc);try{const o=await new Promise(async(l,f)=>{var v;this.rpc.showQrModal&&((v=this.modal)==null||v.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(sp(ms({namespaces:ms({},t&&{[this.namespace]:t})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(p=>{l(p)}).catch(p=>{f(new Error(p.message))})});if(!o)return;const c=TS(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:uu(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:s}=t;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",uu(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",sp(ms({},NS("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,s;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",uu(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,s,o]=e.split(":");return{chainId:`${t}:${s}`,address:o}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,s;const o=(t=e==null?void 0:e.chains)!=null?t:[],c=(s=e==null?void 0:e.optionalChains)!=null?s:[],l=o.concat(c);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=o.length?(e==null?void 0:e.methods)||qu:[],v=o.length?(e==null?void 0:e.events)||Hu:[],p=(e==null?void 0:e.optionalMethods)||[],S=(e==null?void 0:e.optionalEvents)||[],T=(e==null?void 0:e.rpcMap)||this.buildRpcMap(l,e.projectId),x=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(A=>this.formatChainId(A)),optionalChains:c.map(A=>this.formatChainId(A)),methods:f,events:v,optionalMethods:p,optionalEvents:S,rpcMap:T,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:x,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const s={};return e.forEach(o=>{s[o]=this.getRpcUrl(o,t)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?ra(this.rpc.chains):ra(this.rpc.optionalChains),this.signer=await $5.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:s}=await cb(()=>import("./index-cdb8e64c.js").then(o=>o.i),["assets/index-cdb8e64c.js","assets/index-17e45281.js","assets/index-e670e506.css"]);t=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(ms({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:s,rpcMap:o}=e;t&&Tu(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),s&&Tu(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(e,t){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${L5}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const ox=mh;export{ox as EthereumProvider,M5 as OPTIONAL_EVENTS,j5 as OPTIONAL_METHODS,Hu as REQUIRED_EVENTS,qu as REQUIRED_METHODS,mh as default};
